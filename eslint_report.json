[
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\App.test.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\App.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\components\\Auth\\LoginForm.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\components\\Auth\\PhoneVerification.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\components\\Auth\\SignupForm.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\components\\Booking\\RideRequest.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\components\\Booking\\ServiceSelector.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\components\\CinematicIntro.tsx",
        "messages": [
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'AnimatePresence' is defined but never used.",
                "line": 3,
                "column": 43,
                "nodeType": "Identifier",
                "messageId": "unusedVar",
                "endLine": 3,
                "endColumn": 58
            }
        ],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 1,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "source": "\r\nimport React, { useState, useEffect } from \"react\";\r\nimport { motion, useSpring, useTransform, AnimatePresence } from \"framer-motion\";\r\n\r\ninterface Props {\r\n    onComplete: () => void;\r\n}\r\n\r\nconst CinematicIntro: React.FC<Props> = ({ onComplete }) => {\r\n    const count = useSpring(0, { duration: 2500, bounce: 0 });\r\n    const rounded = useTransform(count, (latest) => Math.round(latest));\r\n    const [displayCount, setDisplayCount] = useState(0);\r\n    const [bootLogs, setBootLogs] = useState<string[]>([]);\r\n\r\n    useEffect(() => {\r\n        // Start the counter\r\n        count.set(100);\r\n\r\n        const unsubscribe = rounded.on(\"change\", (v) => {\r\n            setDisplayCount(v);\r\n            if (v === 100) {\r\n                setTimeout(onComplete, 800);\r\n            }\r\n        });\r\n\r\n        return () => unsubscribe();\r\n    }, [count, rounded, onComplete]);\r\n\r\n    // Hacker Boot Logs Effect\r\n    useEffect(() => {\r\n        const logs = [\r\n            \"Initializing Gaadiwala OS kernel...\",\r\n            \"Loading driver proprietary modules...\",\r\n            \"Bypassing security protocols...\",\r\n            \"Establishing satellite uplink...\",\r\n            \"Optimizing route algorithms...\",\r\n            \"Syncing with local grid...\",\r\n            \"User authentication: VERIFIED\",\r\n            \"System integrity: 100%\",\r\n        ];\r\n\r\n        let delay = 0;\r\n        logs.forEach((log, index) => {\r\n            delay += Math.random() * 300 + 100;\r\n            setTimeout(() => {\r\n                setBootLogs(prev => [...prev.slice(-4), `> ${log}`]);\r\n            }, delay);\r\n        });\r\n    }, []);\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 z-[99999] pointer-events-none font-mono\">\r\n            <motion.div\r\n                className=\"absolute inset-0 z-50 bg-[#050505] flex flex-col items-center justify-center text-white overflow-hidden\"\r\n                initial={{ y: 0 }}\r\n                exit={{ y: \"-100%\", transition: { duration: 0.8, ease: [0.76, 0, 0.24, 1] } }}\r\n            >\r\n                {/* Hacker Grid Background */}\r\n                <div className=\"absolute inset-0 opacity-10\"\r\n                    style={{\r\n                        backgroundImage: 'linear-gradient(rgba(34, 197, 94, 0.1) 1px, transparent 1px), linear-gradient(90deg, rgba(34, 197, 94, 0.1) 1px, transparent 1px)',\r\n                        backgroundSize: '40px 40px'\r\n                    }}>\r\n                </div>\r\n\r\n                <div className=\"relative w-full max-w-4xl px-8 flex flex-col items-center\">\r\n\r\n                    {/* Gaadiwala OS Header */}\r\n                    <motion.div\r\n                        initial={{ opacity: 0, y: -20 }}\r\n                        animate={{ opacity: 1, y: 0 }}\r\n                        className=\"absolute top-10 left-0 w-full px-10 flex justify-between items-end border-b border-white/10 pb-4\"\r\n                    >\r\n                        <div>\r\n                            <h1 className=\"text-xl font-bold tracking-widest uppercase text-white\">Gaadiwala <span className=\"text-[#22c55e]\">OS</span></h1>\r\n                            <p className=\"text-[10px] text-slate-500 tracking-[0.5em]\">KERNEL V4.2.0</p>\r\n                        </div>\r\n                        <div className=\"text-right hidden sm:block\">\r\n                            <p className=\"text-[10px] text-[#22c55e] animate-pulse\">SECURE CONNECTION</p>\r\n                            <p className=\"text-[10px] text-slate-600\">ENCRYPTED</p>\r\n                        </div>\r\n                    </motion.div>\r\n\r\n                    {/* Huge Gradient Counter */}\r\n                    <div className=\"relative mb-12\">\r\n                        <div className=\"flex items-baseline leading-none\">\r\n                            <motion.span\r\n                                className=\"text-[8rem] sm:text-[14rem] font-black tracking-tighter mix-blend-overlay\"\r\n                                style={{\r\n                                    backgroundImage: 'linear-gradient(to bottom, #ffffff, #000000)',\r\n                                    WebkitBackgroundClip: 'text',\r\n                                    WebkitTextFillColor: 'transparent',\r\n                                }}\r\n                            >\r\n                                {displayCount}\r\n                            </motion.span>\r\n                            <span className=\"text-4xl sm:text-6xl font-black text-[#22c55e] mb-4 sm:mb-8\">%</span>\r\n                        </div>\r\n\r\n                        {/* Glitch Overlay Text */}\r\n                        <div className=\"absolute top-0 left-0 w-full h-full flex items-center justify-center opacity-30 pointer-events-none\">\r\n                            <span className=\"text-[8rem] sm:text-[14rem] font-black tracking-tighter text-[#22c55e] blur-[2px] animate-pulse\">\r\n                                {displayCount}\r\n                            </span>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Boot Log Terminal */}\r\n                    <div className=\"w-full max-w-lg bg-black/50 border border-white/10 rounded-lg p-4 font-mono text-xs sm:text-sm h-32 flex flex-col justify-end shadow-2xl backdrop-blur-sm relative overflow-hidden group\">\r\n                        <div className=\"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-[#22c55e] to-transparent opacity-50\"></div>\r\n                        {bootLogs.map((log, i) => (\r\n                            <motion.p\r\n                                key={i}\r\n                                initial={{ opacity: 0, x: -10 }}\r\n                                animate={{ opacity: 1, x: 0 }}\r\n                                className=\"text-[#22c55e]/80 truncate\"\r\n                            >\r\n                                {log}\r\n                            </motion.p>\r\n                        ))}\r\n                        <motion.span\r\n                            animate={{ opacity: [0, 1, 0] }}\r\n                            transition={{ repeat: Infinity, duration: 0.8 }}\r\n                            className=\"w-2 h-4 bg-[#22c55e] inline-block mt-1\"\r\n                        />\r\n                    </div>\r\n\r\n                    {/* Footer Status */}\r\n                    <div className=\"absolute bottom-10 w-full text-center\">\r\n                        <p className=\"text-[10px] uppercase tracking-[0.4em] text-slate-500\">\r\n                            {displayCount < 100 ? \"Initializing Neural Net...\" : \"System Ready\"}\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n            </motion.div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default CinematicIntro;\r\n",
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\components\\Discovery\\DistrictPicker.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\components\\Discovery\\SavedPlaces.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\components\\Driver\\DriverPricingSlider.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\components\\ErrorBoundary.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\components\\GlobalBanner.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\components\\LoadingState.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\components\\MapContainer.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\components\\NavigationOverlay.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\components\\PremiumLoader.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\components\\Safety\\SOSButton.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\components\\Tiffin\\TiffinSelector.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\components\\admin\\AdminHeader.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\components\\admin\\AdminModals.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\components\\admin\\AdminSidebar.tsx",
        "messages": [
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'UserRole' is defined but never used.",
                "line": 2,
                "column": 10,
                "nodeType": "Identifier",
                "messageId": "unusedVar",
                "endLine": 2,
                "endColumn": 18
            }
        ],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 1,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "source": "import React from 'react';\r\nimport { UserRole } from '../../types';\r\n\r\ninterface SidebarProps {\r\n    activeTab: string;\r\n    setActiveTab: (tab: any) => void;\r\n    pendingDriversCount: number;\r\n    currentTime: Date;\r\n    handleLogout: () => void;\r\n    showSidebar: boolean;\r\n    sidebarRef: React.RefObject<HTMLDivElement | null>;\r\n}\r\n\r\nconst AdminSidebar: React.FC<SidebarProps> = ({\r\n    activeTab,\r\n    setActiveTab,\r\n    pendingDriversCount,\r\n    currentTime,\r\n    handleLogout,\r\n    showSidebar,\r\n    sidebarRef\r\n}) => {\r\n    const menuItems = [\r\n        { id: 'overview', icon: 'dashboard', label: 'Overview' },\r\n        { id: 'live', icon: 'sensors', label: 'Live Ops', badge: true },\r\n        { id: 'drivers', icon: 'local_taxi', label: 'Fleet', count: pendingDriversCount },\r\n        { id: 'tiffin', icon: 'restaurant', label: 'Food Ops' },\r\n        { id: 'users', icon: 'group', label: 'Riders' },\r\n        { id: 'reports', icon: 'bug_report', label: 'Reports' },\r\n        { id: 'promotions', icon: 'sell', label: 'Promotions' },\r\n        { id: 'broadcasts', icon: 'campaign', label: 'Broadcasts' },\r\n        { id: 'settings', icon: 'settings', label: 'Settings' },\r\n    ];\r\n\r\n    return (\r\n        <aside\r\n            ref={sidebarRef}\r\n            className={`fixed lg:relative z-50 w-72 lg:w-80 bg-[#0A0E12] border-r border-white/5 flex flex-col h-full transition-transform duration-500 overflow-y-auto scrollbar-hide ${showSidebar ? 'translate-x-0' : '-translate-x-full lg:translate-x-0'\r\n                }`}\r\n        >\r\n            <div className=\"p-8 border-b border-white/5\">\r\n                <div className=\"flex items-center gap-3\">\r\n                    <div className=\"size-8 bg-orange-500 rounded-lg flex items-center justify-center shadow-[0_0_15px_rgba(249,115,22,0.4)]\">\r\n                        <span className=\"material-symbols-outlined text-white font-black\">security</span>\r\n                    </div>\r\n                    <div>\r\n                        <h1 className=\"text-xl font-black italic tracking-tighter text-white\">Gaadiwala <span className=\"text-orange-500 not-italic\">HQ</span></h1>\r\n                        <p className=\"text-[8px] font-black uppercase text-slate-500 tracking-[0.2em] leading-none mt-1\">Command & Control</p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <nav className=\"flex-1 p-4 space-y-1\">\r\n                {menuItems.map((item) => (\r\n                    <button\r\n                        key={item.id}\r\n                        onClick={() => setActiveTab(item.id)}\r\n                        className={`w-full flex items-center justify-between px-4 py-3 rounded-xl transition-all group ${activeTab === item.id\r\n                            ? 'bg-white/10 text-white font-bold shadow-[inset_0_0_20px_rgba(255,255,255,0.02)]'\r\n                            : 'text-slate-500 hover:text-white hover:bg-white/5'\r\n                            }`}\r\n                    >\r\n                        <div className=\"flex items-center gap-4\">\r\n                            <div className=\"relative\">\r\n                                <span className=\"material-symbols-outlined text-[22px] group-hover:scale-110 transition-transform\">\r\n                                    {item.icon}\r\n                                </span>\r\n                                {item.badge && (\r\n                                    <span className=\"absolute -top-1 -right-1 size-2 bg-[#00D1FF] rounded-full animate-ping\"></span>\r\n                                )}\r\n                            </div>\r\n                            <span className=\"text-[11px] font-black uppercase tracking-widest\">{item.label}</span>\r\n                        </div>\r\n                        {item.count !== undefined && item.count > 0 && (\r\n                            <span className=\"bg-red-500 text-white text-[9px] font-black px-1.5 py-0.5 rounded-md animate-pulse\">\r\n                                {item.count}\r\n                            </span>\r\n                        )}\r\n                    </button>\r\n                ))}\r\n\r\n                <div className=\"pt-6 mt-6 border-t border-white/5\">\r\n                    <button\r\n                        onClick={handleLogout}\r\n                        className=\"w-full flex items-center gap-4 px-4 py-3 rounded-xl text-red-500/60 hover:text-red-500 hover:bg-red-500/10 transition-all font-black uppercase tracking-widest text-[11px]\"\r\n                    >\r\n                        <span className=\"material-symbols-outlined\">logout</span>\r\n                        <span>Exit HQ</span>\r\n                    </button>\r\n                </div>\r\n            </nav>\r\n\r\n            <div className=\"p-8 border-t border-white/5 bg-[#070b0e]\">\r\n                <div className=\"text-[9px] font-black uppercase text-slate-600 tracking-widest mb-1.5 italic\">Real-Time Core</div>\r\n                <div className=\"text-2xl font-black text-white italic tracking-tighter tabular-nums\">\r\n                    {currentTime.toLocaleTimeString([], { hour12: false })}\r\n                </div>\r\n                <div className=\"text-[9px] text-[#00D1FF] font-black uppercase tracking-widest mt-1 opacity-70\">\r\n                    {currentTime.toLocaleDateString(undefined, { weekday: 'short', month: 'short', day: 'numeric' })}\r\n                </div>\r\n            </div>\r\n        </aside>\r\n    );\r\n};\r\n\r\nexport default AdminSidebar;\r\n",
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\components\\admin\\DashboardMetrics.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\components\\admin\\LiveHeatmap.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\components\\admin\\PerformanceAnalytics.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\components\\admin\\tabs\\BroadcastTab.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\components\\admin\\tabs\\FleetTab.tsx",
        "messages": [
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'UserRole' is defined but never used.",
                "line": 2,
                "column": 16,
                "nodeType": "Identifier",
                "messageId": "unusedVar",
                "endLine": 2,
                "endColumn": 24
            }
        ],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 1,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "source": "import React from 'react';\r\nimport { User, UserRole } from '../../../types';\r\nimport { deleteField } from 'firebase/firestore';\r\n\r\ninterface FleetTabProps {\r\n    drivers: User[];\r\n    driverFilter: 'ALL' | 'PENDING' | 'ACTIVE' | 'BLOCKED';\r\n    setDriverFilter: (f: any) => void;\r\n    setInspectingDriver: (d: User) => void;\r\n    setActioningUser: (data: any) => void;\r\n    handleResetDriver: (user: User) => void;\r\n    handleUserAction: (id: string, updates: any) => void;\r\n}\r\n\r\nconst FleetTab: React.FC<FleetTabProps> = ({\r\n    drivers,\r\n    driverFilter,\r\n    setDriverFilter,\r\n    setInspectingDriver,\r\n    setActioningUser,\r\n    handleResetDriver,\r\n    handleUserAction\r\n}) => {\r\n    const filteredDrivers = drivers.filter(d => {\r\n        if (driverFilter === 'PENDING') return d.isKycCompleted && !d.isApproved && !d.rejectionReason;\r\n        if (driverFilter === 'ACTIVE') return d.isApproved && d.isActive !== false;\r\n        if (driverFilter === 'BLOCKED') return d.rejectionReason || d.isActive === false;\r\n        return true;\r\n    });\r\n\r\n    return (\r\n        <div className=\"space-y-10 animate-in fade-in slide-in-from-bottom-4 duration-500\">\r\n            <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6\">\r\n                <div className=\"flex gap-2 p-1.5 bg-white/5 border border-white/5 rounded-2xl w-fit backdrop-blur-md\">\r\n                    {(['ALL', 'PENDING', 'ACTIVE', 'BLOCKED'] as const).map(f => (\r\n                        <button\r\n                            key={f}\r\n                            onClick={() => setDriverFilter(f)}\r\n                            className={`px-8 py-2.5 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all ${driverFilter === f ? 'bg-orange-500 text-white shadow-[0_0_20px_rgba(249,115,22,0.3)]' : 'text-slate-500 hover:text-white hover:bg-white/5'}`}\r\n                        >\r\n                            {f}\r\n                        </button>\r\n                    ))}\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"bg-[#161B22] border border-white/5 rounded-[3rem] overflow-hidden shadow-2xl relative\">\r\n                <div className=\"p-8 border-b border-white/5 bg-slate-900/50 flex items-center justify-between\">\r\n                    <h3 className=\"text-sm font-black uppercase tracking-[0.2em] text-slate-500\">Partner Node Manifest</h3>\r\n                    <div className=\"flex items-center gap-4\">\r\n                        <span className=\"text-[10px] font-black text-slate-500 uppercase tracking-widest italic\">{filteredDrivers.length} Partners Found</span>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"overflow-x-auto scrollbar-hide\">\r\n                    <table className=\"w-full text-left\">\r\n                        <thead>\r\n                            <tr className=\"border-b border-white/5 text-[10px] font-black uppercase text-slate-600 tracking-widest italic\">\r\n                                <th className=\"px-8 py-6\">Partner Entity</th>\r\n                                <th className=\"px-8 py-6\">Fleet Class</th>\r\n                                <th className=\"px-8 py-6\">Operational Status</th>\r\n                                <th className=\"px-8 py-6\">Yield Grade</th>\r\n                                <th className=\"px-8 py-6 text-right\">Protocol Actions</th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody className=\"divide-y divide-white/[0.03]\">\r\n                            {filteredDrivers.map(driver => (\r\n                                <tr key={driver.id} className=\"group hover:bg-white/[0.01] transition-all duration-300\">\r\n                                    <td className=\"px-8 py-6\">\r\n                                        <div className=\"flex items-center gap-5\">\r\n                                            <div className=\"size-14 rounded-2xl bg-slate-800 p-0.5 border border-white/10 relative transition-transform group-hover:scale-110\">\r\n                                                <img src={driver.avatar || `https://api.dicebear.com/7.x/avataaars/svg?seed=${driver.id}`} className=\"w-full h-full rounded-[0.9rem] object-cover\" alt=\"avatar\" />\r\n                                                {driver.isApproved && (\r\n                                                    <span className=\"absolute -bottom-1.5 -right-1.5 size-6 bg-[#00D1FF] rounded-lg border-4 border-[#161B22] flex items-center justify-center shadow-lg shadow-[#00D1FF]/20\">\r\n                                                        <span className=\"material-symbols-outlined text-[10px] font-black text-black\">check</span>\r\n                                                    </span>\r\n                                                )}\r\n                                            </div>\r\n                                            <div>\r\n                                                <p className=\"font-black text-base text-white tracking-tight italic uppercase leading-none mb-1.5\">{driver.name}</p>\r\n                                                <p className=\"text-[9px] text-[#00D1FF] font-black uppercase tracking-[0.2em] italic opacity-60 leading-none\">{driver.phone || 'GHOST_ID'}</p>\r\n                                            </div>\r\n                                        </div>\r\n                                    </td>\r\n                                    <td className=\"px-8 py-6\">\r\n                                        <div className=\"bg-white/5 border border-white/5 p-3 rounded-2xl w-fit group-hover:bg-white/10 transition-colors\">\r\n                                            <p className=\"text-[10px] font-black text-orange-400 uppercase tracking-[0.2em] mb-1 leading-none italic\">{driver.vehicleType}</p>\r\n                                            <p className=\"text-[8px] text-slate-500 font-bold tracking-widest leading-none\">{driver.vehicleNumber}</p>\r\n                                        </div>\r\n                                    </td>\r\n                                    <td className=\"px-8 py-6\">\r\n                                        {driver.isApproved ? (\r\n                                            <div className=\"flex items-center gap-2 text-emerald-500 group-hover:scale-105 transition-transform origin-left\">\r\n                                                <span className=\"size-2 rounded-full bg-emerald-500 animate-pulse shadow-[0_0_8px_rgba(16,185,129,0.4)]\"></span>\r\n                                                <span className=\"text-[9px] font-black uppercase tracking-widest\">Active Ops</span>\r\n                                            </div>\r\n                                        ) : driver.rejectionReason ? (\r\n                                            <div className=\"flex flex-col gap-1.5\">\r\n                                                <span className=\"px-3 py-1 bg-red-500/10 text-red-500 text-[8px] font-black uppercase rounded-lg border border-red-500/20 w-fit\">Flagged / Restricted</span>\r\n                                                <p className=\"text-[7px] text-slate-600 max-w-[120px] font-bold uppercase tracking-tighter truncate italic\">{driver.rejectionReason}</p>\r\n                                            </div>\r\n                                        ) : driver.isKycCompleted ? (\r\n                                            <div className=\"flex items-center gap-2 text-[#00D1FF] animate-pulse\">\r\n                                                <span className=\"material-symbols-outlined text-[14px]\">fact_check</span>\r\n                                                <span className=\"text-[9px] font-black uppercase tracking-widest text-[#00D1FF]\">KYC Pending</span>\r\n                                            </div>\r\n                                        ) : (\r\n                                            <span className=\"text-[9px] font-black uppercase tracking-widest text-slate-600 italic\">Pre-Operational</span>\r\n                                        )}\r\n                                    </td>\r\n                                    <td className=\"px-8 py-6 text-amber-500 font-black italic\">\r\n                                        <div className=\"flex items-center gap-1.5\">\r\n                                            <span className=\"text-sm tracking-tighter\">{driver.rating || 'N/A'}</span>\r\n                                            <span className=\"material-symbols-outlined text-sm filled\">star</span>\r\n                                        </div>\r\n                                    </td>\r\n                                    <td className=\"px-8 py-6 text-right\">\r\n                                        <div className=\"flex justify-end gap-3 opacity-0 group-hover:opacity-100 transition-all translate-x-4 group-hover:translate-x-0\">\r\n                                            {!driver.isApproved && driver.isKycCompleted && !driver.rejectionReason && (\r\n                                                <button\r\n                                                    onClick={() => setInspectingDriver(driver)}\r\n                                                    className=\"px-5 py-2.5 bg-[#00D1FF] text-black text-[9px] font-black uppercase rounded-xl hover:brightness-110 active:scale-95 transition-all shadow-lg shadow-[#00D1FF]/20 italic\"\r\n                                                >\r\n                                                    Audit Core\r\n                                                </button>\r\n                                            )}\r\n                                            {driver.rejectionReason || driver.isActive === false ? (\r\n                                                <button\r\n                                                    onClick={() => handleUserAction(driver.id, { isApproved: true, rejectionReason: deleteField() as any, isActive: true })}\r\n                                                    className=\"px-5 py-2.5 bg-emerald-500 text-black text-[9px] font-black uppercase rounded-xl shadow-lg shadow-emerald-500/20 active:scale-95 transition-all italic\"\r\n                                                >\r\n                                                    Revoke Block\r\n                                                </button>\r\n                                            ) : (\r\n                                                <button\r\n                                                    onClick={() => setActioningUser({ id: driver.id, type: 'BLOCK' })}\r\n                                                    className=\"px-5 py-2.5 bg-red-500/10 text-red-500 hover:bg-red-500/20 text-[9px] font-black uppercase rounded-xl border border-red-500/20 transition-all\"\r\n                                                >\r\n                                                    Suspend\r\n                                                </button>\r\n                                            )}\r\n                                            <button\r\n                                                onClick={() => handleResetDriver(driver)}\r\n                                                className=\"size-10 flex items-center justify-center bg-slate-800 text-slate-500 hover:text-white hover:bg-red-600 rounded-xl transition-all\"\r\n                                                title=\"Full Purge\"\r\n                                            >\r\n                                                <span className=\"material-symbols-outlined text-[18px]\">delete</span>\r\n                                            </button>\r\n                                        </div>\r\n                                    </td>\r\n                                </tr>\r\n                            ))}\r\n                        </tbody>\r\n                    </table>\r\n                </div>\r\n\r\n                {filteredDrivers.length === 0 && (\r\n                    <div className=\"py-24 text-center\">\r\n                        <span className=\"material-symbols-outlined text-5xl text-slate-700 mb-4 animate-pulse\">radar</span>\r\n                        <p className=\"text-[10px] font-black uppercase text-slate-600 tracking-[0.3em] leading-none\">No Partner Signals Detected in Filter Range</p>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default FleetTab;\r\n",
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\components\\admin\\tabs\\LiveOpsTab.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\components\\admin\\tabs\\OverviewTab.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\components\\admin\\tabs\\PromotionsTab.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\components\\admin\\tabs\\ReportsTab.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\components\\admin\\tabs\\RidersTab.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\components\\admin\\tabs\\SettingsTab.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\components\\admin\\tabs\\TiffinTab.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\components\\shared\\Chat.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\config\\validateEnv.ts",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\context\\AuthContext.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\firebase.ts",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\firebase\\authService.js",
        "messages": [
            {
                "ruleId": "no-unused-vars",
                "severity": 1,
                "message": "'onIdTokenChanged' is defined but never used.",
                "line": 10,
                "column": 5,
                "nodeType": "Identifier",
                "messageId": "unusedVar",
                "endLine": 10,
                "endColumn": 21
            }
        ],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 1,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "source": "import {\r\n    signInWithPopup,\r\n    GoogleAuthProvider,\r\n    sendSignInLinkToEmail,\r\n    isSignInWithEmailLink,\r\n    signInWithEmailLink,\r\n    signOut as firebaseSignOut,\r\n    RecaptchaVerifier,\r\n    signInWithPhoneNumber,\r\n    onIdTokenChanged\r\n} from \"firebase/auth\";\r\nimport { auth } from \"../firebase\";\r\n\r\n// --- Google Sign In ---\r\nconst googleProvider = new GoogleAuthProvider();\r\ngoogleProvider.setCustomParameters({ prompt: 'select_account' });\r\n\r\nexport const signInWithGoogle = async () => {\r\n    try {\r\n        const result = await signInWithPopup(auth, googleProvider);\r\n        return result.user;\r\n    } catch (error) {\r\n        console.error(\"Google Sign In Error:\", error.code, error.message);\r\n        throw error;\r\n    }\r\n};\r\n\r\n// --- Email Link (Passwordless) ---\r\nexport const sendAuthLink = async (email) => {\r\n    const actionCodeSettings = {\r\n        // URL you want to redirect back to. The domain (www.example.com) for this\r\n        // URL must be in the authorized domains list in the Firebase Console.\r\n        url: `${window.location.origin}/#/auth/complete`, // Using HashRouter pattern if applicable\r\n        handleCodeInApp: true,\r\n    };\r\n\r\n    try {\r\n        await sendSignInLinkToEmail(auth, email, actionCodeSettings);\r\n        // Securely store email for completion flow\r\n        window.localStorage.setItem('emailForSignIn', email);\r\n        return true;\r\n    } catch (error) {\r\n        console.error(\"Email Link Error:\", error.code, error.message);\r\n        throw error;\r\n    }\r\n};\r\n\r\nexport const completeEmailAuth = async () => {\r\n    if (isSignInWithEmailLink(auth, window.location.href)) {\r\n        let email = window.localStorage.getItem('emailForSignIn');\r\n        if (!email) {\r\n            // User opened link on different device. Ask for email.\r\n            email = window.prompt(\"Please provide your email for confirmation\");\r\n        }\r\n        try {\r\n            const result = await signInWithEmailLink(auth, email, window.location.href);\r\n            window.localStorage.removeItem('emailForSignIn');\r\n            return result.user;\r\n        } catch (error) {\r\n            console.error(\"Complete Auth Error:\", error.code, error.message);\r\n            throw error;\r\n        }\r\n    }\r\n    return null;\r\n};\r\n\r\n// --- Phone Auth ---\r\nexport const initRecaptcha = (containerId) => {\r\n    if (!window.recaptchaVerifier) {\r\n        window.recaptchaVerifier = new RecaptchaVerifier(auth, containerId, {\r\n            'size': 'invisible', // or 'normal'\r\n            'callback': (response) => {\r\n                // reCAPTCHA solved, allow signInWithPhoneNumber.\r\n            },\r\n            'expired-callback': () => {\r\n                // Response expired. Ask user to solve reCAPTCHA again.\r\n            }\r\n        });\r\n    }\r\n    return window.recaptchaVerifier;\r\n};\r\n\r\nexport const sendPhoneOtp = async (phoneNumber, appVerifier) => {\r\n    try {\r\n        // phoneNumber must be E.164 format (e.g. +919999999999)\r\n        const confirmationResult = await signInWithPhoneNumber(auth, phoneNumber, appVerifier);\r\n        return confirmationResult;\r\n    } catch (error) {\r\n        console.error(\"SMS Error:\", error.code, error.message);\r\n        // Common errors: auth/invalid-phone-number, auth/too-many-requests\r\n        throw error;\r\n    }\r\n};\r\n\r\n// --- General ---\r\nexport const logout = () => firebaseSignOut(auth);\r\n\r\n// Force refresh ID token (useful after admin claim updates)\r\nexport const refreshUserClaims = async (user) => {\r\n    return await user.getIdTokenResult(true);\r\n};\r\n",
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\hooks\\useAuth.js",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\hooks\\useClickOutside.ts",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\hooks\\useDriverManagement.ts",
        "messages": [
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'setDoc' is defined but never used.",
                "line": 2,
                "column": 64,
                "nodeType": "Identifier",
                "messageId": "unusedVar",
                "endLine": 2,
                "endColumn": 70
            }
        ],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 1,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "source": "import { useState, useEffect } from 'react';\r\nimport { collection, query, where, onSnapshot, updateDoc, doc, setDoc, deleteField } from 'firebase/firestore';\r\nimport { db } from '../firebase';\r\nimport { User, UserRole } from '../types';\r\n\r\nexport interface DriverFilter {\r\n    status: 'ALL' | 'PENDING' | 'ACTIVE' | 'BLOCKED';\r\n}\r\n\r\nexport interface DriverManagementHook {\r\n    drivers: User[];\r\n    loading: boolean;\r\n    error: string | null;\r\n    approveDriver: (driverId: string) => Promise<void>;\r\n    rejectDriver: (driverId: string, reason: string) => Promise<void>;\r\n    blockDriver: (driverId: string, reason: string) => Promise<void>;\r\n    unblockDriver: (driverId: string) => Promise<void>;\r\n}\r\n\r\n/**\r\n * Custom hook for managing drivers in the admin panel\r\n * Handles fetching, approving, rejecting, and blocking drivers\r\n */\r\nexport const useDriverManagement = (filter: DriverFilter = { status: 'ALL' }): DriverManagementHook => {\r\n    const [drivers, setDrivers] = useState<User[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState<string | null>(null);\r\n\r\n    useEffect(() => {\r\n        setLoading(true);\r\n        setError(null);\r\n\r\n        try {\r\n            const driversQuery = query(\r\n                collection(db, 'users'),\r\n                where('role', '==', UserRole.DRIVER)\r\n            );\r\n\r\n            const unsubscribe = onSnapshot(\r\n                driversQuery,\r\n                (snapshot) => {\r\n                    const driversList = snapshot.docs.map(doc => ({\r\n                        id: doc.id,\r\n                        ...doc.data()\r\n                    })) as User[];\r\n\r\n                    // Apply filter\r\n                    let filteredDrivers = driversList;\r\n                    if (filter.status === 'PENDING') {\r\n                        filteredDrivers = driversList.filter(d => d.isKycCompleted && !d.isApproved && !d.rejectionReason);\r\n                    } else if (filter.status === 'ACTIVE') {\r\n                        filteredDrivers = driversList.filter(d => d.isApproved && d.isActive !== false);\r\n                    } else if (filter.status === 'BLOCKED') {\r\n                        filteredDrivers = driversList.filter(d => d.rejectionReason || d.isActive === false);\r\n                    }\r\n\r\n                    setDrivers(filteredDrivers);\r\n                    setLoading(false);\r\n                },\r\n                (err) => {\r\n                    console.error('Error fetching drivers:', err);\r\n                    setError(err.message);\r\n                    setLoading(false);\r\n                }\r\n            );\r\n\r\n            return () => unsubscribe();\r\n        } catch (err: any) {\r\n            console.error('Error setting up driver listener:', err);\r\n            setError(err.message);\r\n            setLoading(false);\r\n        }\r\n    }, [filter.status]);\r\n\r\n    const approveDriver = async (driverId: string): Promise<void> => {\r\n        try {\r\n            const driverRef = doc(db, 'users', driverId);\r\n            await updateDoc(driverRef, {\r\n                isApproved: true,\r\n                rejectionReason: deleteField(),\r\n                isActive: true\r\n            });\r\n        } catch (err: any) {\r\n            console.error('Error approving driver:', err);\r\n            throw new Error(`Failed to approve driver: ${err.message}`);\r\n        }\r\n    };\r\n\r\n    const rejectDriver = async (driverId: string, reason: string): Promise<void> => {\r\n        try {\r\n            const driverRef = doc(db, 'users', driverId);\r\n            await updateDoc(driverRef, {\r\n                isApproved: false,\r\n                rejectionReason: reason,\r\n                isActive: false\r\n            });\r\n        } catch (err: any) {\r\n            console.error('Error rejecting driver:', err);\r\n            throw new Error(`Failed to reject driver: ${err.message}`);\r\n        }\r\n    };\r\n\r\n    const blockDriver = async (driverId: string, reason: string): Promise<void> => {\r\n        try {\r\n            const driverRef = doc(db, 'users', driverId);\r\n            await updateDoc(driverRef, {\r\n                isActive: false,\r\n                rejectionReason: reason\r\n            });\r\n        } catch (err: any) {\r\n            console.error('Error blocking driver:', err);\r\n            throw new Error(`Failed to block driver: ${err.message}`);\r\n        }\r\n    };\r\n\r\n    const unblockDriver = async (driverId: string): Promise<void> => {\r\n        try {\r\n            const driverRef = doc(db, 'users', driverId);\r\n            await updateDoc(driverRef, {\r\n                isActive: true,\r\n                rejectionReason: deleteField()\r\n            });\r\n        } catch (err: any) {\r\n            console.error('Error unblocking driver:', err);\r\n            throw new Error(`Failed to unblock driver: ${err.message}`);\r\n        }\r\n    };\r\n\r\n    return {\r\n        drivers,\r\n        loading,\r\n        error,\r\n        approveDriver,\r\n        rejectDriver,\r\n        blockDriver,\r\n        unblockDriver\r\n    };\r\n};\r\n",
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\hooks\\useRide.ts",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\hooks\\useSystemConfig.ts",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\hooks\\useTiffinManagement.ts",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\index.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\react-app-env.d.ts",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\reportWebVitals.ts",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\screens\\AuthTestScreen.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\screens\\EmailComplete.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\screens\\Welcome.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\screens\\admin\\AdminHQ.tsx",
        "messages": [
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'deleteField' is defined but never used.",
                "line": 5,
                "column": 72,
                "nodeType": "Identifier",
                "messageId": "unusedVar",
                "endLine": 5,
                "endColumn": 83
            },
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'filteredDrivers' is assigned a value but never used.",
                "line": 160,
                "column": 11,
                "nodeType": "Identifier",
                "messageId": "unusedVar",
                "endLine": 160,
                "endColumn": 26
            },
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'filteredRiders' is assigned a value but never used.",
                "line": 167,
                "column": 11,
                "nodeType": "Identifier",
                "messageId": "unusedVar",
                "endLine": 167,
                "endColumn": 25
            }
        ],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 3,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "source": "import React, { useState, useEffect, useRef } from 'react';\r\nimport { db, auth } from '../../firebase';\r\nimport { signOut } from 'firebase/auth';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { collection, query, where, onSnapshot, updateDoc, doc, setDoc, deleteField } from 'firebase/firestore';\r\nimport { User, UserRole, Report, TiffinOrder, TiffinVendor, RideRequest, RideStatus, PromoCode } from '../../types';\r\nimport { useClickOutside } from '../../hooks/useClickOutside';\r\n\r\n// Modular Components\r\nimport AdminSidebar from '../../components/admin/AdminSidebar';\r\nimport AdminHeader from '../../components/admin/AdminHeader';\r\nimport AdminModals from '../../components/admin/AdminModals';\r\n\r\n// Tab Components\r\nimport OverviewTab from '../../components/admin/tabs/OverviewTab';\r\nimport FleetTab from '../../components/admin/tabs/FleetTab';\r\nimport RidersTab from '../../components/admin/tabs/RidersTab';\r\nimport LiveOpsTab from '../../components/admin/tabs/LiveOpsTab';\r\nimport TiffinTab from '../../components/admin/tabs/TiffinTab';\r\nimport SettingsTab from '../../components/admin/tabs/SettingsTab';\r\nimport BroadcastTab from '../../components/admin/tabs/BroadcastTab';\r\nimport PromotionsTab from '../../components/admin/tabs/PromotionsTab';\r\nimport ReportsTab from '../../components/admin/tabs/ReportsTab';\r\n\r\ninterface Props {\r\n    onApprove: (id: string, approved: boolean, reason?: string) => void;\r\n}\r\n\r\n\r\n\r\n\r\nconst trafficData = [\r\n    { time: '06:00', users: 120, drivers: 45 },\r\n    { time: '09:00', users: 450, drivers: 180 },\r\n    { time: '12:00', users: 380, drivers: 150 },\r\n    { time: '15:00', users: 290, drivers: 120 },\r\n    { time: '18:00', users: 650, drivers: 250 },\r\n    { time: '21:00', users: 420, drivers: 160 },\r\n];\r\n\r\nconst AdminHQ: React.FC<Props> = ({ onApprove }) => {\r\n    const navigate = useNavigate();\r\n    const handleLogout = async () => {\r\n        try {\r\n            await signOut(auth);\r\n            navigate('/');\r\n        } catch (err) {\r\n            console.error(\"Logout failed\", err);\r\n        }\r\n    };\r\n\r\n    const [activeTab, setActiveTab] = useState<'overview' | 'drivers' | 'users' | 'reports' | 'tiffin' | 'live' | 'settings' | 'broadcasts' | 'promotions'>('overview');\r\n    const [currentTime, setCurrentTime] = useState(new Date());\r\n    const [showSidebar, setShowSidebar] = useState(false);\r\n    const sidebarRef = useRef<HTMLDivElement>(null);\r\n\r\n    useClickOutside(sidebarRef, () => setShowSidebar(false));\r\n\r\n    // Data States\r\n    const [users, setUsers] = useState<User[]>([]);\r\n    const [drivers, setDrivers] = useState<User[]>([]);\r\n    const [reports, setReports] = useState<Report[]>([]);\r\n    const [tiffinOrders, setTiffinOrders] = useState<TiffinOrder[]>([]);\r\n    const [tiffinVendors, setTiffinVendors] = useState<TiffinVendor[]>([]);\r\n    const [activeRides, setActiveRides] = useState<RideRequest[]>([]);\r\n    const [promoCodes, setPromoCodes] = useState<PromoCode[]>([]);\r\n    const [stats] = useState({ revenue: 0, totalRides: 0, tiffinRevenue: 0 });\r\n\r\n    // State for filtering\r\n    const [driverFilter, setDriverFilter] = useState<'ALL' | 'PENDING' | 'ACTIVE' | 'BLOCKED'>('ALL');\r\n    const [userFilter, setUserFilter] = useState<'ALL' | 'ACTIVE' | 'BLOCKED'>('ALL');\r\n\r\n    // Rejection & Block Logic\r\n    const [actioningUser, setActioningUser] = useState<{ id: string, type: 'BLOCK' | 'REJECT' | 'DELETE' } | null>(null);\r\n    const [inspectingDriver, setInspectingDriver] = useState<User | null>(null);\r\n    const [reason, setReason] = useState('');\r\n\r\n    // Broadcast State\r\n    const [broadcastMsg, setBroadcastMsg] = useState('');\r\n    const [isBroadcasting, setIsBroadcasting] = useState(false);\r\n\r\n    // System Configuration State\r\n    const [sysConfig, setSysConfig] = useState({\r\n        baseFares: { BIKE: 10, AUTO: 15, MINI: 25, PINK: 30, PRIME: 50 },\r\n        surgeMultiplier: 1.2,\r\n        tiffinCommission: 12,\r\n        pinkCabLockdown: false,\r\n        liveSOSProtocol: true\r\n    });\r\n    const [isConfigSaving, setIsConfigSaving] = useState(false);\r\n\r\n    useEffect(() => {\r\n        const timer = setInterval(() => setCurrentTime(new Date()), 1000);\r\n        return () => clearInterval(timer);\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        // Riders Listener - Anyone who has RIDER capability\r\n        const qUsers = query(collection(db, 'users'), where('roles', 'array-contains', UserRole.RIDER));\r\n        const unsubUsers = onSnapshot(qUsers, (snapshot) => {\r\n            setUsers(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() } as User)));\r\n        });\r\n\r\n        // Drivers Listener - Anyone who has DRIVER capability\r\n        const qDrivers = query(collection(db, 'users'), where('roles', 'array-contains', UserRole.DRIVER));\r\n        const unsubDrivers = onSnapshot(qDrivers, (snapshot) => {\r\n            setDrivers(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() } as User)));\r\n        });\r\n\r\n        // Tiffin Vendors Listener\r\n        const qVendors = collection(db, 'tiffinVendors');\r\n        const unsubVendors = onSnapshot(qVendors, (snapshot) => {\r\n            setTiffinVendors(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() } as TiffinVendor)));\r\n        });\r\n\r\n        // Tiffin Orders Listener (Recent 50)\r\n        const qTiffinOrders = collection(db, 'tiffinOrders');\r\n        const unsubTiffinOrders = onSnapshot(qTiffinOrders, (snapshot) => {\r\n            setTiffinOrders(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() } as TiffinOrder)));\r\n        });\r\n\r\n        // Active Rides Listener\r\n        const qRides = query(collection(db, 'rides'), where('status', 'in', [RideStatus.SEARCHING, RideStatus.ACCEPTED, RideStatus.ARRIVED, RideStatus.STARTED]));\r\n        const unsubRides = onSnapshot(qRides, (snapshot) => {\r\n            setActiveRides(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() } as RideRequest)));\r\n        });\r\n\r\n        // Reports Listener\r\n        const qReports = query(collection(db, 'reports'), where('status', '==', 'OPEN'));\r\n        const unsubReports = onSnapshot(qReports, (snapshot) => {\r\n            setReports(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() } as Report)));\r\n        });\r\n\r\n        // Promo Codes Listener\r\n        const qPromos = collection(db, 'promoCodes');\r\n        const unsubPromos = onSnapshot(qPromos, (snapshot) => {\r\n            setPromoCodes(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() } as PromoCode)));\r\n        });\r\n\r\n        // Global Config Listener\r\n        const unsubConfig = onSnapshot(doc(db, 'system', 'config'), (snapshot) => {\r\n            if (snapshot.exists()) {\r\n                setSysConfig(prev => ({ ...prev, ...snapshot.data() }));\r\n            }\r\n        });\r\n\r\n        return () => {\r\n            unsubUsers();\r\n            unsubDrivers();\r\n            unsubReports();\r\n            unsubPromos();\r\n            unsubVendors();\r\n            unsubTiffinOrders();\r\n            unsubRides();\r\n            unsubConfig();\r\n        };\r\n    }, []);\r\n\r\n    // Derived Data with Filtering\r\n    const filteredDrivers = drivers.filter(d => {\r\n        if (driverFilter === 'PENDING') return d.isKycCompleted && !d.isApproved && !d.rejectionReason;\r\n        if (driverFilter === 'ACTIVE') return d.isApproved && d.isActive !== false;\r\n        if (driverFilter === 'BLOCKED') return d.rejectionReason || d.isActive === false;\r\n        return true;\r\n    });\r\n\r\n    const filteredRiders = users.filter(u => {\r\n        if (userFilter === 'ACTIVE') return u.isActive !== false;\r\n        if (userFilter === 'BLOCKED') return u.isActive === false;\r\n        return true;\r\n    });\r\n\r\n    const pendingDriversCount = drivers.filter(d => d.isKycCompleted && !d.isApproved && !d.rejectionReason).length;\r\n    const activeDriversCount = drivers.filter(d => d.isApproved && d.isActive !== false).length;\r\n    // const blockedDriversCount = drivers.filter(d => d.rejectionReason || d.isActive === false).length;\r\n    // const activeRidersCount = users.filter(u => u.isActive !== false).length;\r\n    // const blockedRidersCount = users.filter(u => u.isActive === false).length;\r\n\r\n    const handleUserAction = async (id: string, updates: Partial<User>) => {\r\n        try {\r\n            await updateDoc(doc(db, 'users', id), {\r\n                ...updates,\r\n                updatedAt: new Date()\r\n            });\r\n            setActioningUser(null);\r\n            setInspectingDriver(null);\r\n            setReason('');\r\n        } catch (err) {\r\n            console.error(\"Action failed\", err);\r\n            alert(\"Administrative action failed. Check permissions.\");\r\n        }\r\n    };\r\n\r\n    const handleResetDriver = async (user: User) => {\r\n        const isEcosystemPurge = window.confirm(\"Ecossytem Purge? OK for full deactivation, CANCEL for just Driver Reset.\");\r\n\r\n        try {\r\n            if (isEcosystemPurge) {\r\n                await updateDoc(doc(db, 'users', user.id), {\r\n                    isActive: false,\r\n                    deletedAt: new Date(),\r\n                    name: `[Inactive] ${user.name}`\r\n                });\r\n                alert(\"Account deactivated.\");\r\n            } else {\r\n                // Driver Reset (Re-application flow)\r\n                const newRoles = user.roles?.filter(r => r !== UserRole.DRIVER) || [UserRole.RIDER];\r\n                await updateDoc(doc(db, 'users', user.id), {\r\n                    roles: newRoles,\r\n                    role: UserRole.RIDER,\r\n                    isApproved: false,\r\n                    isKycCompleted: false,\r\n                    wasDriverRemoved: true,\r\n                    updatedAt: new Date()\r\n                });\r\n                alert(\"Partner status reset. User can re-apply.\");\r\n            }\r\n        } catch (err) {\r\n            alert(\"Action failed.\");\r\n        }\r\n    };\r\n\r\n    const handleSaveConfig = async () => {\r\n        setIsConfigSaving(true);\r\n        try {\r\n            await setDoc(doc(db, 'system', 'config'), sysConfig);\r\n            alert(\"Global Protocol Committed Successfully.\");\r\n        } catch (err) {\r\n            alert(\"Protocol commit failed. Access restricted.\");\r\n        } finally {\r\n            setIsConfigSaving(false);\r\n        }\r\n    };\r\n\r\n    const handleTiffinVendorAction = async (vendorId: string, updates: Partial<TiffinVendor>) => {\r\n        try {\r\n            await updateDoc(doc(db, 'tiffinVendors', vendorId), updates);\r\n        } catch (err) {\r\n            alert(\"Vendor update failed.\");\r\n        }\r\n    };\r\n\r\n    const handleTiffinOrderAction = async (orderId: string, status: string) => {\r\n        try {\r\n            await updateDoc(doc(db, 'tiffinOrders', orderId), { status });\r\n        } catch (err) {\r\n            alert(\"Order update failed.\");\r\n        }\r\n    };\r\n\r\n    const handleCreatePromo = async (e: React.FormEvent<HTMLFormElement>) => {\r\n        e.preventDefault();\r\n        const form = e.target as HTMLFormElement;\r\n        const data = new FormData(form);\r\n        const code = data.get('code') as string;\r\n        const value = Number(data.get('value'));\r\n\r\n        if (!code || !value) return;\r\n\r\n        try {\r\n            await setDoc(doc(collection(db, 'promoCodes')), {\r\n                code: code.toUpperCase(),\r\n                discountType: 'PERCENTAGE',\r\n                value: value,\r\n                maxDiscount: 100,\r\n                expiry: Date.now() + (7 * 24 * 60 * 60 * 1000),\r\n                usageLimit: 1000,\r\n                usedCount: 0,\r\n                isActive: true\r\n            });\r\n            form.reset();\r\n            alert(\"Promo Code Created!\");\r\n        } catch (err) {\r\n            console.error(err);\r\n            alert(\"Failed to create promo\");\r\n        }\r\n    };\r\n\r\n    const handleDeactivatePromo = async (id: string) => {\r\n        try {\r\n            await updateDoc(doc(db, 'promoCodes', id), { isActive: false });\r\n        } catch (err) {\r\n            alert(\"Failed to deactivate promo\");\r\n        }\r\n    };\r\n\r\n    const handleResolveReport = async (id: string) => {\r\n        try {\r\n            await updateDoc(doc(db, 'reports', id), { status: 'RESOLVED', updatedAt: new Date() });\r\n            alert(\"Anomaly Resolved & Protocol Closed.\");\r\n        } catch (err) {\r\n            alert(\"Resolution protocol failed.\");\r\n        }\r\n    };\r\n\r\n    const handleSendBroadcast = async () => {\r\n        if (!broadcastMsg) return;\r\n        setIsBroadcasting(true);\r\n        try {\r\n            await updateDoc(doc(db, 'system', 'broadcast'), {\r\n                message: broadcastMsg,\r\n                timestamp: new Date(),\r\n                active: true,\r\n                id: Date.now().toString()\r\n            });\r\n            setBroadcastMsg('');\r\n            alert(\"Ecosystem Broadcast Dispatched Successfully.\");\r\n        } catch (err) {\r\n            alert(\"Transmission failed. Service restricted.\");\r\n        } finally {\r\n            setIsBroadcasting(false);\r\n        }\r\n    };\r\n\r\n    // Infrastructure UI States\r\n    const [showNotifications, setShowNotifications] = useState(false);\r\n    const [showOpsGrid, setShowOpsGrid] = useState(false);\r\n\r\n    return (\r\n        <div className=\"flex flex-col lg:flex-row min-h-screen lg:h-screen w-full overflow-hidden bg-[#0f1c23] text-white font-sans selection:bg-orange-500 selection:text-white\">\r\n            {/* MOBILE NAV TOGGLE */}\r\n            {!showSidebar && (\r\n                <button\r\n                    onClick={() => setShowSidebar(true)}\r\n                    className=\"lg:hidden fixed bottom-6 right-6 z-[60] size-14 bg-orange-500 text-white rounded-full shadow-2xl flex items-center justify-center active:scale-95 transition-all shadow-orange-500/20\"\r\n                >\r\n                    <span className=\"material-symbols-outlined text-2xl\">menu</span>\r\n                </button>\r\n            )}\r\n\r\n            <AdminSidebar\r\n                activeTab={activeTab}\r\n                setActiveTab={setActiveTab}\r\n                pendingDriversCount={pendingDriversCount}\r\n                currentTime={currentTime}\r\n                handleLogout={handleLogout}\r\n                showSidebar={showSidebar}\r\n                sidebarRef={sidebarRef}\r\n            />\r\n\r\n            <main className=\"flex-1 flex flex-col min-w-0 bg-[#0f1c23] relative\">\r\n                <AdminHeader\r\n                    activeTab={activeTab}\r\n                    onNotificationClick={() => setShowNotifications(!showNotifications)}\r\n                    onGridViewClick={() => setShowOpsGrid(!showOpsGrid)}\r\n                    notificationCount={pendingDriversCount + reports.length}\r\n                />\r\n\r\n                <div className=\"flex-1 overflow-y-auto p-4 md:p-10 scrollbar-hide\">\r\n                    {/* NOTIFICATION CENTER */}\r\n                    {showNotifications && (\r\n                        <div className=\"absolute top-24 right-10 z-[100] w-96 bg-[#161B22]/95 backdrop-blur-2xl border border-white/10 rounded-[2.5rem] shadow-[0_50px_100px_rgba(0,0,0,0.5)] overflow-hidden animate-in slide-in-from-top-4 duration-300\">\r\n                            <div className=\"p-8 border-b border-white/5 flex items-center justify-between\">\r\n                                <h3 className=\"text-sm font-black uppercase tracking-[0.2em] text-slate-500\">System Intel</h3>\r\n                                <button onClick={() => setShowNotifications(false)} className=\"text-[10px] font-black uppercase text-slate-700 hover:text-white transition-colors\">Dismiss</button>\r\n                            </div>\r\n                            <div className=\"max-h-[400px] overflow-y-auto scrollbar-hide\">\r\n                                {pendingDriversCount > 0 && (\r\n                                    <div\r\n                                        onClick={() => { setActiveTab('drivers'); setDriverFilter('PENDING'); setShowNotifications(false); }}\r\n                                        className=\"p-8 border-b border-white/5 hover:bg-white/[0.02] transition-all cursor-pointer group\"\r\n                                    >\r\n                                        <div className=\"flex items-center gap-4 mb-3\">\r\n                                            <div className=\"size-10 rounded-xl bg-orange-500/10 text-orange-500 flex items-center justify-center\"><span className=\"material-symbols-outlined\">pending_actions</span></div>\r\n                                            <p className=\"text-xs font-black uppercase text-white tracking-widest\">Awaiting Verification</p>\r\n                                        </div>\r\n                                        <p className=\"text-[11px] text-slate-500 font-medium leading-relaxed italic\">{pendingDriversCount} partner nodes are requesting infrastructure access.</p>\r\n                                    </div>\r\n                                )}\r\n                                {reports.length > 0 && (\r\n                                    <div\r\n                                        onClick={() => { setActiveTab('reports'); setShowNotifications(false); }}\r\n                                        className=\"p-8 border-b border-white/5 hover:bg-white/[0.02] transition-all cursor-pointer group\"\r\n                                    >\r\n                                        <div className=\"flex items-center gap-4 mb-3\">\r\n                                            <div className=\"size-10 rounded-xl bg-red-500/10 text-red-500 flex items-center justify-center\"><span className=\"material-symbols-outlined text-xl\">bug_report</span></div>\r\n                                            <p className=\"text-xs font-black uppercase text-white tracking-widest\">Active Anomalies</p>\r\n                                        </div>\r\n                                        <p className=\"text-[11px] text-slate-500 font-medium leading-relaxed italic\">{reports.length} system reports require administrative resolution.</p>\r\n                                    </div>\r\n                                )}\r\n                                {pendingDriversCount === 0 && reports.length === 0 && (\r\n                                    <div className=\"p-12 text-center\">\r\n                                        <span className=\"material-symbols-outlined text-4xl text-slate-800 mb-4 animate-pulse\">check_circle</span>\r\n                                        <p className=\"text-[10px] font-black uppercase text-slate-700 tracking-[0.3em]\">Protocol Nominal</p>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* OPS GRID OVERLAY (Fast Access) */}\r\n                    {showOpsGrid && (\r\n                        <div className=\"mb-10 grid grid-cols-2 md:grid-cols-4 gap-4 animate-in slide-in-from-top-4 duration-300\">\r\n                            {(['overview', 'live', 'drivers', 'tiffin', 'users', 'reports', 'promotions', 'broadcasts', 'settings'] as const).map(tab => (\r\n                                <button\r\n                                    key={tab}\r\n                                    onClick={() => {\r\n                                        setActiveTab(tab);\r\n                                        setShowOpsGrid(false);\r\n                                    }}\r\n                                    className={`p-6 rounded-3xl border transition-all text-left group ${activeTab === tab ? 'bg-orange-500 border-orange-500 text-white' : 'bg-white/5 border-white/5 text-slate-400 hover:bg-white/10'}`}\r\n                                >\r\n                                    <p className=\"text-[10px] font-black uppercase tracking-widest opacity-60 mb-1 leading-none\">{tab}</p>\r\n                                    <p className=\"text-sm font-black italic uppercase leading-none\">Access Protocol</p>\r\n                                </button>\r\n                            ))}\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* NOTIFICATION_TOAST_PROTOCOL */}\r\n                    {(pendingDriversCount > 0 || reports.length > 0) && !showNotifications && (\r\n                        <div className=\"mb-8 flex items-center justify-between p-6 bg-orange-500/10 border border-orange-500/20 rounded-3xl animate-pulse\">\r\n                            <div className=\"flex items-center gap-4\">\r\n                                <span className=\"material-symbols-outlined text-orange-500\">priority_high</span>\r\n                                <p className=\"text-[11px] font-black uppercase text-orange-500 tracking-[0.2em]\">Infrastructure Anomalies Detected: {pendingDriversCount + reports.length} Nodes Pending Audit</p>\r\n                            </div>\r\n                            <button onClick={() => setShowNotifications(true)} className=\"px-4 py-1.5 bg-orange-500 text-white text-[9px] font-black uppercase rounded-lg shadow-lg\">Review Manifest</button>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* MODULAR TABS */}\r\n                    <div className=\"min-h-full pb-32\">\r\n                        {activeTab === 'overview' && (\r\n                            <OverviewTab\r\n                                users={users}\r\n                                drivers={drivers}\r\n                                activeDriversCount={activeDriversCount}\r\n                                pendingDriversCount={pendingDriversCount}\r\n                                tiffinOrders={tiffinOrders}\r\n                                stats={stats}\r\n                                trafficData={trafficData}\r\n                                setActiveTab={setActiveTab}\r\n                            />\r\n                        )}\r\n\r\n                        {activeTab === 'drivers' && (\r\n                            <FleetTab\r\n                                drivers={drivers}\r\n                                driverFilter={driverFilter}\r\n                                setDriverFilter={setDriverFilter}\r\n                                setInspectingDriver={setInspectingDriver}\r\n                                setActioningUser={setActioningUser}\r\n                                handleResetDriver={handleResetDriver}\r\n                                handleUserAction={handleUserAction}\r\n                            />\r\n                        )}\r\n\r\n                        {activeTab === 'users' && (\r\n                            <RidersTab\r\n                                users={users}\r\n                                userFilter={userFilter}\r\n                                setUserFilter={setUserFilter}\r\n                                handleUserAction={handleUserAction}\r\n                                handleResetDriver={handleResetDriver}\r\n                            />\r\n                        )}\r\n\r\n                        {activeTab === 'reports' && (\r\n                            <ReportsTab\r\n                                reports={reports}\r\n                                handleResolveReport={handleResolveReport}\r\n                            />\r\n                        )}\r\n\r\n                        {activeTab === 'promotions' && (\r\n                            <PromotionsTab\r\n                                promoCodes={promoCodes}\r\n                                handleCreatePromo={handleCreatePromo}\r\n                                handleDeactivatePromo={handleDeactivatePromo}\r\n                            />\r\n                        )}\r\n\r\n                        {activeTab === 'live' && (\r\n                            <LiveOpsTab activeRides={activeRides} />\r\n                        )}\r\n\r\n                        {activeTab === 'tiffin' && (\r\n                            <TiffinTab\r\n                                tiffinVendors={tiffinVendors}\r\n                                tiffinOrders={tiffinOrders}\r\n                                handleTiffinVendorAction={handleTiffinVendorAction}\r\n                                handleTiffinOrderAction={handleTiffinOrderAction}\r\n                            />\r\n                        )}\r\n\r\n                        {activeTab === 'settings' && (\r\n                            <SettingsTab\r\n                                sysConfig={sysConfig}\r\n                                setSysConfig={setSysConfig}\r\n                                handleSaveConfig={handleSaveConfig}\r\n                                isConfigSaving={isConfigSaving}\r\n                            />\r\n                        )}\r\n\r\n                        {activeTab === 'broadcasts' && (\r\n                            <BroadcastTab\r\n                                broadcastMsg={broadcastMsg}\r\n                                setBroadcastMsg={setBroadcastMsg}\r\n                                isBroadcasting={isBroadcasting}\r\n                                handleSendBroadcast={handleSendBroadcast}\r\n                            />\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </main>\r\n\r\n            <AdminModals\r\n                inspectingDriver={inspectingDriver}\r\n                setInspectingDriver={setInspectingDriver}\r\n                actioningUser={actioningUser}\r\n                setActioningUser={setActioningUser}\r\n                reason={reason}\r\n                setReason={setReason}\r\n                handleUserAction={handleUserAction}\r\n                handleResetDriver={handleResetDriver}\r\n                users={users}\r\n                drivers={drivers}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default AdminHQ;\r\n",
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\screens\\driver\\DriverDashboard.tsx",
        "messages": [
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'setActiveTiffin' is assigned a value but never used.",
                "line": 31,
                "column": 26,
                "nodeType": "Identifier",
                "messageId": "unusedVar",
                "endLine": 31,
                "endColumn": 41
            },
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'isOptimizing' is assigned a value but never used.",
                "line": 42,
                "column": 12,
                "nodeType": "Identifier",
                "messageId": "unusedVar",
                "endLine": 42,
                "endColumn": 24
            },
            {
                "ruleId": "react-hooks/exhaustive-deps",
                "severity": 1,
                "message": "React Hook useEffect has a missing dependency: 'activeBatch'. Either include it or remove the dependency array.",
                "line": 295,
                "column": 8,
                "nodeType": "ArrayExpression",
                "endLine": 295,
                "endColumn": 56,
                "suggestions": [
                    {
                        "desc": "Update the dependencies array to be: [activeBatch, activeBatch.length, mode, user.currentLocation]",
                        "fix": {
                            "range": [
                                11906,
                                11954
                            ],
                            "text": "[activeBatch, activeBatch.length, mode, user.currentLocation]"
                        }
                    }
                ]
            }
        ],
        "suppressedMessages": [
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'Chat' is defined but never used.",
                "line": 7,
                "column": 8,
                "nodeType": "Identifier",
                "messageId": "unusedVar",
                "endLine": 7,
                "endColumn": 12,
                "suppressions": [
                    {
                        "kind": "directive",
                        "justification": ""
                    }
                ]
            },
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'chatOpen' is assigned a value but never used.",
                "line": 49,
                "column": 12,
                "nodeType": "Identifier",
                "messageId": "unusedVar",
                "endLine": 49,
                "endColumn": 20,
                "suppressions": [
                    {
                        "kind": "directive",
                        "justification": ""
                    }
                ]
            }
        ],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 3,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "source": "import React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { db } from '../../firebase';\r\nimport { collection, query, where, onSnapshot, updateDoc, doc, serverTimestamp } from 'firebase/firestore';\r\nimport { Language, User, RideRequest, RideStatus, TiffinOrder, VehicleCategory } from '../../types';\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport Chat from '../../components/shared/Chat';\r\nimport { useClickOutside } from '../../hooks/useClickOutside';\r\nimport { useRef } from 'react';\r\nimport GlobalBanner from '../../components/GlobalBanner';\r\nimport MapContainer from '../../components/MapContainer';\r\nimport { watchPosition, clearWatch, GeolocationError, GeolocationErrorType } from '../../utils/GeolocationHelper';\r\nimport { optimizeTiffinBatch, OptimizationResult, OptimizedStop } from '../../services/RouteOptimizationService';\r\nimport { getNearestRoad } from '../../services/RoadsService';\r\nimport { CONFIG } from '../../firebase';\r\n\r\ninterface Props {\r\n    user: User;\r\n    lang: Language;\r\n    setLang: (l: Language) => void;\r\n}\r\n\r\nconst DriverDashboard: React.FC<Props> = ({ user, lang, setLang }) => {\r\n    const navigate = useNavigate();\r\n    const [incomingRide, setIncomingRide] = useState<RideRequest | null>(null);\r\n    const [activeTrip, setActiveTrip] = useState<RideRequest | null>(null);\r\n\r\n    // Tiffin State\r\n    const [mode, setMode] = useState<'RIDE' | 'TIFFIN'>('RIDE');\r\n    const [tiffinOrders, setTiffinOrders] = useState<TiffinOrder[]>([]);\r\n    const [activeTiffin, setActiveTiffin] = useState<TiffinOrder | null>(null);\r\n\r\n    // Earnings & Gamification\r\n    const [dailyEarnings, setDailyEarnings] = useState(0);\r\n    const [completedRidesToday, setCompletedRidesToday] = useState(0);\r\n    const [tier, setTier] = useState<'Bronze' | 'Silver' | 'Gold'>('Bronze');\r\n\r\n    // Optimization & Visuals\r\n    const [activeBatch, setActiveBatch] = useState<TiffinOrder[]>([]);\r\n    const [batchRoute, setBatchRoute] = useState<OptimizationResult | null>(null);\r\n    const [showTraffic, setShowTraffic] = useState(false);\r\n    const [isOptimizing, setIsOptimizing] = useState(false);\r\n\r\n    const [forecast, setForecast] = useState(0);\r\n    const [searchQuery, setSearchQuery] = useState('');\r\n\r\n    const [isAccepting, setIsAccepting] = useState<boolean>(false);\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    const [chatOpen, setChatOpen] = useState(false);\r\n    const [showStats, setShowStats] = useState(false);\r\n    const [incomingDistance, setIncomingDistance] = useState<number | null>(null);\r\n    const [allPendingRequests, setAllPendingRequests] = useState<RideRequest[]>([]);\r\n    const [newRouteDest, setNewRouteDest] = useState('');\r\n    const [newRoutePrice, setNewRoutePrice] = useState('');\r\n    const [locationError, setLocationError] = useState<string | null>(null);\r\n    const statsRef = useRef<HTMLElement>(null);\r\n\r\n    useClickOutside(statsRef, () => setShowStats(false));\r\n\r\n    // Proximity Helper (Haversine Formula)\r\n    const calculateDistance = (lat1: number, lon1: number, lat2: number, lon2: number) => {\r\n        const R = 6371; // Radius of the earth in km\r\n        const dLat = (lat2 - lat1) * Math.PI / 180;\r\n        const dLon = (lon2 - lon1) * Math.PI / 180;\r\n        const a =\r\n            Math.sin(dLat / 2) * Math.sin(dLat / 2) +\r\n            Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *\r\n            Math.sin(dLon / 2) * Math.sin(dLon / 2);\r\n        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n        return R * c; // Distance in km\r\n    };\r\n\r\n    // 1. Stable listener for Pending Requests (Open Market)\r\n    useEffect(() => {\r\n        if (!user.id || !user.vehicleType || !user.isApproved) return;\r\n\r\n        const q = query(\r\n            collection(db, 'rides'),\r\n            where('status', '==', RideStatus.SEARCHING),\r\n            where('vehicleType', '==', user.vehicleType)\r\n        );\r\n\r\n        const unsub = onSnapshot(q, (snapshot) => {\r\n            const requests = snapshot.docs.map(d => ({ id: d.id, ...d.data() } as RideRequest));\r\n            setAllPendingRequests(requests);\r\n\r\n            // Calculate Dynamic Forecast based on total demand\r\n            const demandFactor = requests.length * 50;\r\n            setForecast(Math.max(150, demandFactor + 200));\r\n        }, (err) => {\r\n            console.error(\"Pending Rides Listener Error:\", err);\r\n        });\r\n\r\n        return () => unsub();\r\n    }, [user.id, user.vehicleType, user.isApproved]);\r\n\r\n    // 2. Stable listener for Active Trip & Earnings\r\n    useEffect(() => {\r\n        if (!user.id || !user.isApproved) return;\r\n\r\n        // Active Trip\r\n        const qActive = query(\r\n            collection(db, 'rides'),\r\n            where('driverId', '==', user.id),\r\n            where('status', 'in', [RideStatus.ACCEPTED, RideStatus.ARRIVED, RideStatus.STARTED])\r\n        );\r\n\r\n        const unsubActive = onSnapshot(qActive, (snapshot) => {\r\n            if (!snapshot.empty) {\r\n                const trip = { id: snapshot.docs[0].id, ...snapshot.docs[0].data() } as RideRequest;\r\n                setActiveTrip(trip);\r\n            } else {\r\n                setActiveTrip(null);\r\n            }\r\n        });\r\n\r\n        // Daily Earnings\r\n        const startOfDay = new Date();\r\n        startOfDay.setHours(0, 0, 0, 0);\r\n        const qEarnings = query(\r\n            collection(db, 'rides'),\r\n            where('driverId', '==', user.id),\r\n            where('status', '==', RideStatus.COMPLETED),\r\n            where('createdAt', '>=', startOfDay)\r\n        );\r\n\r\n        const unsubEarnings = onSnapshot(qEarnings, (snapshot) => {\r\n            const rides = snapshot.docs.map(d => d.data() as RideRequest);\r\n            const total = rides.reduce((acc, curr) => acc + (curr.estimatedFare || 0), 0);\r\n            setDailyEarnings(total);\r\n            setCompletedRidesToday(rides.length);\r\n        });\r\n\r\n        return () => {\r\n            unsubActive();\r\n            unsubEarnings();\r\n        };\r\n    }, [user.id, user.isApproved]);\r\n\r\n    // 3. Proximity & Online Filtering (Client-side, High frequency ok)\r\n    useEffect(() => {\r\n        if (!user.isOnline || !user.isApproved) {\r\n            setIncomingRide(null);\r\n            setIncomingDistance(null);\r\n            return;\r\n        }\r\n\r\n        // Find relevant request (targeted or within 5km)\r\n        const relevant = allPendingRequests.find(r => {\r\n            const isTargeted = r.driverId === user.id;\r\n            const isOpenMarket = !r.driverId;\r\n\r\n            let isNearby = true;\r\n            let dist = 0;\r\n            if (isOpenMarket && user.currentLocation) {\r\n                dist = calculateDistance(\r\n                    user.currentLocation.lat,\r\n                    user.currentLocation.lng,\r\n                    r.pickupLocation.lat,\r\n                    r.pickupLocation.lng\r\n                );\r\n                isNearby = dist <= 5; // 5km radius\r\n            }\r\n\r\n            if (isTargeted || (isOpenMarket && isNearby)) {\r\n                // If targeted, we don't strictly need distance for eligibility, but for display:\r\n                if (isTargeted && user.currentLocation) {\r\n                    dist = calculateDistance(\r\n                        user.currentLocation.lat,\r\n                        user.currentLocation.lng,\r\n                        r.pickupLocation.lat,\r\n                        r.pickupLocation.lng\r\n                    );\r\n                }\r\n                setIncomingDistance(dist);\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n\r\n        if (relevant) {\r\n            setIncomingRide(relevant);\r\n        } else {\r\n            setIncomingRide(null);\r\n            setIncomingDistance(null);\r\n        }\r\n    }, [allPendingRequests, user.isOnline, user.currentLocation, user.id, user.isApproved]);\r\n\r\n\r\n    // 4. Background Location Tracking for Online Drivers\r\n    useEffect(() => {\r\n        if (!user.id || !user.isOnline || !user.isApproved) {\r\n            setLocationError(null);\r\n            return;\r\n        }\r\n\r\n        let watchId: number | null = null;\r\n\r\n        watchId = watchPosition(\r\n            async (coords) => {\r\n                try {\r\n                    // Phase 2: Snap to Road for smooth visualization\r\n                    const snapped = await getNearestRoad(coords, CONFIG.MAPS_API_KEY);\r\n                    const userDocRef = doc(db, 'users', user.id);\r\n                    await updateDoc(userDocRef, {\r\n                        currentLocation: snapped,\r\n                        lastOnline: Date.now()\r\n                    });\r\n                    setLocationError(null);\r\n                } catch (err) {\r\n                    console.error(\"Critical: Location Sync Failure\", err);\r\n                }\r\n            },\r\n            (error: GeolocationError) => {\r\n                console.error(\"Geolocation Error:\", error);\r\n                setLocationError(error.userMessage);\r\n\r\n                // If permission denied, turn driver offline\r\n                if (error.type === GeolocationErrorType.PERMISSION_DENIED) {\r\n                    updateDoc(doc(db, 'users', user.id), {\r\n                        isOnline: false\r\n                    }).catch(err => console.error(\"Failed to update online status\", err));\r\n                }\r\n            },\r\n            {\r\n                enableHighAccuracy: true,\r\n                maximumAge: 5000,\r\n                timeout: 10000\r\n            }\r\n        );\r\n\r\n        return () => {\r\n            if (watchId !== null) clearWatch(watchId);\r\n        };\r\n    }, [user.id, user.isOnline, user.isApproved]);\r\n\r\n\r\n    // Tiffin Logistics Listener\r\n    useEffect(() => {\r\n        if (mode !== 'TIFFIN') return;\r\n\r\n        // Pending Tiffin Orders (Marketplace)\r\n        const qTiffinPending = query(\r\n            collection(db, 'tiffinOrders'),\r\n            where('status', '==', 'PENDING')\r\n        );\r\n\r\n        // Active Tiffin Delivery\r\n        const qTiffinActive = query(\r\n            collection(db, 'tiffinOrders'),\r\n            where('driverId', '==', user.id),\r\n            where('status', '==', 'PICKED')\r\n        );\r\n\r\n        const unsubTiffinPending = onSnapshot(qTiffinPending, (snapshot) => {\r\n            const orders = snapshot.docs.map(d => ({ id: d.id, ...d.data() } as TiffinOrder));\r\n            setTiffinOrders(orders);\r\n        });\r\n\r\n        const unsubTiffinActive = onSnapshot(qTiffinActive, (snapshot) => {\r\n            const orders = snapshot.docs.map(d => ({ id: d.id, ...d.data() } as TiffinOrder));\r\n            setActiveBatch(orders);\r\n        });\r\n\r\n        return () => {\r\n            unsubTiffinPending();\r\n            unsubTiffinActive();\r\n        };\r\n    }, [mode, user.id]);\r\n\r\n    // Auto-Optimize Tiffin Batch\r\n    useEffect(() => {\r\n        if (mode === 'TIFFIN' && activeBatch.length > 1 && user.currentLocation) {\r\n            const runOptimization = async () => {\r\n                setIsOptimizing(true);\r\n                try {\r\n                    const stops: OptimizedStop[] = activeBatch.map(order => ({\r\n                        orderId: order.id,\r\n                        type: 'DELIVERY',\r\n                        location: order.deliveryLocation || user.currentLocation!, // Fallback to current\r\n                        address: order.deliveryAddress\r\n                    }));\r\n                    const result = await optimizeTiffinBatch(user.currentLocation!, stops, CONFIG.MAPS_API_KEY);\r\n                    setBatchRoute(result);\r\n                } catch (err) {\r\n                    console.error(\"Batch optimization failed\", err);\r\n                } finally {\r\n                    setIsOptimizing(false);\r\n                }\r\n            };\r\n            runOptimization();\r\n        } else if (activeBatch.length <= 1) {\r\n            setBatchRoute(null);\r\n        }\r\n    }, [activeBatch.length, mode, user.currentLocation]);\r\n\r\n    // Determine Tier\r\n    useEffect(() => {\r\n        const total = (user.totalRides || 0) + completedRidesToday;\r\n        if (total > 50) setTier('Gold');\r\n        else if (total > 20) setTier('Silver');\r\n        else setTier('Bronze');\r\n    }, [user.totalRides, completedRidesToday]);\r\n\r\n    const handleNavigate = (destination: string) => {\r\n        if (!destination) return;\r\n        // Open Google Maps Navigation\r\n        const url = `https://www.google.com/maps/dir/?api=1&destination=${encodeURIComponent(destination)}`;\r\n        window.open(url, '_blank');\r\n    };\r\n\r\n    const handleUpdateStatus = async (newStatus: RideStatus) => {\r\n        if (!activeTrip) return;\r\n        try {\r\n            await updateDoc(doc(db, 'rides', activeTrip.id), {\r\n                status: newStatus,\r\n                updatedAt: serverTimestamp(),\r\n                ...(newStatus === RideStatus.STARTED ? { startedAt: serverTimestamp() } : {}),\r\n                ...(newStatus === RideStatus.COMPLETED ? { completedAt: serverTimestamp() } : {}),\r\n            });\r\n        } catch (err) {\r\n            console.error(\"Status update error:\", err);\r\n        }\r\n    };\r\n\r\n    const handleTiffinAction = async (orderId: string, action: 'ACCEPT' | 'DELIVER') => {\r\n        try {\r\n            if (action === 'ACCEPT') {\r\n                await updateDoc(doc(db, 'tiffinOrders', orderId), {\r\n                    status: 'PICKED',\r\n                    driverId: user.id,\r\n                    driverName: user.name,\r\n                    pickedAt: serverTimestamp()\r\n                });\r\n            } else {\r\n                await updateDoc(doc(db, 'tiffinOrders', orderId), {\r\n                    status: 'DELIVERED',\r\n                    deliveredAt: serverTimestamp()\r\n                });\r\n            }\r\n        } catch (err) {\r\n            console.error(\"Tiffin action failed\", err);\r\n        }\r\n    };\r\n\r\n    const handleAddPreference = async () => {\r\n        if (!newRouteDest || !newRoutePrice) return;\r\n        const current = user.preferredRoutes || [];\r\n        if (current.some(r => r.destination === newRouteDest)) return;\r\n\r\n        try {\r\n            await updateDoc(doc(db, 'users', user.id), {\r\n                preferredRoutes: [...current, { destination: newRouteDest, price: Number(newRoutePrice) }]\r\n            });\r\n            setNewRouteDest('');\r\n            setNewRoutePrice('');\r\n        } catch (err) {\r\n            console.error(\"Error adding preference:\", err);\r\n        }\r\n    };\r\n\r\n    const handleRemovePreference = async (destination: string) => {\r\n        const current = user.preferredRoutes || [];\r\n        try {\r\n            await updateDoc(doc(db, 'users', user.id), {\r\n                preferredRoutes: current.filter(d => d.destination !== destination)\r\n            });\r\n        } catch (err) {\r\n            console.error(\"Error removing preference:\", err);\r\n        }\r\n    };\r\n\r\n    const handleAccept = async () => {\r\n        if (!incomingRide) return;\r\n        setIsAccepting(true);\r\n        try {\r\n            await updateDoc(doc(db, 'rides', incomingRide.id), {\r\n                status: RideStatus.ACCEPTED,\r\n                driverId: user.id,\r\n                driverName: user.name,\r\n                driverPhone: user.phone,\r\n                driverAvatar: user.avatar,\r\n                driverRating: user.rating || 4.9,\r\n                driverDetails: {\r\n                    name: user.name,\r\n                    avatar: user.avatar,\r\n                    vehicleModel: user.vehicleModel,\r\n                    vehicleNumber: user.vehicleNumber,\r\n                    rating: user.rating || 4.9\r\n                },\r\n                acceptedAt: serverTimestamp()\r\n            });\r\n            setIncomingRide(null);\r\n        } catch (err) {\r\n            console.error(\"Accept error:\", err);\r\n            alert(\"Failed to accept ride. It might have been taken by another partner.\");\r\n        } finally {\r\n            setIsAccepting(false);\r\n        }\r\n    };\r\n\r\n    const t = {\r\n        en: {\r\n            center: 'Command Center',\r\n            online: 'Online',\r\n            goal: 'Daily Earnings Goal',\r\n            acceptance: 'Acceptance',\r\n            rating: 'Rating',\r\n            hotspots: 'Demand Hotspots',\r\n            find: 'Find high demand zones...',\r\n            surge: 'Peak Surge Alert',\r\n            indiranagar: 'Sadar Bazar: 2.5x multiplier active',\r\n            search: 'Live',\r\n            pending: 'Approval Pending',\r\n            pendingMsg: 'Your account is under review by the Gaadiwala administration. This usually takes 24-48 hours.',\r\n        },\r\n        hi: {\r\n            center: ' ',\r\n            online: '',\r\n            goal: '   ',\r\n            acceptance: ' ',\r\n            rating: '',\r\n            hotspots: ' ',\r\n            find: '    ...',\r\n            surge: '  ',\r\n            indiranagar: ' : 2.5   ',\r\n            search: '',\r\n            pending: ' ',\r\n            pendingMsg: '  Gaadiwala        24-48   ',\r\n        }\r\n    };\r\n\r\n    const text = t[lang];\r\n    const isActuallyApproved = user.isApproved;\r\n    const isPink = user.vehicleType === VehicleCategory.PINK;\r\n    const accentBg = isPink ? 'bg-pink-500' : 'bg-[#00D1FF]';\r\n    const accentText = isPink ? 'text-pink-400' : 'text-[#00D1FF]';\r\n    const accentBorder = isPink ? 'border-pink-500/30' : 'border-[#00D1FF]/30';\r\n\r\n    if (!isActuallyApproved) {\r\n        return (\r\n            <div className=\"h-screen w-full bg-[#0A0E12] flex items-center justify-center p-6 text-center\">\r\n                <div className=\"max-w-md space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500\">\r\n                    <div className={`size-24 rounded-full ${isPink ? 'bg-pink-500/10' : 'bg-amber-500/10'} flex items-center justify-center mx-auto ring-8 ${isPink ? 'ring-pink-500/5' : 'ring-amber-500/5'}`}>\r\n                        <span className={`material-symbols-outlined text-5xl ${isPink ? 'text-pink-500' : 'text-amber-500'}`}>hourglass_empty</span>\r\n                    </div>\r\n                    <div>\r\n                        <h1 className=\"text-3xl font-black text-white mb-2 tracking-tight\">{isPink ? 'Pink Cab Verification' : text.pending}</h1>\r\n                        <p className=\"text-slate-400 leading-relaxed text-sm\">{user.rejectionReason || text.pendingMsg}</p>\r\n                    </div>\r\n                    <div className=\"p-4 rounded-2xl bg-white/5 border border-white/10 text-left\">\r\n                        <div className=\"flex justify-between items-center mb-2\">\r\n                            <span className=\"text-[10px] font-black uppercase text-slate-500\">Status Check</span>\r\n                            <span className={`size-2 rounded-full ${isPink ? 'bg-pink-500' : 'bg-amber-500'} animate-pulse`}></span>\r\n                        </div>\r\n                        <div className=\"flex gap-4\">\r\n                            <div className={`w-1 h-12 ${isPink ? 'bg-pink-500' : 'bg-amber-500'} rounded-full`}></div>\r\n                            <div>\r\n                                <p className=\"text-xs font-bold text-white\">\r\n                                    {user.rejectionReason ? 'Re-verification Needed' : (isPink ? 'Female Safety Check' : 'Identity Verified')}\r\n                                </p>\r\n                                <p className=\"text-[10px] text-slate-500 italic\">\r\n                                    {user.rejectionReason || (isPink ? 'Confirming female partner status...' : 'Waiting for vehicle check...')}\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <button onClick={() => window.location.reload()} className=\"text-xs font-bold text-slate-500 uppercase tracking-widest hover:text-white\">Check Again</button>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"dark bg-[#0A0E12] text-slate-100 font-display h-[calc(100vh-48px)] overflow-hidden flex flex-col\">\r\n            <GlobalBanner />\r\n            <header className=\"h-16 border-b border-white/10 bg-[#161B22] px-4 md:px-6 flex items-center justify-between z-50\">\r\n                <div className=\"flex items-center gap-4 md:gap-10\">\r\n                    <div className=\"flex items-center gap-2 md:gap-3\">\r\n                        <div className={`w-8 h-8 md:w-9 md:h-9 ${accentBg} rounded flex items-center justify-center shadow-[0_0_15px_rgba(0,209,255,0.4)] shrink-0`}>\r\n                            <span className=\"material-symbols-outlined text-black font-bold text-sm md:text-base\">directions_car</span>\r\n                        </div>\r\n                        <div className=\"min-w-0 flex flex-col\">\r\n                            <span className=\"text-lg md:text-xl font-extrabold tracking-tighter text-white truncate italic leading-none\">Gaadiwala</span>\r\n                            <span className={`text-[9px] font-black uppercase tracking-widest ${accentText} leading-none mt-1`}>\r\n                                {isPink ? ' Pink Partner' : 'Partner Central'}\r\n                            </span>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"hidden lg:flex items-center gap-2 bg-white/5 p-1 rounded border border-white/10\">\r\n                        <button\r\n                            onClick={() => setLang('en')}\r\n                            className={`px-3 py-1 text-xs font-bold rounded transition-all ${lang === 'en' ? `${accentBg} text-black` : 'text-slate-400'}`}\r\n                        >\r\n                            English\r\n                        </button>\r\n                        <button\r\n                            onClick={() => setLang('hi')}\r\n                            className={`px-3 py-1 text-xs font-bold rounded transition-all ${lang === 'hi' ? `${accentBg} text-black` : 'text-slate-400'}`}\r\n                        >\r\n                            \r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"flex items-center gap-3 md:gap-6\">\r\n                    <button\r\n                        onClick={() => setShowStats(!showStats)}\r\n                        className=\"lg:hidden size-10 rounded-lg bg-white/5 border border-white/10 flex items-center justify-center text-[#00D1FF]\"\r\n                    >\r\n                        <span className=\"material-symbols-outlined\">{showStats ? 'close' : 'bar_chart'}</span>\r\n                    </button>\r\n                    <button\r\n                        onClick={async () => {\r\n                            try {\r\n                                const newStatus = !user.isOnline;\r\n                                await updateDoc(doc(db, 'users', user.id), {\r\n                                    isOnline: newStatus,\r\n                                    lastOnline: Date.now()\r\n                                });\r\n                            } catch (err) {\r\n                                console.error(\"Failed to update status\", err);\r\n                                alert(\"Failed to update status\");\r\n                            }\r\n                        }}\r\n                        className={`flex items-center gap-2 border px-3 md:px-4 py-1.5 rounded-full shrink-0 transition-all ${user.isOnline ? 'bg-black/40 border-white/10' : 'bg-red-500/10 border-red-500/20'}`}\r\n                    >\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <span className=\"relative flex h-2 w-2 md:h-3 md:w-3\">\r\n                                {user.isOnline && <span className={`animate-ping absolute inline-flex h-full w-full rounded-full ${accentBg} opacity-75`}></span>}\r\n                                <span className={`relative inline-flex rounded-full h-2 w-2 md:h-3 md:w-3 ${user.isOnline ? accentBg : 'bg-red-500'}`}></span>\r\n                            </span>\r\n                            <span className={`text-[10px] font-bold tracking-widest uppercase ${user.isOnline ? accentText : 'text-red-500'}`}>\r\n                                {user.isOnline ? text.online : 'OFFLINE'}\r\n                            </span>\r\n                        </div>\r\n                    </button>\r\n                    <div\r\n                        onClick={() => navigate('/driver/profile')}\r\n                        className=\"flex items-center gap-2 md:gap-3 cursor-pointer group\"\r\n                    >\r\n                        <div className=\"text-right hidden sm:block\">\r\n                            <p className=\"text-sm font-bold text-white flex items-center gap-1 group-hover:text-[#00D1FF] transition-colors\">\r\n                                {user.name}\r\n                                {user.isKycCompleted && <span className=\"material-symbols-outlined text-[#00D1FF] text-[14px] filled\">verified</span>}\r\n                            </p>\r\n                            <p className={`text-[9px] font-bold uppercase tracking-wider truncate ${tier === 'Gold' ? 'text-amber-400' : tier === 'Silver' ? 'text-slate-300' : 'text-orange-700'}`}>\r\n                                {tier} Partner\r\n                            </p>\r\n                        </div>\r\n                        <div className=\"w-8 h-8 md:w-10 md:h-10 rounded-full bg-slate-800 border-2 border-[#00D1FF] flex items-center justify-center shrink-0 overflow-hidden group-hover:scale-110 transition-transform\">\r\n                            <img src={user.avatar || `https://api.dicebear.com/7.x/avataaars/svg?seed=${user.id}`} className=\"w-full h-full object-cover\" alt=\"avatar\" />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </header>\r\n\r\n            <main className=\"flex-1 flex overflow-hidden relative\">\r\n                <aside\r\n                    ref={statsRef}\r\n                    className={`\r\n                    absolute inset-y-0 left-0 w-80 bg-[#0A0E12] border-r border-white/10 z-40 transform transition-transform duration-300\r\n                    ${showStats ? 'translate-x-0' : '-translate-x-full'}\r\n                    lg:relative lg:translate-x-0\r\n                    flex flex-col p-5 gap-5 overflow-y-auto\r\n                `}>\r\n                    {/* Earnings Widget */}\r\n                    <div\r\n                        onClick={() => navigate('/driver/earnings')}\r\n                        className=\"p-5 rounded-xl border border-white/10 bg-[#161B22]/80 backdrop-blur-md cursor-pointer hover:border-[#00D1FF]/50 transition-colors group\"\r\n                    >\r\n                        <div className=\"flex justify-between items-start mb-4\">\r\n                            <div>\r\n                                <p className=\"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1 group-hover:text-white transition-colors\">Today's Earnings</p>\r\n                                <h2 className=\"text-3xl font-black text-white\">{dailyEarnings}</h2>\r\n                            </div>\r\n                            <div className=\"bg-[#00D1FF]/10 text-[#00D1FF] px-2 py-1 rounded text-[10px] font-bold border border-[#00D1FF]/20\">\r\n                                {completedRidesToday} Rides\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"relative pt-1\">\r\n                            <div className=\"flex items-center justify-between text-[9px] font-bold uppercase text-slate-500 mb-1\">\r\n                                <span>Forecast (4h)</span>\r\n                                <span className={accentText}>~{forecast}</span>\r\n                            </div>\r\n                            <div className=\"w-full bg-white/5 h-1.5 rounded-full overflow-hidden\">\r\n                                <div className={`${accentBg} h-full rounded-full animate-pulse`} style={{ width: '100%' }}></div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"grid grid-cols-2 gap-3\">\r\n                        <div className=\"p-4 rounded-xl border border-white/10 bg-[#161B22]/80 text-center\">\r\n                            <div className=\"text-2xl font-bold text-green-500\">96%</div>\r\n                            <p className=\"text-[10px] font-bold text-slate-500 uppercase mt-1\">{text.acceptance}</p>\r\n                        </div>\r\n                        <div className=\"p-4 rounded-xl border border-white/10 bg-[#161B22]/80 text-center\">\r\n                            <div className=\"flex items-center justify-center gap-1\">\r\n                                <span className=\"text-2xl font-bold text-white\">4.9</span>\r\n                                <span className=\"material-symbols-outlined text-amber-400 text-sm\">star</span>\r\n                            </div>\r\n                            <p className=\"text-[10px] font-bold text-slate-500 uppercase mt-1\">{text.rating}</p>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div>\r\n                        <div className=\"flex items-center justify-between mb-3 px-1\">\r\n                            <h3 className=\"text-xs font-bold text-white uppercase tracking-wider\">{text.hotspots}</h3>\r\n                            <span className={`text-[10px] font-bold ${accentText} uppercase`}>{text.search}</span>\r\n                        </div>\r\n                        <div className=\"space-y-2\">\r\n                            <div className=\"p-3 bg-white/5 border border-white/5 rounded-lg flex items-center justify-between\">\r\n                                <div>\r\n                                    <p className=\"text-xs font-bold text-white\">Krishna Janmasthan</p>\r\n                                    <p className=\"text-[10px] text-slate-500 uppercase\">2.1x Surge  High Demand</p>\r\n                                </div>\r\n                                <span className=\"material-symbols-outlined text-red-500\">local_fire_department</span>\r\n                            </div>\r\n                            <div className=\"p-3 bg-white/5 border border-white/5 rounded-lg flex items-center justify-between\">\r\n                                <div>\r\n                                    <p className=\"text-xs font-bold text-white\">Mathura Junction</p>\r\n                                    <p className=\"text-[10px] text-slate-500 uppercase\">1.8x Surge  3 min wait</p>\r\n                                </div>\r\n                                <span className=\"material-symbols-outlined text-amber-400\">trending_up</span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"mt-4 pt-4 border-t border-white/10\">\r\n                        <div className=\"flex items-center gap-2 mb-3 px-1\">\r\n                            <span className={`material-symbols-outlined ${accentText} text-sm`}>route</span>\r\n                            <h3 className=\"text-xs font-bold text-white uppercase tracking-wider\">Heading To</h3>\r\n                        </div>\r\n\r\n                        <div className=\"space-y-3\">\r\n                            {/* Tags Container */}\r\n                            <div className=\"flex flex-wrap gap-2 px-1\">\r\n                                {(user.preferredRoutes || []).map((route, i) => (\r\n                                    <div key={i} className={`flex flex-col gap-1 ${isPink ? 'bg-pink-500/10 border-pink-500/30' : 'bg-[#00D1FF]/10 border-[#00D1FF]/30'} border rounded-xl p-3 relative group/tag`}>\r\n                                        <div className=\"flex justify-between items-start gap-4\">\r\n                                            <span className={`text-[10px] font-black ${accentText} uppercase truncate leading-none`}>{route.destination}</span>\r\n                                            <button\r\n                                                onClick={() => handleRemovePreference(route.destination)}\r\n                                                className=\"material-symbols-outlined text-[12px] text-slate-500 hover:text-red-500 transition-colors\"\r\n                                            >\r\n                                                close\r\n                                            </button>\r\n                                        </div>\r\n                                        <div className={`flex items-center gap-1.5 pt-1 border-t ${accentBorder}`}>\r\n                                            <span className=\"text-[9px] font-black text-white\">{route.price}</span>\r\n                                            <span className=\"text-[7px] font-bold text-slate-500 uppercase tracking-tighter\">Fixed Fare</span>\r\n                                        </div>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n\r\n                            <div className=\"space-y-2\">\r\n                                <div className=\"relative group\">\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        placeholder=\"Destination...\"\r\n                                        value={newRouteDest}\r\n                                        onChange={(e) => setNewRouteDest(e.target.value)}\r\n                                        className=\"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-xs font-bold text-white outline-none focus:border-[#00D1FF]/50 transition-all placeholder:text-slate-600\"\r\n                                    />\r\n                                    <div className=\"absolute right-3 top-1/2 -translate-y-1/2 opacity-30 group-focus-within:opacity-100 transition-opacity pointer-events-none\">\r\n                                        <span className=\"material-symbols-outlined text-sm text-slate-500\">location_on</span>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"flex gap-2\">\r\n                                    <div className=\"relative flex-1\">\r\n                                        <input\r\n                                            type=\"number\"\r\n                                            placeholder=\"Price ()\"\r\n                                            value={newRoutePrice}\r\n                                            onChange={(e) => setNewRoutePrice(e.target.value)}\r\n                                            className=\"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-xs font-bold text-white outline-none focus:border-[#00D1FF]/50 transition-all placeholder:text-slate-600\"\r\n                                        />\r\n                                        <div className=\"absolute right-3 top-1/2 -translate-y-1/2 opacity-30 pointer-events-none\">\r\n                                            <span className=\"text-[10px] font-black text-slate-500\">INR</span>\r\n                                        </div>\r\n                                    </div>\r\n                                    <button\r\n                                        onClick={handleAddPreference}\r\n                                        disabled={!newRouteDest || !newRoutePrice}\r\n                                        className={`${accentBg} text-black px-4 rounded-xl flex items-center justify-center hover:scale-105 active:scale-95 transition-all disabled:opacity-20 disabled:scale-100`}\r\n                                    >\r\n                                        <span className=\"material-symbols-outlined text-base font-black\">add</span>\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Safety Council Widget */}\r\n                        <div className=\"mt-6 pt-6 border-t border-white/10\">\r\n                            <div className=\"bg-[#161B22] border border-white/10 rounded-2xl p-5 relative overflow-hidden group\">\r\n                                <div className={`absolute top-0 right-0 p-4 ${accentText} opacity-10 group-hover:opacity-20 transition-opacity`}>\r\n                                    <span className=\"material-symbols-outlined text-5xl\">verified_user</span>\r\n                                </div>\r\n                                <h4 className=\"text-[10px] font-black text-white uppercase tracking-widest mb-2\">Safety Council</h4>\r\n                                <p className=\"text-[10px] text-slate-500 font-bold mb-4 italic leading-relaxed\">\r\n                                    {isPink ? 'You are part of our priority female safety network.' : 'Help us maintain 100% safety standards across all routes.'}\r\n                                </p>\r\n                                <button className={`w-full py-2.5 rounded-xl bg-white/5 border border-white/10 text-[9px] font-black uppercase tracking-widest ${accentText} hover:bg-white/10 transition-all`}>\r\n                                    View Protocol\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Quick Navigation Addition */}\r\n                        <div className=\"mt-4 space-y-2\">\r\n                            <button\r\n                                onClick={() => navigate('/driver/profile')}\r\n                                className=\"w-full flex items-center justify-between p-4 bg-white/5 border border-white/5 rounded-2xl group hover:border-white/20 transition-all\"\r\n                            >\r\n                                <div className=\"flex items-center gap-3\">\r\n                                    <div className={`size-8 rounded-xl ${accentBg}/10 flex items-center justify-center`}>\r\n                                        <span className={`material-symbols-outlined text-base ${accentText}`}>person</span>\r\n                                    </div>\r\n                                    <span className=\"text-[10px] font-black text-white uppercase tracking-widest\">Manage Profile</span>\r\n                                </div>\r\n                                <span className=\"material-symbols-outlined text-sm text-slate-600 transition-transform group-hover:translate-x-1\">arrow_forward</span>\r\n                            </button>\r\n                        </div>\r\n\r\n                        <p className=\"text-[8px] font-black uppercase text-slate-500 mt-4 px-1 tracking-widest leading-relaxed\">Setting fixed pricing for routes makes you 2x more likely to get picked by riders.</p>\r\n                    </div>\r\n                </aside>\r\n\r\n                <section className=\"flex-1 relative bg-[#0f141a] overflow-hidden\">\r\n                    {/* Replace iframe with MapContainer */}\r\n                    <div className=\"absolute inset-0 w-full h-full\">\r\n                        <MapContainer\r\n                            center={user.currentLocation}\r\n                            pickup={user.currentLocation}\r\n                            drop={activeTrip?.dropLocation}\r\n                            drivers={allPendingRequests\r\n                                .filter(r => r.pickupLocation)\r\n                                .map(r => r.pickupLocation)\r\n                            }\r\n                            showTraffic={showTraffic}\r\n                            polyline={batchRoute?.polyline}\r\n                            className=\"grayscale brightness-[0.4] contrast-150\"\r\n                        />\r\n                    </div>\r\n                    <div className=\"absolute inset-0 bg-blue-900/10 pointer-events-none\"></div>\r\n\r\n                    {/* Location Error Banner */}\r\n                    {locationError && (\r\n                        <div className=\"absolute top-4 left-1/2 -translate-x-1/2 bg-red-500/90 backdrop-blur-md text-white px-4 py-2 rounded-lg shadow-lg z-50 max-w-md text-center\">\r\n                            <p className=\"text-xs font-bold\">{locationError}</p>\r\n                        </div>\r\n                    )}\r\n\r\n                    <div className=\"absolute top-4 md:top-6 left-4 md:left-6 right-4 md:right-auto md:w-96 flex flex-col gap-4\">\r\n                        {/* Search Bar */}\r\n                        <div className=\"bg-[#161B22]/90 backdrop-blur-md p-1.5 rounded-2xl flex items-center gap-2 border border-white/20 shadow-2xl\">\r\n                            <div className=\"flex-1 flex items-center gap-3 px-3\">\r\n                                <span className={`material-symbols-outlined ${accentText} text-xl`}>location_on</span>\r\n                                <input\r\n                                    className=\"w-full border-none focus:ring-0 bg-transparent text-sm font-bold text-white placeholder-slate-500\"\r\n                                    placeholder={text.find}\r\n                                    type=\"text\"\r\n                                    value={searchQuery}\r\n                                    onChange={(e) => setSearchQuery(e.target.value)}\r\n                                    onKeyDown={(e) => e.key === 'Enter' && handleNavigate(searchQuery)}\r\n                                />\r\n                            </div>\r\n                            <button\r\n                                onClick={() => setShowTraffic(!showTraffic)}\r\n                                className={`p-2 rounded transition-all ${showTraffic ? 'text-[#00D1FF]' : 'text-slate-500'}`}\r\n                                title=\"Toggle Traffic\"\r\n                            >\r\n                                <span className=\"material-symbols-outlined font-bold\">traffic</span>\r\n                            </button>\r\n                            <button\r\n                                onClick={() => handleNavigate(searchQuery)}\r\n                                className={`${accentBg} text-black p-2 rounded transition-transform active:scale-95 shadow-lg`}\r\n                            >\r\n                                <span className=\"material-symbols-outlined font-bold\">navigation</span>\r\n                            </button>\r\n                        </div>\r\n\r\n                        <div className=\"bg-[#161B22]/90 backdrop-blur-md p-1.5 rounded-2xl flex items-center border border-white/20 shadow-2xl\">\r\n                            <button\r\n                                onClick={() => setMode('RIDE')}\r\n                                className={`flex-1 py-3 rounded-xl flex items-center justify-center gap-2 transition-all ${mode === 'RIDE' ? `${accentBg} text-black shadow-lg` : 'text-slate-400 hover:text-white'}`}\r\n                            >\r\n                                <span className=\"material-symbols-outlined text-sm font-bold\">directions_car</span>\r\n                                <span className=\"text-[10px] font-black uppercase tracking-widest\">Rides</span>\r\n                            </button>\r\n                            <button\r\n                                onClick={() => setMode('TIFFIN')}\r\n                                className={`flex-1 py-3 rounded-xl flex items-center justify-center gap-2 transition-all ${mode === 'TIFFIN' ? 'bg-orange-500 text-white shadow-lg' : 'text-slate-400 hover:text-white'}`}\r\n                            >\r\n                                <span className=\"material-symbols-outlined text-sm font-bold\">lunch_dining</span>\r\n                                <span className=\"text-[10px] font-black uppercase tracking-widest\">Tiffin</span>\r\n                            </button>\r\n                        </div>\r\n\r\n                        {/* Tiffin Feed */}\r\n                        {mode === 'TIFFIN' && !activeTiffin && (\r\n                            <div className=\"space-y-3 max-h-[60vh] overflow-y-auto\">\r\n                                {tiffinOrders.length > 0 ? tiffinOrders.map(order => (\r\n                                    <div key={order.id} className=\"bg-[#161B22]/95 backdrop-blur-md p-5 rounded-2xl border border-white/10 shadow-xl animate-in fade-in slide-in-from-bottom-4\">\r\n                                        <div className=\"flex justify-between items-start mb-3\">\r\n                                            <div>\r\n                                                <h4 className=\"font-bold text-white text-sm\">{order.vendorName}</h4>\r\n                                                <p className=\"text-[10px] text-slate-400 uppercase tracking-wider\">Tiffin Delivery</p>\r\n                                            </div>\r\n                                            <span className=\"text-lg font-black text-green-400\">{order.price}</span>\r\n                                        </div>\r\n                                        <div className=\"flex items-center gap-2 mb-4\">\r\n                                            <span className=\"material-symbols-outlined text-orange-500 text-sm\">location_on</span>\r\n                                            <p className=\"text-xs text-slate-300 truncate\">{order.deliveryAddress}</p>\r\n                                        </div>\r\n                                        <button\r\n                                            onClick={() => handleTiffinAction(order.id, 'ACCEPT')}\r\n                                            className=\"w-full py-3 bg-orange-500 hover:bg-orange-600 rounded-xl text-[10px] font-black uppercase tracking-widest text-white transition-colors\"\r\n                                        >\r\n                                            Accept Delivery\r\n                                        </button>\r\n                                    </div>\r\n                                )) : (\r\n                                    <div className=\"bg-[#161B22]/95 backdrop-blur-md p-8 rounded-2xl border border-white/10 text-center\">\r\n                                        <span className=\"material-symbols-outlined text-slate-600 text-4xl mb-2\">soup_kitchen</span>\r\n                                        <p className=\"text-xs font-bold text-slate-500\">No active tiffin orders nearby.</p>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* Active Tiffin Delivery */}\r\n                        {activeTiffin && (\r\n                            <div className=\"bg-[#161B22]/95 backdrop-blur-xl p-6 rounded-[2rem] border border-orange-500/30 shadow-[0_0_50px_rgba(249,115,22,0.1)] animate-in slide-in-from-left duration-500\">\r\n                                <div className=\"flex justify-between items-center mb-6\">\r\n                                    <div className=\"flex items-center gap-2\">\r\n                                        <div className=\"size-2 rounded-full bg-orange-500 animate-ping\"></div>\r\n                                        <span className=\"text-[10px] font-black uppercase text-orange-500 tracking-[0.2em]\">Tiffin Active</span>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"space-y-4 mb-6\">\r\n                                    <div className=\"flex gap-3\">\r\n                                        <span className=\"material-symbols-outlined text-orange-500 text-sm\">restaurant</span>\r\n                                        <div>\r\n                                            <p className=\"text-[9px] font-black uppercase text-slate-500 mb-0.5\">Pickup From</p>\r\n                                            <p className=\"text-xs font-bold text-white\">{activeTiffin.vendorName}</p>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"flex gap-3\">\r\n                                        <span className=\"material-symbols-outlined text-green-500 text-sm\">location_on</span>\r\n                                        <div>\r\n                                            <p className=\"text-[9px] font-black uppercase text-slate-500 mb-0.5\">Deliver To</p>\r\n                                            <p className=\"text-xs font-bold text-white line-clamp-2\">{activeTiffin.deliveryAddress}</p>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <button\r\n                                    onClick={() => handleTiffinAction(activeTiffin.id, 'DELIVER')}\r\n                                    className=\"w-full h-14 rounded-xl bg-orange-500 text-white font-black text-[10px] uppercase tracking-widest shadow-lg active:scale-95 transition-transform\"\r\n                                >\r\n                                    Confirm Delivery\r\n                                </button>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* Active Trip Widget */}\r\n                        {activeTrip && (\r\n                            <div className=\"bg-[#161B22]/95 backdrop-blur-xl p-6 rounded-[2rem] border border-[#00D1FF]/30 shadow-[0_0_50px_rgba(0,209,255,0.1)] animate-in slide-in-from-left duration-500\">\r\n                                <div className=\"flex justify-between items-center mb-6\">\r\n                                    <div className=\"flex items-center gap-2\">\r\n                                        <div className=\"size-2 rounded-full bg-[#00D1FF] animate-ping\"></div>\r\n                                        <span className=\"text-[10px] font-black uppercase text-[#00D1FF] tracking-[0.2em] drop-shadow-[0_0_5px_rgba(0,209,255,1)]\">Protocol Active</span>\r\n                                    </div>\r\n                                    <div className=\"flex flex-col items-end\">\r\n                                        <span className=\"text-[8px] font-black uppercase text-slate-500 tracking-widest\">Entry OTP</span>\r\n                                        <span className=\"text-xl font-black text-[#00D1FF] tracking-[0.4em]\">{activeTrip.otp}</span>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div className=\"space-y-4 mb-8\">\r\n                                    <div className=\"flex gap-3 items-center justify-between\">\r\n                                        <div className=\"flex gap-3 overflow-hidden\">\r\n                                            <span className=\"material-symbols-outlined text-green-500 text-sm shrink-0\">radio_button_checked</span>\r\n                                            <p className=\"text-xs font-bold text-white truncate\">{activeTrip.pickupAddress}</p>\r\n                                        </div>\r\n                                        <button onClick={() => handleNavigate(activeTrip.pickupAddress)} className=\"size-8 rounded-full bg-white/5 flex items-center justify-center hover:bg-[#00D1FF] hover:text-black transition-colors shrink-0\">\r\n                                            <span className=\"material-symbols-outlined text-sm\">navigation</span>\r\n                                        </button>\r\n                                    </div>\r\n                                    <div className=\"flex gap-3 items-center justify-between\">\r\n                                        <div className=\"flex gap-3 overflow-hidden\">\r\n                                            <span className=\"material-symbols-outlined text-orange-500 text-sm shrink-0\">location_on</span>\r\n                                            <p className=\"text-xs font-bold text-white truncate\">{activeTrip.dropAddress}</p>\r\n                                        </div>\r\n                                        <button onClick={() => handleNavigate(activeTrip.dropAddress)} className=\"size-8 rounded-full bg-white/5 flex items-center justify-center hover:bg-[#00D1FF] hover:text-black transition-colors shrink-0\">\r\n                                            <span className=\"material-symbols-outlined text-sm\">navigation</span>\r\n                                        </button>\r\n                                    </div>\r\n                                    <button\r\n                                        onClick={() => setChatOpen(true)}\r\n                                        className=\"w-full flex items-center justify-center gap-3 p-4 bg-[#00D1FF]/5 border border-[#00D1FF]/20 rounded-2xl hover:bg-[#00D1FF]/10 transition-all duration-300 group\"\r\n                                    >\r\n                                        <span className=\"material-symbols-outlined text-[#00D1FF] group-hover:scale-110 transition-transform\">forum</span>\r\n                                        <span className=\"text-[10px] font-black uppercase tracking-[0.2em] text-white\">Encrypted Chat</span>\r\n                                    </button>\r\n                                </div>\r\n\r\n                                <div className=\"grid grid-cols-2 gap-3\">\r\n                                    {activeTrip.status === RideStatus.ACCEPTED && (\r\n                                        <button onClick={() => handleUpdateStatus(RideStatus.ARRIVED)} className=\"col-span-2 h-14 rounded-xl bg-[#00D1FF] text-black font-black text-[10px] uppercase tracking-widest shadow-lg active:scale-95 transition-transform\">I Have Arrived</button>\r\n                                    )}\r\n                                    {activeTrip.status === RideStatus.ARRIVED && (\r\n                                        <button onClick={() => handleUpdateStatus(RideStatus.STARTED)} className=\"col-span-2 h-14 rounded-xl bg-green-500 text-white font-black text-[10px] uppercase tracking-widest shadow-lg active:scale-95 transition-transform\">Start Ride</button>\r\n                                    )}\r\n                                    {activeTrip.status === RideStatus.STARTED && (\r\n                                        <button onClick={() => handleUpdateStatus(RideStatus.COMPLETED)} className=\"col-span-2 h-14 rounded-xl bg-white text-black font-black text-[10px] uppercase tracking-widest shadow-lg active:scale-95 transition-transform\">Complete Trip</button>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </section>\r\n            </main>\r\n\r\n            {/* Incoming Ride Modal */}\r\n            {incomingRide && (\r\n                <div className=\"fixed inset-0 z-[100] bg-black/60 backdrop-blur-md flex items-end sm:items-center justify-center p-4\">\r\n                    <div className=\"w-full max-w-lg bg-[#161B22] border border-white/10 rounded-[2.5rem] overflow-hidden animate-in slide-in-from-bottom-10 duration-500 shadow-[0_0_50px_rgba(0,0,0,0.5)]\">\r\n                        <div className=\"h-2 bg-[#00D1FF] animate-pulse\"></div>\r\n                        <div className=\"p-8\">\r\n                            <div className=\"flex justify-between items-start mb-6\">\r\n                                <div className=\"flex items-center gap-4\">\r\n                                    <div className=\"size-16 rounded-2xl bg-white/5 border border-white/10 flex items-center justify-center\">\r\n                                        <span className=\"material-symbols-outlined text-4xl text-[#00D1FF]\">person</span>\r\n                                    </div>\r\n                                    <div>\r\n                                        <h3 className=\"text-2xl font-black text-white\">{incomingRide.riderName}</h3>\r\n                                        <div className=\"flex items-center gap-1 text-amber-400 font-bold text-sm\">\r\n                                            {incomingRide.riderRating}  <span className=\"text-slate-500 text-xs font-medium uppercase tracking-widest ml-1\">Verified Rider</span>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"text-right\">\r\n                                    <p className=\"text-[10px] font-black text-[#00D1FF] uppercase tracking-widest mb-1\">Proposed Fare</p>\r\n                                    <p className=\"text-4xl font-black text-white\">{incomingRide.estimatedFare}</p>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Distance & Info Bar */}\r\n                            <div className=\"grid grid-cols-2 gap-4 mb-8\">\r\n                                <div className=\"bg-white/5 p-4 rounded-2xl border border-white/5\">\r\n                                    <p className=\"text-[8px] font-black uppercase text-slate-500 tracking-widest mb-1\">Distance to Pickup</p>\r\n                                    <div className=\"flex items-center gap-2\">\r\n                                        <span className=\"material-symbols-outlined text-[#00D1FF] text-sm\">distance</span>\r\n                                        <p className=\"text-lg font-black text-white\">{incomingDistance !== null ? `${incomingDistance.toFixed(1)} km` : '---'}</p>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"bg-white/5 p-4 rounded-2xl border border-white/5\">\r\n                                    <p className=\"text-[8px] font-black uppercase text-slate-500 tracking-widest mb-1\">Est. Time</p>\r\n                                    <div className=\"flex items-center gap-2\">\r\n                                        <span className=\"material-symbols-outlined text-green-400 text-sm\">schedule</span>\r\n                                        <p className=\"text-lg font-black text-white\">{incomingDistance !== null ? `${Math.round(incomingDistance * 3)} mins` : '---'}</p>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"h-40 rounded-3xl overflow-hidden mb-8 border border-white/10 relative\">\r\n                                <div className=\"absolute inset-0 bg-slate-900 flex items-center justify-center text-[10px] font-black uppercase text-slate-600 tracking-widest\">\r\n                                    {/* Using a placeholder if MapContainer is too heavy for small modal, but let's try real map */}\r\n                                    <MapContainer\r\n                                        center={incomingRide.pickupLocation}\r\n                                        pickup={incomingRide.pickupLocation}\r\n                                        showTraffic={showTraffic}\r\n                                        className=\"grayscale opacity-50\"\r\n                                    />\r\n                                </div>\r\n                                <div className=\"absolute inset-x-0 bottom-0 h-1/2 bg-gradient-to-t from-[#161B22] to-transparent pointer-events-none\"></div>\r\n                                <div className=\"absolute bottom-4 left-4 bg-[#161B22]/80 backdrop-blur-md px-3 py-1 rounded-lg border border-white/10\">\r\n                                    <span className=\"text-[9px] font-black uppercase text-white tracking-widest\">Pickup Location</span>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"space-y-6 mb-10 relative\">\r\n                                <div className=\"absolute left-2.5 top-6 bottom-6 w-0.5 bg-white/5 border-l border-dashed border-white/20\"></div>\r\n                                <div className=\"flex gap-4\">\r\n                                    <div className=\"size-5 rounded-full bg-green-500 ring-4 ring-green-500/20 z-10\"></div>\r\n                                    <div className=\"flex-1\">\r\n                                        <p className=\"text-[9px] font-black text-slate-500 uppercase tracking-widest mb-1\">Pickup</p>\r\n                                        <p className=\"text-sm font-bold text-white line-clamp-1\">{incomingRide.pickupAddress}</p>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"flex gap-4\">\r\n                                    <div className=\"size-5 rounded-full bg-orange-500 ring-4 ring-orange-500/20 z-10\"></div>\r\n                                    <div className=\"flex-1\">\r\n                                        <p className=\"text-[9px] font-black text-slate-500 uppercase tracking-widest mb-1\">Destination</p>\r\n                                        <p className=\"text-sm font-bold text-white line-clamp-1\">{incomingRide.dropAddress}</p>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"flex gap-4\">\r\n                                <button\r\n                                    onClick={() => setIncomingRide(null)}\r\n                                    className=\"flex-1 h-16 rounded-2xl bg-white/5 text-slate-400 font-black text-xs uppercase tracking-widest hover:bg-white/10 transition-all\"\r\n                                >\r\n                                    Decline\r\n                                </button>\r\n                                <button\r\n                                    onClick={handleAccept}\r\n                                    disabled={isAccepting}\r\n                                    className=\"flex-[2] h-16 rounded-2xl bg-[#00D1FF] text-black font-black text-xs uppercase tracking-widest shadow-[0_0_30px_rgba(0,209,255,0.3)] hover:scale-[1.02] active:scale-[0.98] transition-all flex items-center justify-center gap-3 disabled:opacity-50\"\r\n                                >\r\n                                    {isAccepting ? (\r\n                                        <>Accepting... <span className=\"animate-spin material-symbols-outlined text-sm\">sync</span></>\r\n                                    ) : (\r\n                                        <>Accept Request <span className=\"material-symbols-outlined font-bold\">check_circle</span></>\r\n                                    )}\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default DriverDashboard;\r\n",
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\screens\\driver\\DriverProfile.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\screens\\driver\\Earnings.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\screens\\driver\\KYC.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\screens\\rider\\FlexFare.tsx",
        "messages": [
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'promoError' is assigned a value but never used.",
                "line": 74,
                "column": 12,
                "nodeType": "Identifier",
                "messageId": "unusedVar",
                "endLine": 74,
                "endColumn": 22
            },
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'mapSrc' is assigned a value but never used.",
                "line": 187,
                "column": 11,
                "nodeType": "Identifier",
                "messageId": "unusedVar",
                "endLine": 187,
                "endColumn": 17
            }
        ],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 2,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "source": "import React, { useState, useEffect } from 'react';\r\nimport { useLocation, useNavigate } from 'react-router-dom';\r\nimport { RideType, VehicleCategory, ScheduledRide, PaymentMethod, RideStatus, RidePreferences, PromoCode, PreferredRoute } from '../../types';\r\nimport { useRide } from '../../hooks/useRide';\r\nimport { useAuth } from '../../context/AuthContext';\r\nimport { CONFIG, db } from '../../firebase';\r\nimport { collection, query, where, getDocs, limit } from 'firebase/firestore';\r\nimport MapContainer from '../../components/MapContainer';\r\nimport { Coordinates } from '../../types';\r\n\r\ninterface Driver {\r\n    id: string;\r\n    name: string;\r\n    avatar: string;\r\n    carModel: string;\r\n    carNumber: string;\r\n    rating: number;\r\n    price: number;\r\n    eta: string;\r\n    conditions: string[];\r\n    currentLocation?: Coordinates;\r\n    preferredRoutes?: PreferredRoute[];\r\n    bio?: string;\r\n    languages?: string[];\r\n}\r\n\r\ninterface Props {\r\n    onSchedule: (ride: ScheduledRide) => void;\r\n}\r\n\r\ninterface ForensicsData {\r\n    distance: string;\r\n    time: string;\r\n    summary: string;\r\n    sources: any[];\r\n}\r\n\r\nconst FlexFare: React.FC<Props> = ({ onSchedule }) => {\r\n    const { state } = useLocation();\r\n    const navigate = useNavigate();\r\n    const { getAvailableDrivers, getFareEstimate, requestRide, activeRide, scheduleRide } = useRide();\r\n    const { user } = useAuth();\r\n\r\n    const rideType: RideType = state?.rideType || 'RESERVED';\r\n    const category: VehicleCategory = state?.category || 'MINI';\r\n    const pickup = state?.pickup || 'Current Location';\r\n    const destination = state?.destination || 'Destination';\r\n    const pickupCoords = state?.pickupCoords;\r\n    const dropCoords = state?.dropCoords;\r\n    const scheduledTimestamp = state?.scheduledTimestamp;\r\n    const preferences: RidePreferences = state?.preferences || { silent: false, ac: false, music: false };\r\n\r\n    // AI & Flow Control State\r\n    const [forensics, setForensics] = useState<ForensicsData | null>(state?.forensics || null);\r\n    const [isFetchingForensics, setIsFetchingForensics] = useState(!state?.forensics);\r\n    const [error, setError] = useState<string | null>(null);\r\n    const [step, setStep] = useState<'BIDDING' | 'DRIVERS' | 'PAYMENT' | 'WAITING'>('BIDDING');\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [showBreakdown, setShowBreakdown] = useState(false);\r\n    const [passengerCount, setPassengerCount] = useState(state?.passengerCount || 1);\r\n\r\n    // Selections\r\n    const [availableDrivers, setAvailableDrivers] = useState<Driver[]>([]);\r\n    const [selectedDriver, setSelectedDriver] = useState<Driver | null>(null);\r\n    const [viewingProfile, setViewingProfile] = useState<Driver | null>(null);\r\n    const [paymentMethod, setPaymentMethod] = useState<PaymentMethod>('UPI');\r\n\r\n    const [bid, setBid] = useState(state?.initialFare || 250);\r\n    const [initialFare, setInitialFare] = useState(state?.initialFare || 250);\r\n\r\n    // Promo & Wallet\r\n    const [promoCode, setPromoCode] = useState('');\r\n    const [appliedPromo, setAppliedPromo] = useState<PromoCode | null>(null);\r\n    const [promoError, setPromoError] = useState('');\r\n    const [discountAmount, setDiscountAmount] = useState(0);\r\n\r\n    const checkPromo = async () => {\r\n        if (!promoCode) return;\r\n        setPromoError('');\r\n        try {\r\n            const q = query(\r\n                collection(db, 'promoCodes'),\r\n                where('code', '==', promoCode.toUpperCase()),\r\n                where('isActive', '==', true),\r\n                limit(1)\r\n            );\r\n            const snapshot = await getDocs(q);\r\n            if (snapshot.empty) {\r\n                setPromoError('Invalid promo code');\r\n                setAppliedPromo(null);\r\n                setDiscountAmount(0);\r\n                return;\r\n            }\r\n            const promo = snapshot.docs[0].data() as PromoCode;\r\n            if (promo.expiry < Date.now()) {\r\n                setPromoError('Promo code expired');\r\n                return;\r\n            }\r\n            // Calculate Discount\r\n            let discount = 0;\r\n            const baseFare = selectedDriver?.price || bid;\r\n            if (promo.discountType === 'PERCENTAGE') {\r\n                discount = (baseFare * promo.value) / 100;\r\n                if (promo.maxDiscount) discount = Math.min(discount, promo.maxDiscount);\r\n            } else {\r\n                discount = promo.value;\r\n            }\r\n            setAppliedPromo(promo);\r\n            setDiscountAmount(Math.round(discount));\r\n        } catch (err) {\r\n            console.error(err);\r\n            setPromoError('Failed to apply promo');\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        if (activeRide) {\r\n            if (activeRide.status === RideStatus.SEARCHING) {\r\n                setStep('WAITING');\r\n            } else if (activeRide.status === RideStatus.ACCEPTED || activeRide.status === RideStatus.STARTED) {\r\n                navigate('/user/live-tracking');\r\n            }\r\n        }\r\n    }, [activeRide, navigate]);\r\n\r\n    useEffect(() => {\r\n        // If we already have data from previous screen, sync it\r\n        if (state?.initialFare) {\r\n            setInitialFare(state.initialFare);\r\n            setBid(state.initialFare);\r\n            if (state.forensics) setForensics(state.forensics);\r\n            setIsFetchingForensics(false);\r\n            return;\r\n        }\r\n\r\n        const fetchRouteData = async () => {\r\n            // ... existing fetch logic ...\r\n            setIsFetchingForensics(true);\r\n            setError(null);\r\n\r\n            try {\r\n                if (pickupCoords && dropCoords) {\r\n                    const estimates = await getFareEstimate(pickupCoords, dropCoords);\r\n                    const specific = estimates.find(e => e.category === category);\r\n\r\n                    if (specific) {\r\n                        const calculated = Math.round(rideType === 'SHARED' ? specific.amount * 0.7 : specific.amount);\r\n                        setInitialFare(calculated);\r\n                        setBid(calculated);\r\n                        setForensics({\r\n                            distance: 'Calculated',\r\n                            time: `${specific.eta} mins`,\r\n                            summary: 'Optimized route based on live traffic.',\r\n                            sources: []\r\n                        });\r\n                    } else {\r\n                        // Fallback if specific category not found in estimates\r\n                        const fallbackFare = 250;\r\n                        setInitialFare(fallbackFare);\r\n                        setBid(fallbackFare);\r\n                    }\r\n                } else {\r\n                    const fallbackFare = 250;\r\n                    setInitialFare(fallbackFare);\r\n                    setBid(fallbackFare);\r\n                    setForensics({\r\n                        distance: '---',\r\n                        time: '---',\r\n                        summary: 'Coordinates missing for precise forensics.',\r\n                        sources: []\r\n                    });\r\n                }\r\n            } catch (err) {\r\n                console.error(\"Route Error:\", err);\r\n                // Fallback on error\r\n                const fallbackFare = 250;\r\n                setInitialFare(fallbackFare);\r\n                setBid(fallbackFare);\r\n                setError(\"Could not calculate exact fare. Using standard rates.\");\r\n            } finally {\r\n                setIsFetchingForensics(false);\r\n            }\r\n        };\r\n        fetchRouteData();\r\n    }, [pickupCoords, dropCoords, category, rideType, getFareEstimate, state]);\r\n\r\n    const mapSrc = `https://maps.google.com/maps?width=100%25&height=600&hl=en&saddr=${encodeURIComponent(pickup)}&daddr=${encodeURIComponent(destination)}&t=k&z=15&ie=UTF8&iwloc=B&output=embed`;\r\n\r\n    const findDrivers = async () => {\r\n        setIsLoading(true);\r\n        try {\r\n            const drivers = await getAvailableDrivers(category, user?.gender);\r\n            // Enrich with Mock Coordinates if real ones missing (for Demo visualization)\r\n            const driversWithPrice = drivers.map((d: any, i) => {\r\n                // Generate a random position near pickup\r\n                const offsetLat = (Math.random() - 0.5) * 0.01;\r\n                const offsetLng = (Math.random() - 0.5) * 0.01;\r\n\r\n                // Calculate mock ETA based on distance (approx 3 min per 0.01 degree ~ 1km)\r\n                const distEstimate = Math.sqrt(offsetLat * offsetLat + offsetLng * offsetLng) * 111; // Approx km\r\n                const etaMinutes = Math.max(2, Math.round(distEstimate * 3));\r\n\r\n                // Route-based pricing logic\r\n                const matchingRoute = (d.preferredRoutes || []).find((r: any) =>\r\n                    destination.toLowerCase().includes(r.destination.toLowerCase())\r\n                );\r\n\r\n                return {\r\n                    ...d,\r\n                    price: matchingRoute ? matchingRoute.price : bid,\r\n                    eta: `${etaMinutes} mins`,\r\n                    currentLocation: d.currentLocation || (pickupCoords ? {\r\n                        lat: pickupCoords.lat + offsetLat,\r\n                        lng: pickupCoords.lng + offsetLng\r\n                    } : undefined)\r\n                };\r\n            });\r\n            setAvailableDrivers(driversWithPrice);\r\n            setStep('DRIVERS');\r\n        } catch (err) {\r\n            setError(\"Error finding nearby drivers.\");\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    const handlePayment = async () => {\r\n        return new Promise((resolve, reject) => {\r\n            if (!(window as any).Razorpay) {\r\n                reject(new Error(\"Razorpay SDK not loaded\"));\r\n                return;\r\n            }\r\n            const options = {\r\n                key: CONFIG.RAZORPAY_KEY_ID,\r\n                amount: (selectedDriver?.price || bid) * 100,\r\n                currency: \"INR\",\r\n                name: \"Gaadiwala\",\r\n                description: `Ride to ${destination}`,\r\n                handler: (response: any) => resolve(response),\r\n                modal: { ondismiss: () => reject(new Error(\"Payment cancelled\")) },\r\n                prefill: {\r\n                    name: user?.name,\r\n                    email: user?.email,\r\n                    contact: user?.phone\r\n                },\r\n                theme: { color: \"#0F172A\" }\r\n            };\r\n            const rzp = new (window as any).Razorpay(options);\r\n            rzp.open();\r\n        });\r\n    };\r\n\r\n    const handleBook = async () => {\r\n        const finalFare = (selectedDriver?.price || bid) - discountAmount;\r\n\r\n        // Wallet Balance Check\r\n        if (paymentMethod === 'WALLET') {\r\n            if ((user?.walletBalance || 0) < finalFare) {\r\n                alert(`Insufficient Wallet Balance (${user?.walletBalance}). Please Top-up.`);\r\n                navigate('/user/wallet');\r\n                return;\r\n            }\r\n        }\r\n\r\n        if (scheduledTimestamp) {\r\n            scheduleRide({\r\n                id: Math.random().toString(36).substr(2, 9),\r\n                pickup, destination, timestamp: scheduledTimestamp, rideType, category,\r\n                fare: finalFare, driverId: selectedDriver?.id, paymentMethod\r\n            });\r\n            alert(`Ride Scheduled for ${new Date(scheduledTimestamp).toLocaleString()}!`);\r\n            navigate('/user/home');\r\n        } else {\r\n            if (!pickupCoords || !dropCoords) {\r\n                setError(\"Pickup or destination location not selected properly. Please go back and select locations from the search suggestions.\");\r\n                return;\r\n            }\r\n\r\n            setIsLoading(true);\r\n            try {\r\n                // Only process payment for non-cash methods\r\n                if (paymentMethod === 'UPI' || paymentMethod === 'CARD') {\r\n                    await handlePayment();\r\n                }\r\n\r\n                await requestRide(\r\n                    pickupCoords,\r\n                    dropCoords,\r\n                    pickup,\r\n                    destination,\r\n                    category,\r\n                    finalFare,\r\n                    selectedDriver?.id,\r\n                    paymentMethod,\r\n                    preferences\r\n                );\r\n            } catch (err) {\r\n                console.error('Booking error:', err);\r\n                setError(\"Failed to request ride. Please try again.\");\r\n            } finally {\r\n                setIsLoading(false);\r\n            }\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"bg-[#f4f7f9] text-slate-900 font-sans h-screen flex flex-col overflow-hidden relative\">\r\n            <header className=\"h-14 lg:h-20 bg-[#1e293b] border-b border-white/5 px-4 lg:px-8 flex items-center justify-between z-50 shadow-md shrink-0\">\r\n                {/* Global Error Banner */}\r\n                {error && (\r\n                    <div className=\"absolute top-[100%] left-0 right-0 bg-red-500 text-white px-6 py-2 z-[100] flex justify-between items-center animate-in slide-in-from-top duration-300\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <span className=\"material-symbols-outlined text-sm\">error</span>\r\n                            <p className=\"text-[10px] lg:text-xs font-bold uppercase tracking-widest\">{error}</p>\r\n                        </div>\r\n                        <button onClick={() => setError(null)} className=\"p-1 hover:bg-white/10 rounded-full transition-colors\">\r\n                            <span className=\"material-symbols-outlined text-sm\">close</span>\r\n                        </button>\r\n                    </div>\r\n                )}\r\n                <div className=\"flex items-center gap-2 lg:gap-4\">\r\n                    <button onClick={() => navigate(-1)} className=\"size-8 lg:size-10 bg-white/5 rounded-full flex items-center justify-center text-white hover:bg-white/10 transition-all mr-2\">\r\n                        <span className=\"material-symbols-outlined text-sm lg:text-base\">arrow_back</span>\r\n                    </button>\r\n                    <div className=\"size-8 lg:size-10 bg-[#22c55e] rounded-lg lg:rounded-xl flex items-center justify-center text-black shadow-sm\">\r\n                        <span className=\"material-symbols-outlined font-bold text-xs lg:text-base\">rocket_launch</span>\r\n                    </div>\r\n                    <div>\r\n                        <h2 className=\"text-sm lg:text-xl font-black tracking-tight uppercase text-white leading-none\">Gaadiwala</h2>\r\n                        <p className=\"text-[6px] lg:text-[8px] font-bold uppercase tracking-widest text-[#22c55e] mt-0.5\">Live Booking</p>\r\n                    </div>\r\n                </div>\r\n                <button onClick={() => navigate(-1)} className=\"text-[10px] lg:text-xs font-bold uppercase tracking-widest text-slate-400 hover:text-white transition-all\">Cancel</button>\r\n            </header>\r\n\r\n            <main className=\"flex flex-1 flex-col lg:flex-row overflow-hidden relative h-full\">\r\n                {/* 50% Map on Mobile */}\r\n                <div className=\"h-[40dvh] lg:h-full lg:flex-1 relative overflow-hidden order-1 lg:order-2 border-b lg:border-none border-white/10\">\r\n                    <MapContainer\r\n                        pickup={pickupCoords}\r\n                        drop={dropCoords}\r\n                        drivers={availableDrivers.map(d => d.currentLocation).filter((l): l is Coordinates => !!l)}\r\n                    />\r\n\r\n                    {/* Desktop Trip Details Overlay */}\r\n                    <div className=\"absolute bottom-10 left-10 p-6 rounded-3xl bg-white shadow-xl border border-slate-100 w-80 hidden lg:block z-50\">\r\n                        <h4 className=\"text-[10px] font-bold uppercase tracking-wider text-slate-400 mb-4\">Trip Summary</h4>\r\n                        {isFetchingForensics ? (\r\n                            <div className=\"text-center space-y-2 py-6\">\r\n                                <div className=\"size-6 border-2 border-slate-200 border-t-orange-500 rounded-full animate-spin mx-auto\"></div>\r\n                                <p className=\"text-xs font-medium text-slate-500\">Loading details...</p>\r\n                            </div>\r\n                        ) : (\r\n                            <div className=\"space-y-4\">\r\n                                <div className=\"flex gap-4\"><span className=\"material-symbols-outlined text-[#22c55e] text-sm\">radio_button_checked</span><p className=\"text-xs font-medium truncate\">{pickup}</p></div>\r\n                                <div className=\"flex gap-4\"><span className=\"material-symbols-outlined text-orange-500 text-sm\">location_on</span><p className=\"text-xs font-medium truncate\">{destination}</p></div>\r\n                                <div className=\"pt-4 border-t flex justify-between\">\r\n                                    <div><p className=\"text-[9px] font-bold uppercase text-slate-400\">Distance</p><p className=\"text-sm font-bold\">{forensics?.distance || '...'}</p></div>\r\n                                    <div><p className=\"text-[9px] font-bold uppercase text-slate-400\">Time</p><p className=\"text-sm font-bold text-slate-700\">{forensics?.time || '...'}</p></div>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n\r\n                <aside className=\"w-full lg:w-[480px] bg-[#1e293b] h-[60dvh] lg:h-full flex flex-col p-4 lg:p-8 overflow-y-auto relative scrollbar-hide order-2 lg:order-1 shadow-2xl border-r border-white/5\">\r\n                    {/* Mobile Trip Details - persistent and compact */}\r\n                    {!isFetchingForensics && forensics && (\r\n                        <div className=\"lg:hidden mb-4 p-3 bg-white/5 rounded-xl border border-white/10 shadow-sm relative overflow-hidden shrink-0\">\r\n                            <div className=\"relative flex justify-between items-center px-1\">\r\n                                <div>\r\n                                    <p className=\"text-slate-400 text-[9px] font-bold uppercase tracking-wide mb-0.5\">Distance</p>\r\n                                    <p className=\"text-white text-xs font-bold\">{forensics.distance}</p>\r\n                                </div>\r\n                                <div className=\"text-right\">\r\n                                    <p className=\"text-slate-400 text-[9px] font-bold uppercase tracking-wide mb-0.5\">Est. Time</p>\r\n                                    <p className=\"text-[#22c55e] text-xs font-bold\">{forensics.time}</p>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                    {step === 'BIDDING' && (\r\n                        <div className=\"animate-in slide-in-from-right duration-500 flex flex-col h-full\">\r\n                            <div className=\"bg-white/5 p-4 rounded-2xl mb-4 border border-white/5\">\r\n                                <div className=\"flex justify-between items-center\">\r\n                                    <div className=\"flex items-center gap-2\">\r\n                                        <span className=\"material-symbols-outlined text-slate-400\">group</span>\r\n                                        <span className=\"text-[10px] font-bold uppercase text-slate-400\">Passengers</span>\r\n                                    </div>\r\n                                    <div className=\"flex items-center gap-3\">\r\n                                        <button\r\n                                            onClick={() => {\r\n                                                if (passengerCount > 1) {\r\n                                                    const perPerson = initialFare / passengerCount;\r\n                                                    setInitialFare(perPerson * (passengerCount - 1));\r\n                                                    setBid((prev: number) => Math.round((prev / passengerCount) * (passengerCount - 1)));\r\n                                                    setPassengerCount((prev: number) => prev - 1);\r\n                                                }\r\n                                            }}\r\n                                            disabled={passengerCount <= 1}\r\n                                            className={`size-8 rounded-full flex items-center justify-center border transition-all ${passengerCount <= 1 ? 'border-white/5 text-slate-600' : 'border-white/20 text-white hover:bg-white/10'}`}\r\n                                        >\r\n                                            <span className=\"material-symbols-outlined text-sm\">remove</span>\r\n                                        </button>\r\n                                        <span className=\"text-white font-bold\">{passengerCount}</span>\r\n                                        <button\r\n                                            onClick={() => {\r\n                                                const limits: Record<string, number> = {\r\n                                                    [VehicleCategory.BIKE]: 1,\r\n                                                    [VehicleCategory.AUTO]: 3,\r\n                                                    [VehicleCategory.MINI]: 4,\r\n                                                    [VehicleCategory.PRIME]: 4,\r\n                                                    [VehicleCategory.PINK]: 4\r\n                                                };\r\n                                                const max = limits[category] || 4;\r\n                                                if (passengerCount < max) {\r\n                                                    const perPerson = initialFare / passengerCount;\r\n                                                    setInitialFare(perPerson * (passengerCount + 1));\r\n                                                    setBid((prev: number) => Math.round((prev / passengerCount) * (passengerCount + 1)));\r\n                                                    setPassengerCount((prev: number) => prev + 1);\r\n                                                }\r\n                                            }}\r\n                                            disabled={(() => {\r\n                                                const limits: Record<string, number> = {\r\n                                                    [VehicleCategory.BIKE]: 1,\r\n                                                    [VehicleCategory.AUTO]: 3,\r\n                                                    [VehicleCategory.MINI]: 4,\r\n                                                    [VehicleCategory.PRIME]: 4,\r\n                                                    [VehicleCategory.PINK]: 4\r\n                                                };\r\n                                                return passengerCount >= (limits[category] || 4);\r\n                                            })()}\r\n                                            className=\"size-8 rounded-full flex items-center justify-center border border-white/20 text-white hover:bg-white/10 transition-all disabled:opacity-50\"\r\n                                        >\r\n                                            <span className=\"material-symbols-outlined text-sm\">add</span>\r\n                                        </button>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <h3 className=\"text-sm lg:text-xl font-black tracking-tight mb-4 lg:mb-8 shrink-0 text-white uppercase italic\">Offer Your Fare</h3>\r\n\r\n                            <div className=\"bg-white/5 p-4 lg:p-8 rounded-2xl lg:rounded-[2rem] border border-white/5 relative shadow-sm mb-4 lg:mb-8 shrink-0 overflow-hidden\">\r\n                                <div className=\"absolute inset-x-0 top-0 h-1 bg-gradient-to-r from-transparent via-[#22c55e]/30 to-transparent\"></div>\r\n\r\n                                <div className=\"flex flex-col items-center mb-6 lg:mb-8\">\r\n                                    <div className=\"flex items-center gap-2 mb-2\">\r\n                                        <p className=\"text-[10px] lg:text-[12px] font-black uppercase text-slate-500 tracking-widest italic\">Your Offer</p>\r\n                                        <button onClick={() => setShowBreakdown(true)} className=\"size-4 lg:size-5 rounded-full border border-white/20 flex items-center justify-center text-slate-400 hover:text-white hover:border-white/40 transition-all\">\r\n                                            <span className=\"material-symbols-outlined text-[10px] lg:text-[12px]\">info</span>\r\n                                        </button>\r\n                                    </div>\r\n                                    <div className=\"flex items-center gap-1 scale-110 lg:scale-125\">\r\n                                        <span className=\"text-xl lg:text-4xl font-black text-[#22c55e]\"></span>\r\n                                        <input\r\n                                            type=\"number\"\r\n                                            value={bid}\r\n                                            onChange={(e) => setBid(Number(e.target.value))}\r\n                                            className=\"bg-transparent text-2xl lg:text-5xl font-black text-white w-32 lg:w-48 focus:outline-none text-center tabular-nums\"\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Premium Scrollable Fare Selection */}\r\n                                <div className=\"relative mb-6\">\r\n                                    <p className=\"text-[8px] font-black text-slate-500 uppercase tracking-widest mb-4 text-center\">Slide to adjust bid</p>\r\n                                    <div className=\"flex gap-2 overflow-x-auto pb-4 scrollbar-hide snap-x px-4\">\r\n                                        {(() => {\r\n                                            const steps = [];\r\n                                            const base = initialFare || 250;\r\n                                            // Generate values from -40% to +40% in 5% increments\r\n                                            for (let i = -8; i <= 8; i++) {\r\n                                                steps.push(Math.round(base * (1 + (i * 0.05))));\r\n                                            }\r\n                                            return steps.map((val) => (\r\n                                                <button\r\n                                                    key={val}\r\n                                                    onClick={() => setBid(val)}\r\n                                                    className={`snap-center shrink-0 min-w-[80px] py-4 rounded-xl border transition-all flex flex-col items-center gap-1 ${bid === val\r\n                                                        ? 'bg-[#22c55e] border-[#22c55e] text-black shadow-lg shadow-[#22c55e]/20 scale-110'\r\n                                                        : 'bg-white/5 border-white/10 text-slate-400 hover:border-white/20'\r\n                                                        }`}\r\n                                                >\r\n                                                    <span className=\"text-[12px] font-black\">{val}</span>\r\n                                                    <span className=\"text-[8px] font-bold opacity-50 uppercase\">\r\n                                                        {val === base ? 'STD' : val > base ? `+${Math.round((val / base - 1) * 100)}%` : `-${Math.round((1 - val / base) * 100)}%`}\r\n                                                    </span>\r\n                                                </button>\r\n                                            ));\r\n                                        })()}\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div className=\"flex justify-center gap-6 text-[9px] font-black uppercase tracking-widest mt-2 border-t border-white/5 pt-6\">\r\n                                    <button onClick={() => setBid(Math.round(initialFare * 0.85))} className=\"text-slate-500 hover:text-white transition-colors\">Min</button>\r\n                                    <button onClick={() => setBid(initialFare)} className=\"text-[#22c55e] px-6 py-1.5 bg-[#22c55e]/10 rounded-full border border-[#22c55e]/30 hover:bg-[#22c55e]/20 transition-all\">Standard</button>\r\n                                    <button onClick={() => setBid(Math.round(initialFare * 1.3))} className=\"text-slate-500 hover:text-white transition-colors\">Max</button>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Preferences - More compact for mobile */}\r\n                            <div className=\"bg-white/5 p-4 lg:p-6 rounded-2xl lg:rounded-3xl border border-white/5 mb-6 lg:mb-8 shrink-0 backdrop-blur-sm\">\r\n                                <p className=\"text-[7px] lg:text-[10px] font-black uppercase text-slate-500 mb-3 lg:mb-4 tracking-widest\">Active Preferences</p>\r\n                                <div className=\"flex gap-4\">\r\n                                    <div className={`flex items-center gap-2 text-[10px] lg:text-xs font-bold ${preferences.silent ? 'text-[#22c55e]' : 'text-slate-500'}`}>\r\n                                        <span className=\"material-symbols-outlined text-xs lg:text-sm\">volume_off</span> Silent\r\n                                    </div>\r\n                                    <div className={`flex items-center gap-2 text-[10px] lg:text-xs font-bold ${preferences.ac ? 'text-[#22c55e]' : 'text-slate-500'}`}>\r\n                                        <span className=\"material-symbols-outlined text-xs lg:text-sm\">ac_unit</span> AC\r\n                                    </div>\r\n                                    <div className={`flex items-center gap-2 text-[10px] lg:text-xs font-bold ${preferences.music ? 'text-[#22c55e]' : 'text-slate-500'}`}>\r\n                                        <span className=\"material-symbols-outlined text-xs lg:text-sm\">music_note</span> Music\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <button onClick={findDrivers} disabled={isLoading || isFetchingForensics} className=\"w-full h-12 lg:h-16 bg-slate-900 text-white rounded-xl lg:rounded-[2rem] font-black text-[10px] lg:text-xs uppercase tracking-widest shadow-2xl hover:scale-[1.02] active:scale-[0.98] transition-all flex items-center justify-center gap-3 lg:gap-4 mt-auto disabled:bg-slate-300 shrink-0\">\r\n                                {isLoading ? (<>Searching Partners <span className=\"animate-spin material-symbols-outlined text-sm\">sync</span></>) : (<>Find Partners <span className=\"material-symbols-outlined text-sm\">person_search</span></>)}\r\n                            </button>\r\n                        </div>\r\n                    )}\r\n\r\n                    {step === 'DRIVERS' && (\r\n                        <div className=\"animate-in slide-in-from-right duration-500 flex flex-col h-full\">\r\n                            <div className=\"flex items-center justify-between mb-4 lg:mb-8 shrink-0\">\r\n                                <button onClick={() => { setStep('BIDDING'); setError(null); }} className=\"size-8 lg:size-10 rounded-full bg-white/10 flex items-center justify-center hover:bg-white/20 text-white border border-white/5\">\r\n                                    <span className=\"material-symbols-outlined text-xs lg:text-sm\">arrow_back</span>\r\n                                </button>\r\n                                <h3 className=\"text-xl lg:text-2xl font-black tracking-tight text-white\">Available Drivers</h3>\r\n                            </div>\r\n                            <div className=\"flex-1 space-y-3 lg:space-y-4 overflow-y-auto pr-2 scrollbar-hide\">\r\n                                {availableDrivers.length > 0 ? availableDrivers.map(driver => (\r\n                                    <div key={driver.id} className=\"bg-white/5 border border-white/10 rounded-2xl lg:rounded-3xl p-3 lg:p-5 shadow-sm hover:shadow-[0_0_20px_rgba(34,197,94,0.1)] hover:border-[#22c55e]/30 transition-all relative group backdrop-blur-md\">\r\n                                        <div className=\"flex gap-3 lg:gap-4\">\r\n                                            <img src={driver.avatar || `https://api.dicebear.com/7.x/avataaars/svg?seed=${driver.id}`} className=\"size-12 lg:size-16 rounded-xl lg:rounded-2xl object-cover bg-slate-800 border border-white/10\" alt=\"avatar\" />\r\n                                            <div className=\"flex-1 min-w-0\">\r\n                                                <div className=\"flex justify-between items-start\">\r\n                                                    <div className=\"min-w-0\">\r\n                                                        <h4 className=\"font-black text-xs lg:text-lg truncate tracking-tight uppercase italic text-white\">{driver.name}</h4>\r\n                                                        <div className=\"flex items-center gap-1 text-[8px] lg:text-[10px] text-slate-400 font-bold uppercase truncate\">\r\n                                                            <span>{driver.carModel}</span>  <span className=\"text-[#22c55e]\">{driver.rating} </span>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div className=\"text-right\">\r\n                                                        <p className=\"text-sm lg:text-xl font-black text-white italic leading-none\">{driver.price}</p>\r\n                                                        <p className=\"text-[7px] lg:text-[9px] text-slate-500 font-black uppercase tracking-tighter mt-1 italic\">{driver.eta}</p>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div className=\"mt-3 flex gap-2\">\r\n                                            <button onClick={() => setViewingProfile(driver)} className=\"flex-1 py-2 rounded-lg bg-white/5 text-slate-400 text-[8px] lg:text-[10px] font-black uppercase tracking-widest hover:bg-white/10 hover:text-white transition-all border border-white/5\">Profile</button>\r\n                                            <button onClick={() => { setSelectedDriver(driver); setStep('PAYMENT'); }} className=\"flex-2 py-2 rounded-lg bg-[#22c55e] text-black text-[8px] lg:text-[10px] font-black uppercase tracking-widest hover:shadow-[0_0_15px_rgba(34,197,94,0.4)] transition-all italic px-4 shadow-[0_0_10px_rgba(34,197,94,0.2)]\">Select Partner</button>\r\n                                        </div>\r\n                                    </div>\r\n                                )) : (\r\n                                    <div className=\"text-center py-10 lg:py-20 bg-white/5 rounded-2xl lg:rounded-3xl border border-dashed border-white/10\">\r\n                                        <span className=\"material-symbols-outlined text-3xl lg:text-4xl text-slate-600 mb-2\">person_off</span>\r\n                                        <p className=\"text-[10px] lg:text-xs text-slate-500 font-bold uppercase tracking-widest\">No partners online</p>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {\r\n                        step === 'PAYMENT' && selectedDriver && (\r\n                            <div className=\"animate-in slide-in-from-right duration-500 flex flex-col h-full\">\r\n                                <div className=\"flex items-center gap-2 mb-6\"><button onClick={() => { setStep('DRIVERS'); setError(null); }} className=\"size-8 rounded-full bg-white/10 flex items-center justify-center hover:bg-white/20 text-white\"><span className=\"material-symbols-outlined text-sm\">arrow_back</span></button><h3 className=\"text-xl font-black tracking-tight text-white\">Confirm & Pay</h3></div>\r\n                                <div className=\"bg-[#0A0E12] text-white p-4 lg:p-8 rounded-2xl lg:rounded-[3.5rem] mb-4 lg:mb-8 relative overflow-hidden group shadow-xl border border-white/5 shrink-0\">\r\n                                    <div className=\"absolute inset-0 bg-gradient-to-br from-[#22c55e]/10 to-transparent\"></div>\r\n                                    <div className=\"relative flex items-center gap-4 lg:gap-6\">\r\n                                        <div className=\"relative\">\r\n                                            <img src={selectedDriver.avatar || `https://api.dicebear.com/7.x/avataaars/svg?seed=${selectedDriver.id}`} className=\"size-12 lg:size-20 rounded-xl lg:rounded-[1.5rem] bg-white/10 object-cover border-2 border-white/10\" alt=\"avatar\" />\r\n                                            <div className=\"absolute -bottom-1 -right-1 bg-[#22c55e] text-black size-4 lg:size-6 rounded flex items-center justify-center border-2 border-[#0A0E12]\">\r\n                                                <span className=\"material-symbols-outlined text-[8px] lg:text-[12px] font-black\">verified</span>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div className=\"flex-1 min-w-0\">\r\n                                            <p className=\"text-[6px] lg:text-[10px] font-black uppercase text-[#22c55e] tracking-[0.2em] mb-0.5 italic\">Partner Selected</p>\r\n                                            <p className=\"font-black text-xs lg:text-2xl truncate uppercase italic leading-tight\">{selectedDriver.name}</p>\r\n                                        </div>\r\n                                        <div className=\"text-right\">\r\n                                            <p className=\"text-[6px] lg:text-[10px] font-black uppercase text-white/40 mb-0.5\">Fare</p>\r\n                                            <p className=\"font-black text-base lg:text-4xl text-[#22c55e] italic leading-none\">{selectedDriver.price}</p>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div className=\"space-y-3 lg:space-y-4 flex-1\">\r\n                                    {/* Payment Selector */}\r\n                                    <div className=\"flex gap-2 bg-white/5 p-1 rounded-xl shrink-0\">\r\n                                        {(['UPI', 'CASH', 'WALLET'] as PaymentMethod[]).map(method => (\r\n                                            <button\r\n                                                key={method}\r\n                                                onClick={() => setPaymentMethod(method)}\r\n                                                className={`flex-1 py-2 lg:py-3 rounded-lg text-[9px] lg:text-xs font-black transition-all uppercase ${paymentMethod === method\r\n                                                    ? 'bg-[#22c55e] text-black shadow-lg shadow-[#22c55e]/20'\r\n                                                    : 'text-slate-400 hover:text-white'\r\n                                                    }`}\r\n                                            >\r\n                                                {method}\r\n                                            </button>\r\n                                        ))}\r\n                                    </div>\r\n\r\n                                    {/* Promo Input */}\r\n                                    <div className=\"flex gap-2 shrink-0\">\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            value={promoCode}\r\n                                            onChange={(e) => setPromoCode(e.target.value.toUpperCase())}\r\n                                            placeholder=\"PROMO CODE\"\r\n                                            className=\"flex-1 bg-white/5 border border-white/10 focus:border-[#22c55e] rounded-xl px-4 py-2 text-[10px] font-black outline-none transition-all uppercase text-white placeholder:text-slate-600\"\r\n                                        />\r\n                                        <button\r\n                                            onClick={checkPromo}\r\n                                            disabled={!promoCode || !!appliedPromo}\r\n                                            className=\"bg-[#22c55e] text-black px-4 rounded-xl font-black text-[9px] disabled:opacity-30 uppercase italic\"\r\n                                        >\r\n                                            Apply\r\n                                        </button>\r\n                                    </div>\r\n\r\n                                    {/* Fare Summary */}\r\n                                    <div className=\"bg-white/5 p-3 lg:p-4 rounded-xl space-y-1 lg:space-y-2 shrink-0\">\r\n                                        <div className=\"flex justify-between text-slate-400 text-[9px] lg:text-xs font-bold uppercase tracking-tighter\">\r\n                                            <span>Base Fare</span>\r\n                                            <span>{selectedDriver?.price || bid}</span>\r\n                                        </div>\r\n                                        {discountAmount > 0 && (\r\n                                            <div className=\"flex justify-between text-[#22c55e] font-black text-[9px] lg:text-xs uppercase\">\r\n                                                <span>Promo Discount</span>\r\n                                                <span>-{discountAmount}</span>\r\n                                            </div>\r\n                                        )}\r\n                                        <div className=\"flex justify-between font-black text-sm lg:text-lg border-t border-white/10 pt-2 lg:mt-2 italic text-white\">\r\n                                            <span>Total Payable</span>\r\n                                            <span>{(selectedDriver?.price || bid) - discountAmount}</span>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <button onClick={handleBook} className=\"w-full h-12 lg:h-16 bg-[#22c55e] text-black rounded-xl lg:rounded-[2rem] font-black text-[10px] lg:text-xs uppercase tracking-widest shadow-[0_0_30px_rgba(34,197,94,0.3)] hover:scale-[1.02] active:scale-[0.98] transition-all flex items-center justify-center gap-3 lg:gap-4 mt-auto\">\r\n                                        {isLoading ? (\r\n                                            <>Authorising... <span className=\"material-symbols-outlined animate-spin text-sm\">sync</span></>\r\n                                        ) : (\r\n                                            <>Pay {(selectedDriver?.price || bid) - discountAmount} <span className=\"material-symbols-outlined text-sm\">arrow_forward</span></>\r\n                                        )}\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        )\r\n                    }\r\n                    {\r\n                        step === 'WAITING' && (\r\n                            <div className=\"animate-in fade-in zoom-in duration-500 flex flex-col items-center justify-center h-full text-center space-y-8\">\r\n                                <div className=\"relative\">\r\n                                    <div className=\"size-32 bg-orange-500/10 rounded-full animate-ping absolute inset-0\"></div>\r\n                                    <div className=\"size-32 bg-orange-500 rounded-full flex items-center justify-center text-white relative shadow-2xl\">\r\n                                        <span className=\"material-symbols-outlined text-5xl animate-spin\">sync</span>\r\n                                    </div>\r\n                                </div>\r\n                                <div>\r\n                                    <h3 className=\"text-2xl font-black tracking-tight\">Searching for Partner</h3>\r\n                                    <p className=\"text-slate-400 text-sm font-medium mt-2\">Pinging nearby {category} partners with your bid of {selectedDriver?.price || bid}</p>\r\n                                </div>\r\n                                <div className=\"w-full bg-slate-50 p-6 rounded-3xl space-y-3\">\r\n                                    <div className=\"flex justify-between text-xs\"><span className=\"text-slate-500 font-bold uppercase\">Pickup</span><span className=\"font-black truncate w-40 text-right\">{pickup}</span></div>\r\n                                    <div className=\"flex justify-between text-xs\"><span className=\"text-slate-500 font-bold uppercase\">Destination</span><span className=\"font-black truncate w-40 text-right\">{destination}</span></div>\r\n                                </div>\r\n                                <button onClick={() => { /* activeRide && cancelRide(activeRide.id); */ setStep('BIDDING'); }} className=\"text-red-500 font-black text-xs uppercase tracking-widest hover:bg-red-50 px-6 py-3 rounded-xl transition-all\">Cancel Request</button>\r\n                            </div>\r\n                        )\r\n                    }\r\n                </aside >\r\n            </main >\r\n\r\n            {\r\n                viewingProfile && (\r\n                    <div className=\"fixed inset-0 z-[60] bg-black/80 backdrop-blur-sm flex items-center justify-center p-6\" onClick={() => setViewingProfile(null)}>\r\n                        <div className=\"bg-white w-full max-w-sm rounded-[3rem] overflow-hidden animate-in zoom-in-95\" onClick={e => e.stopPropagation()}>\r\n                            <div className={`h-32 ${category === VehicleCategory.PINK ? 'bg-pink-600' : 'bg-slate-900'} relative`}>\r\n                                <button onClick={() => setViewingProfile(null)} className=\"absolute top-4 right-4 size-8 bg-white/10 rounded-full flex items-center justify-center text-white hover:bg-white/20\">\r\n                                    <span className=\"material-symbols-outlined text-sm\">close</span>\r\n                                </button>\r\n                                {category === VehicleCategory.PINK && (\r\n                                    <div className=\"absolute top-4 left-6 bg-white/20 backdrop-blur-md px-3 py-1 rounded-full border border-white/30\">\r\n                                        <span className=\"text-[9px] font-black text-white uppercase tracking-widest flex items-center gap-1\"> Pink Cab Service</span>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                            <div className=\"px-8 pb-8 -mt-12 max-h-[70vh] overflow-y-auto\">\r\n                                <div className=\"relative inline-block\">\r\n                                    <img src={viewingProfile.avatar} className=\"size-24 rounded-3xl border-4 border-white shadow-xl bg-slate-100 object-cover mb-4\" alt=\"avatar\" />\r\n                                    {category === VehicleCategory.PINK && (\r\n                                        <div className=\"absolute -bottom-1 -right-1 bg-pink-500 text-white size-6 rounded-lg flex items-center justify-center border-2 border-white shadow-lg\">\r\n                                            <span className=\"material-symbols-outlined text-[10px] font-black\">favorite</span>\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                                <h2 className=\"text-3xl font-black text-slate-900 tracking-tight uppercase italic mb-1\">{viewingProfile.name}</h2>\r\n                                <p className=\"text-slate-400 text-[10px] font-black uppercase tracking-[0.2em] mb-8\">{viewingProfile.carModel}  <span className=\"text-slate-900\">{viewingProfile.carNumber}</span></p>\r\n\r\n                                <div className=\"grid grid-cols-3 gap-4 mb-8\">\r\n                                    <div className={`text-center p-4 ${category === VehicleCategory.PINK ? 'bg-pink-50 text-pink-600 border border-pink-100' : 'bg-slate-50 text-slate-800 border border-slate-100'} rounded-[1.5rem]`}><p className=\"text-xl font-black\">{viewingProfile.rating}</p><p className=\"text-[8px] font-black uppercase text-slate-400 tracking-widest\">Rating</p></div>\r\n                                    <div className={`text-center p-4 ${category === VehicleCategory.PINK ? 'bg-pink-50 text-pink-600 border border-pink-100' : 'bg-slate-50 text-slate-800 border border-slate-100'} rounded-[1.5rem]`}><p className=\"text-xl font-black\">1.2k</p><p className=\"text-[8px] font-black uppercase text-slate-400 tracking-widest\">Trips</p></div>\r\n                                    <div className={`text-center p-4 ${category === VehicleCategory.PINK ? 'bg-pink-50 text-pink-600 border border-pink-100' : 'bg-slate-50 text-slate-800 border border-slate-100'} rounded-[1.5rem]`}><p className=\"text-xl font-black\">3yr</p><p className=\"text-[8px] font-black uppercase text-slate-400 tracking-widest\">Exp</p></div>\r\n                                </div>\r\n\r\n                                {viewingProfile.bio && (\r\n                                    <div className=\"mb-6\">\r\n                                        <p className=\"text-[10px] font-black uppercase text-slate-400 mb-2\">About Partner</p>\r\n                                        <p className=\"text-[11px] font-medium text-slate-600 leading-relaxed italic border-l-2 border-slate-100 pl-4\">{viewingProfile.bio}</p>\r\n                                    </div>\r\n                                )}\r\n\r\n                                {viewingProfile.languages && viewingProfile.languages.length > 0 && (\r\n                                    <div className=\"mb-6\">\r\n                                        <p className=\"text-[10px] font-black uppercase text-slate-400 mb-2\">Languages</p>\r\n                                        <div className=\"flex flex-wrap gap-1\">\r\n                                            {viewingProfile.languages.map(l => (\r\n                                                <span key={l} className=\"text-[9px] font-bold bg-slate-100 text-slate-600 px-2 py-1 rounded-lg border border-slate-200\">{l}</span>\r\n                                            ))}\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n\r\n                                <div className=\"mb-6\">\r\n                                    <p className=\"text-[10px] font-black uppercase text-slate-400 mb-2\">Driver Conditions</p>\r\n                                    <div className=\"flex flex-wrap gap-2\">{viewingProfile.conditions.map((c, i) => (<span key={i} className=\"text-[10px] bg-orange-50 text-orange-700 px-3 py-1.5 rounded-lg font-bold border border-orange-100\">{c}</span>))}</div>\r\n                                </div>\r\n\r\n                                <button onClick={() => { setSelectedDriver(viewingProfile); setViewingProfile(null); setStep('PAYMENT'); }} className={`w-full h-14 ${category === VehicleCategory.PINK ? 'bg-pink-600 shadow-[0_10px_30px_rgba(219,39,119,0.3)]' : 'bg-slate-900 shadow-xl'} text-white rounded-2xl font-black text-xs uppercase tracking-widest hover:scale-[1.02] transition-transform active:scale-95`}>Select Partner</button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                )\r\n            }\r\n\r\n            {\r\n                showBreakdown && (\r\n                    <div className=\"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center p-6\" onClick={() => setShowBreakdown(false)}>\r\n                        <div className=\"bg-[#1e293b] w-full max-w-sm rounded-[2rem] p-6 lg:p-8 animate-in zoom-in-95 border border-white/10 shadow-2xl\" onClick={e => e.stopPropagation()}>\r\n                            <div className=\"flex items-center justify-between mb-6\">\r\n                                <h3 className=\"text-lg lg:text-xl font-black text-white\">Fare Details</h3>\r\n                                <button onClick={() => setShowBreakdown(false)} className=\"text-slate-400 hover:text-white\"><span className=\"material-symbols-outlined\">close</span></button>\r\n                            </div>\r\n                            <div className=\"space-y-4\">\r\n                                <div className=\"flex justify-between text-xs font-bold text-slate-400\">\r\n                                    <span>Base Rate</span>\r\n                                    <span className=\"text-white\">{Math.round(initialFare * 0.4)}</span>\r\n                                </div>\r\n                                <div className=\"flex justify-between text-xs font-bold text-slate-400\">\r\n                                    <span>Distance & Time</span>\r\n                                    <span className=\"text-white\">{Math.round(initialFare * 0.6)}</span>\r\n                                </div>\r\n                                <div className=\"flex justify-between text-xs font-bold text-slate-400\">\r\n                                    <span>Demand Surge</span>\r\n                                    <span className=\"text-[#22c55e]\">1.0x</span>\r\n                                </div>\r\n                                {rideType === 'SHARED' && (\r\n                                    <div className=\"flex justify-between text-xs font-bold text-[#22c55e]\">\r\n                                        <span>Shared Saver</span>\r\n                                        <span>-30%</span>\r\n                                    </div>\r\n                                )}\r\n                                <div className=\"pt-4 border-t border-white/10 flex justify-between items-center\">\r\n                                    <span className=\"text-sm font-black uppercase tracking-widest text-slate-300\">Total Est.</span>\r\n                                    <span className=\"text-2xl font-black text-white\">{bid}</span>\r\n                                </div>\r\n                            </div>\r\n                            <p className=\"mt-8 text-[10px] text-slate-500 font-medium text-center\">Includes taxes and standard platform fees.</p>\r\n                        </div>\r\n                    </div>\r\n                )\r\n            }\r\n        </div >\r\n    );\r\n};\r\n\r\nexport default FlexFare;\r\n",
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\screens\\rider\\LiveTracking.tsx",
        "messages": [
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'currentTime' is assigned a value but never used.",
                "line": 27,
                "column": 12,
                "nodeType": "Identifier",
                "messageId": "unusedVar",
                "endLine": 27,
                "endColumn": 23
            },
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'mapSrc' is assigned a value but never used.",
                "line": 125,
                "column": 11,
                "nodeType": "Identifier",
                "messageId": "unusedVar",
                "endLine": 125,
                "endColumn": 17
            }
        ],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 2,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "source": "import React, { useState, useEffect } from 'react';\r\nimport { useLocation, Link, useNavigate } from 'react-router-dom';\r\nimport SOSButton from '../../components/Safety/SOSButton';\r\nimport { db } from '../../firebase';\r\nimport { doc, onSnapshot } from 'firebase/firestore';\r\nimport { useRide } from '../../hooks/useRide';\r\nimport { RideStatus, User, Coordinates } from '../../types';\r\nimport { useAuth } from '../../context/AuthContext';\r\nimport Chat from '../../components/shared/Chat';\r\nimport MapContainer from '../../components/MapContainer';\r\n\r\nconst LiveTracking: React.FC = () => {\r\n    const { state } = useLocation();\r\n    const navigate = useNavigate();\r\n    const { activeRide, cancelRide } = useRide();\r\n\r\n    const pickup = activeRide?.pickupAddress || state?.pickup || 'Mathura Junction';\r\n    const destination = activeRide?.dropAddress || state?.destination || 'Vrindavan Gate';\r\n\r\n    // Component State\r\n    const [showDetails, setShowDetails] = useState(false);\r\n    const [chatOpen, setChatOpen] = useState(false);\r\n    const [showCancelModal, setShowCancelModal] = useState(false);\r\n    const [cancelReason, setCancelReason] = useState('');\r\n    // const [progress, setProgress] = useState(0);\r\n    const { user } = useAuth();\r\n    const [currentTime, setCurrentTime] = useState(new Date());\r\n    const [safetyStatus] = useState<'SECURE' | 'DEVIATING' | 'STOPPED'>('SECURE');\r\n    const [showShareToast, setShowShareToast] = useState(false);\r\n\r\n    // Live Data State\r\n    const [driverPosition, setDriverPosition] = useState<Coordinates>(\r\n        activeRide?.pickupLocation || state?.pickupCoords || { lat: 27.4924, lng: 77.6737 }\r\n    );\r\n    const [eta, setEta] = useState(4);\r\n    const [driverDetails, setDriverDetails] = useState<any>(state?.driver || null);\r\n\r\n    const startPoint = activeRide?.pickupLocation || state?.pickupCoords || { lat: 27.4924, lng: 77.6737 };\r\n    const endPoint = activeRide?.dropLocation || state?.dropCoords || { lat: 27.5024, lng: 77.6837 };\r\n\r\n    useEffect(() => {\r\n        const timeTimer = setInterval(() => setCurrentTime(new Date()), 1000);\r\n        return () => clearInterval(timeTimer);\r\n    }, []);\r\n\r\n    // Listen to Driver Location if active\r\n    useEffect(() => {\r\n        if (!activeRide?.driverId) return;\r\n\r\n        const unsub = onSnapshot(doc(db, 'users', activeRide.driverId), (doc) => {\r\n            if (doc.exists()) {\r\n                const data = doc.data() as User;\r\n                if (data.currentLocation) {\r\n                    setDriverDetails((prev: any) => ({ ...prev, ...data }));\r\n                    // If we have actual GPS from driver, snap marker to it\r\n                    setDriverPosition(data.currentLocation);\r\n                }\r\n            }\r\n        });\r\n\r\n        return () => unsub();\r\n    }, [activeRide?.driverId]);\r\n\r\n    // Simple ETA & Progress Simulation (Synced with Ride status)\r\n    useEffect(() => {\r\n        if (!activeRide) return;\r\n\r\n        if (activeRide.status === RideStatus.COMPLETED) {\r\n            navigate('/user/trip-summary', { state: { ride: activeRide, driver: driverDetails || activeRide.driverDetails } });\r\n        }\r\n\r\n        if (activeRide.status === RideStatus.CANCELLED) {\r\n            alert(\"This ride has been cancelled.\");\r\n            navigate('/user/home');\r\n        }\r\n\r\n        // Animated movement simulator if status is ACCEPTED or STARTED (fallback if live location lags)\r\n        if (activeRide.status === RideStatus.ACCEPTED || activeRide.status === RideStatus.STARTED) {\r\n            const timer = setInterval(() => {\r\n                setDriverPosition((prev: Coordinates) => {\r\n                    // Only simulate if within a reasonable distance or no fresh live data\r\n                    const nextLat = prev.lat + (endPoint.lat - prev.lat) * 0.005;\r\n                    const nextLng = prev.lng + (endPoint.lng - prev.lng) * 0.005;\r\n                    return { lat: nextLat, lng: nextLng };\r\n                });\r\n                setEta((prev: number) => Math.max(1, prev - 0.1));\r\n\r\n                // Update progress based on distance to endPoint\r\n                // Update progress based on distance to endPoint\r\n                setDriverPosition(current => {\r\n                    // const totalDist = Math.sqrt(Math.pow(endPoint.lat - startPoint.lat, 2) + Math.pow(endPoint.lng - startPoint.lng, 2));\r\n                    // const currentDist = Math.sqrt(Math.pow(current.lat - startPoint.lat, 2) + Math.pow(current.lng - startPoint.lng, 2));\r\n                    // setProgress(currentDist / totalDist);\r\n                    return current;\r\n                });\r\n\r\n            }, 5000);\r\n            return () => clearInterval(timer);\r\n        }\r\n    }, [activeRide, navigate, endPoint.lat, endPoint.lng, startPoint.lat, startPoint.lng, driverDetails]);\r\n\r\n\r\n    const handleShare = () => {\r\n        const trackId = Math.random().toString(36).substr(2, 6);\r\n        const trackingUrl = `https://Gaadiwala.app/track/${trackId}`;\r\n        const text = `Track my ride with ${driver.name} (${driver.vehicleNumber}). ETA: ${eta} mins.`;\r\n\r\n        if (navigator.share) {\r\n            navigator.share({ title: 'My Gaadiwala Ride', text, url: trackingUrl }).catch(console.error);\r\n        } else {\r\n            window.open(`https://wa.me/?text=${encodeURIComponent(text + ' ' + trackingUrl)}`, '_blank');\r\n        }\r\n        setShowShareToast(true);\r\n        setTimeout(() => setShowShareToast(false), 3000);\r\n    };\r\n\r\n    const handleCancel = async () => {\r\n        if (!cancelReason) return alert(\"Please select a reason\");\r\n        if (activeRide) {\r\n            await cancelRide(activeRide.id, cancelReason);\r\n        }\r\n        navigate('/user/home');\r\n    };\r\n\r\n    const mapSrc = `https://maps.google.com/maps?width=100%25&height=600&hl=en&saddr=${encodeURIComponent(pickup)}&daddr=${encodeURIComponent(destination)}&t=m&z=13&ie=UTF8&iwloc=B&output=embed`;\r\n\r\n    // Final driver object to use in UI\r\n    const driver = driverDetails || activeRide?.driverDetails || state?.driver || {\r\n        name: \"Rajesh Kumar\",\r\n        avatar: \"https://images.unsplash.com/photo-1599566150163-29194dcaad36?w=100&h=100&fit=crop\",\r\n        rating: 4.9,\r\n        vehicleNumber: \"UP 85 AQ 1234\",\r\n        vehicleType: state?.category || \"Sedan\"\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <div className=\"bg-[#16181d] text-white font-sans overflow-hidden h-screen w-full flex flex-col relative\">\r\n                <header className=\"flex items-center justify-between border-b border-white/5 px-4 md:px-8 py-4 md:py-6 bg-black/60 backdrop-blur-3xl z-[60]\">\r\n                    <div className=\"flex items-center gap-3 md:gap-6\">\r\n                        <Link to=\"/\" className=\"size-9 md:size-12 bg-slate-900 rounded-xl md:rounded-2xl flex items-center justify-center text-white shadow-2xl shadow-black/50 shrink-0 border border-white/5\">\r\n                            <span className=\"material-symbols-outlined font-black text-sm md:text-xl text-[#00D1FF]\">rocket_launch</span>\r\n                        </Link>\r\n                        <div className=\"flex flex-col\">\r\n                            <h2 className=\"text-sm md:text-xl font-black tracking-tighter italic uppercase truncate max-w-[80px] md:max-w-none\">Gaadiwala <span className=\"text-[#00D1FF] not-italic\">Live</span></h2>\r\n                            <div className=\"flex items-center gap-1.5 mt-1\">\r\n                                <span className=\"size-1 md:size-1.5 rounded-full bg-green-500 animate-pulse\"></span>\r\n                                <p className=\"text-[7px] md:text-[10px] font-black uppercase text-slate-500 tracking-[0.2em] truncate italic\">\r\n                                    {activeRide?.status === RideStatus.ACCEPTED ? `Arriving` :\r\n                                        activeRide?.status === RideStatus.STARTED ? 'On Trip' :\r\n                                            activeRide?.status === RideStatus.ARRIVED ? 'Arrived' : 'Active Ops'}\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2 md:gap-3\">\r\n                        <div className=\"hidden sm:flex flex-col items-end mr-2 md:mr-4\">\r\n                            <p className=\"text-[7px] md:text-[8px] font-black uppercase text-slate-500 tracking-widest\">Safety</p>\r\n                            <div className=\"flex items-center gap-1\">\r\n                                <span className={`size-1 md:size-1.5 rounded-full ${safetyStatus === 'SECURE' ? 'bg-green-500' : 'bg-red-500'} animate-pulse`}></span>\r\n                                <span className={`text-[8px] md:text-[10px] font-black ${safetyStatus === 'SECURE' ? 'text-green-500' : 'text-red-500'}`}>{safetyStatus === 'SECURE' ? 'SECURE' : 'ALERT'}</span>\r\n                            </div>\r\n                        </div>\r\n                        <button onClick={handleShare} className=\"size-10 md:size-12 rounded-full bg-white/5 border border-white/10 flex items-center justify-center hover:bg-green-500 hover:text-white transition-all group relative\">\r\n                            <span className=\"material-symbols-outlined text-green-400 text-sm md:text-base group-hover:text-white\">share</span>\r\n                            {showShareToast && (\r\n                                <div className=\"absolute -bottom-10 right-0 bg-green-500 text-white text-[7px] md:text-[8px] font-black px-1.5 md:px-2 py-0.5 md:py-1 rounded-lg animate-in fade-in slide-in-from-top-1 whitespace-nowrap\">COPIED</div>\r\n                            )}\r\n                        </button>\r\n                        <button onClick={() => setChatOpen(true)} className=\"size-10 md:size-12 rounded-full bg-white/5 border border-white/10 flex items-center justify-center hover:bg-white/10 transition-all\">\r\n                            <span className=\"material-symbols-outlined text-teal-400 text-sm md:text-base\">forum</span>\r\n                        </button>\r\n                        <SOSButton onTrigger={() => alert(\"EMERGENCY Protocol Active.\")} />\r\n                        <button onClick={() => setShowCancelModal(true)} className=\"bg-red-500/10 text-red-500 px-3 md:px-6 h-10 md:h-12 rounded-full font-black text-[8px] md:text-[10px] uppercase tracking-widest md:tracking-[0.2em] border border-red-500/20 hover:bg-red-500 hover:text-white transition-all duration-300\">Abort</button>\r\n                    </div>\r\n                </header>\r\n\r\n                <main className=\"relative flex-1 bg-slate-900\">\r\n                    <div className=\"absolute inset-0 opacity-70\">\r\n                        <MapContainer\r\n                            pickup={activeRide?.pickupLocation}\r\n                            drop={activeRide?.dropLocation}\r\n                            center={driverPosition}\r\n                            drivers={[driverPosition]}\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"absolute inset-0 z-10 pointer-events-none\">\r\n                        {/* Status Label on top of map */}\r\n                        <div className=\"absolute top-10 left-1/2 -translate-x-1/2 bg-black/60 backdrop-blur-md px-4 py-2 rounded-full border border-white/10 flex items-center gap-2\">\r\n                            <span className=\"size-2 rounded-full bg-orange-500 animate-pulse\"></span>\r\n                            <span className=\"text-[10px] font-black uppercase tracking-widest text-white\">Live Tracking Active</span>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"absolute bottom-6 md:bottom-12 left-4 md:left-12 right-4 md:right-12 z-[70] flex justify-center\">\r\n                        <div className=\"w-full max-w-5xl bg-[#0A0E12]/90 backdrop-blur-3xl border border-white/5 rounded-[3rem] md:rounded-[4rem] p-8 md:p-10 shadow-[0_50px_100px_-20px_rgba(0,0,0,0.9)] relative overflow-hidden group\">\r\n                            <div className=\"absolute inset-0 bg-gradient-to-br from-[#00D1FF]/5 to-transparent pointer-events-none\"></div>\r\n                            {driver.vehicleType === 'PINK' && (\r\n                                <div className=\"absolute top-0 right-0 px-6 py-2 bg-pink-600 text-white rounded-bl-3xl text-[9px] font-black uppercase tracking-[0.2em] italic shadow-xl\">\r\n                                     Pink Cab Active\r\n                                </div>\r\n                            )}\r\n                            <div className=\"flex flex-col md:flex-row items-center gap-8 md:gap-12 relative z-10\">\r\n                                <div className=\"flex items-center gap-6 cursor-pointer w-full md:w-auto\" onClick={() => setShowDetails(!showDetails)}>\r\n                                    <div className=\"relative\">\r\n                                        <img src={driver.avatar || `https://api.dicebear.com/7.x/avataaars/svg?seed=${driver.id}`} className={`size-16 md:size-24 rounded-[2rem] object-cover border-4 ${driver.vehicleType === 'PINK' ? 'border-pink-500 shadow-pink-500/20' : 'border-[#00D1FF] shadow-[#00D1FF]/20'} shadow-2xl`} alt=\"avatar\" />\r\n                                        <div className={`absolute -bottom-2 -right-2 ${driver.vehicleType === 'PINK' ? 'bg-pink-500' : 'bg-[#00D1FF]'} text-black text-[9px] md:text-[11px] font-black px-2 md:px-3 py-1 rounded-xl border-4 border-[#0A0E12]`}>{driver.rating} </div>\r\n                                    </div>\r\n                                    <div className=\"min-w-0\">\r\n                                        <h3 className=\"text-xl md:text-3xl font-black tracking-tight truncate uppercase italic\">{driver.name}</h3>\r\n                                        <p className=\"text-slate-500 text-[10px] md:text-sm font-black uppercase tracking-[0.2em] truncate\">{driver.vehicleType} TIER  <span className=\"text-white italic\">{driver.vehicleNumber}</span></p>\r\n                                        <div className=\"flex items-center gap-2 mt-2\">\r\n                                            <span className={`px-2 py-0.5 rounded-md text-[8px] md:text-[9px] font-black uppercase tracking-widest italic ${driver.vehicleType === 'PINK' ? 'bg-pink-500/20 text-pink-400 border border-pink-500/20' : 'bg-[#00D1FF]/20 text-[#00D1FF] border border-[#00D1FF]/20'}`}>Verified Partner</span>\r\n                                        </div>\r\n                                    </div>\r\n                                    <span className=\"material-symbols-outlined ml-auto md:hidden text-slate-500\">expand_less</span>\r\n                                </div>\r\n\r\n                                <div className=\"w-full md:flex-1 grid grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6\">\r\n                                    <div className=\"bg-white/5 backdrop-blur-md p-5 rounded-3xl border border-white/5 shadow-2xl\">\r\n                                        <p className=\"text-[#00D1FF] text-[9px] font-black uppercase tracking-[0.2em] mb-2 leading-none italic\">Mission Status</p>\r\n                                        <div className=\"flex items-center gap-2\">\r\n                                            <span className=\"size-2 rounded-full bg-green-500 animate-pulse\"></span>\r\n                                            <p className=\"text-lg md:text-2xl font-black uppercase text-white truncate italic tracking-tighter\">{activeRide?.status || 'Active'}</p>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"bg-white/5 backdrop-blur-md p-5 rounded-3xl border border-white/5 shadow-2xl\">\r\n                                        <p className=\"text-slate-500 text-[9px] font-black uppercase tracking-[0.2em] mb-2 leading-none italic\">Board Code</p>\r\n                                        <p className=\"text-xl md:text-3xl font-black tracking-[0.3em] text-white italic\">{activeRide?.otp || '----'}</p>\r\n                                    </div>\r\n                                    <div className=\"bg-white/5 backdrop-blur-md p-5 rounded-3xl border border-white/5 shadow-2xl col-span-2 lg:col-span-1\">\r\n                                        <p className=\"text-slate-500 text-[9px] font-black uppercase tracking-[0.2em] mb-2 leading-none italic\">Total Yield</p>\r\n                                        <p className=\"text-xl md:text-3xl font-black text-[#00D1FF] italic leading-none\">{activeRide?.estimatedFare || state?.fare || '230'}</p>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Detailed Info Modal */}\r\n                    {showDetails && (\r\n                        <div className=\"fixed inset-0 z-[100] bg-black/90 backdrop-blur-xl flex items-center justify-center p-6\" onClick={() => setShowDetails(false)}>\r\n                            <div className=\"max-w-2xl w-full bg-slate-900 border border-white/10 rounded-[3.5rem] overflow-hidden animate-in zoom-in-95\" onClick={e => e.stopPropagation()}>\r\n                                <div className=\"h-64 relative\">\r\n                                    <img src={driver.vehicleImage || \"https://images.unsplash.com/photo-1549317661-bd32c8ce0db2\"} className=\"w-full h-full object-cover\" alt=\"vehicle img\" />\r\n                                    <div className=\"absolute inset-0 bg-gradient-to-t from-slate-900 via-transparent to-transparent\"></div>\r\n                                    <button onClick={() => setShowDetails(false)} className=\"absolute top-6 right-6 size-12 rounded-full bg-black/40 flex items-center justify-center hover:bg-black/60 transition-all\">\r\n                                        <span className=\"material-symbols-outlined\">close</span>\r\n                                    </button>\r\n                                </div>\r\n                                <div className=\"p-10 space-y-8\">\r\n                                    <div className=\"flex justify-between items-start\">\r\n                                        <div>\r\n                                            <h2 className=\"text-3xl font-black tracking-tighter\">{driver.name}</h2>\r\n                                            <p className=\"text-orange-500 font-bold uppercase text-xs tracking-widest\">{driver.vehicleType}  Elite Partner</p>\r\n                                        </div>\r\n                                        <div className=\"text-right\">\r\n                                            <p className=\"text-[10px] font-black uppercase text-slate-500\">Registration</p>\r\n                                            <p className=\"text-xl font-black\">{driver.vehicleNumber}</p>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"grid grid-cols-3 gap-6\">\r\n                                        <div className=\"bg-white/5 p-6 rounded-3xl border border-white/5 text-center\">\r\n                                            <span className=\"material-symbols-outlined text-orange-500 mb-2\">star</span>\r\n                                            <p className=\"text-xl font-black\">{driver.rating}</p>\r\n                                            <p className=\"text-[9px] font-black uppercase text-slate-500\">Avg Rating</p>\r\n                                        </div>\r\n                                        <div className=\"bg-white/5 p-6 rounded-3xl border border-white/5 text-center\">\r\n                                            <span className=\"material-symbols-outlined text-teal-400 mb-2\">thumb_up</span>\r\n                                            <p className=\"text-xl font-black\">99%</p>\r\n                                            <p className=\"text-[9px] font-black uppercase text-slate-500\">Satisfaction</p>\r\n                                        </div>\r\n                                        <div className=\"bg-white/5 p-6 rounded-3xl border border-white/5 text-center\">\r\n                                            <span className=\"material-symbols-outlined text-blue-400 mb-2\">history</span>\r\n                                            <p className=\"text-xl font-black\">6 Yrs</p>\r\n                                            <p className=\"text-[9px] font-black uppercase text-slate-500\">Partner Since</p>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Chat Drawer */}\r\n                    {chatOpen && activeRide && (\r\n                        <div className=\"fixed inset-0 z-[150] flex items-end justify-center md:items-center p-0 md:p-6 bg-black/40 backdrop-blur-sm\" onClick={() => setChatOpen(false)}>\r\n                            <div onClick={e => e.stopPropagation()} className=\"w-full md:w-auto\">\r\n                                <Chat\r\n                                    rideId={activeRide.id}\r\n                                    currentUserId={user?.id || ''}\r\n                                    onClose={() => setChatOpen(false)}\r\n                                    recipientName={driver.name}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Cancellation Modal */}\r\n                    {showCancelModal && (\r\n                        <div className=\"fixed inset-0 z-[160] bg-black/90 backdrop-blur-sm flex items-center justify-center p-6\">\r\n                            <div className=\"bg-white text-slate-900 w-full max-w-md rounded-[2.5rem] p-8 animate-in zoom-in-95\">\r\n                                <h2 className=\"text-2xl font-black mb-2\">Cancel Ride?</h2>\r\n                                <p className=\"text-sm text-slate-500 mb-6\">Cancellation fee may apply. Please tell us why.</p>\r\n\r\n                                <div className=\"space-y-3 mb-8\">\r\n                                    {['Driver asked to cancel', 'Driver is too far away', 'Found another ride', 'Changed my plans', 'Waiting too long'].map(reason => (\r\n                                        <button\r\n                                            key={reason}\r\n                                            onClick={() => setCancelReason(reason)}\r\n                                            className={`w-full p-4 rounded-xl border-2 text-left font-bold text-sm transition-all ${cancelReason === reason ? 'border-orange-500 bg-orange-50 text-orange-700' : 'border-slate-100 text-slate-600 hover:border-slate-300'\r\n                                                }`}\r\n                                        >\r\n                                            {reason}\r\n                                        </button>\r\n                                    ))}\r\n                                </div>\r\n\r\n                                <div className=\"flex gap-4\">\r\n                                    <button onClick={handleCancel} className=\"flex-1 h-14 bg-red-600 text-white rounded-xl font-black text-xs uppercase tracking-widest hover:bg-red-700\">Confirm Cancel</button>\r\n                                    <button onClick={() => setShowCancelModal(false)} className=\"flex-1 h-14 bg-slate-100 text-slate-600 rounded-xl font-black text-xs uppercase tracking-widest hover:bg-slate-200\">Keep Ride</button>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </main>\r\n            </div>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default LiveTracking;\r\n",
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\screens\\rider\\RiderHome.tsx",
        "messages": [
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'SOSButton' is defined but never used.",
                "line": 9,
                "column": 8,
                "nodeType": "Identifier",
                "messageId": "unusedVar",
                "endLine": 9,
                "endColumn": 17
            },
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'isCalculatingForensics' is assigned a value but never used.",
                "line": 43,
                "column": 12,
                "nodeType": "Identifier",
                "messageId": "unusedVar",
                "endLine": 43,
                "endColumn": 34
            },
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'isCalculatingRoutes' is assigned a value but never used.",
                "line": 60,
                "column": 12,
                "nodeType": "Identifier",
                "messageId": "unusedVar",
                "endLine": 60,
                "endColumn": 31
            },
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'isLoadingRecs' is assigned a value but never used.",
                "line": 65,
                "column": 12,
                "nodeType": "Identifier",
                "messageId": "unusedVar",
                "endLine": 65,
                "endColumn": 25
            },
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'setIsLoadingRecs' is assigned a value but never used.",
                "line": 65,
                "column": 27,
                "nodeType": "Identifier",
                "messageId": "unusedVar",
                "endLine": 65,
                "endColumn": 43
            },
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'currentTime' is assigned a value but never used.",
                "line": 88,
                "column": 12,
                "nodeType": "Identifier",
                "messageId": "unusedVar",
                "endLine": 88,
                "endColumn": 23
            },
            {
                "ruleId": "react-hooks/exhaustive-deps",
                "severity": 1,
                "message": "React Hook useEffect has a missing dependency: 'handleGetLocation'. Either include it or remove the dependency array.",
                "line": 107,
                "column": 8,
                "nodeType": "ArrayExpression",
                "endLine": 107,
                "endColumn": 10,
                "suggestions": [
                    {
                        "desc": "Update the dependencies array to be: [handleGetLocation]",
                        "fix": {
                            "range": [
                                5191,
                                5193
                            ],
                            "text": "[handleGetLocation]"
                        }
                    }
                ]
            },
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'vType' is assigned a value but never used.",
                "line": 1024,
                "column": 47,
                "nodeType": "Identifier",
                "messageId": "unusedVar",
                "endLine": 1024,
                "endColumn": 52
            }
        ],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 8,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "source": "\r\nimport React, { useState, useEffect, useRef } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useJsApiLoader, Autocomplete } from '@react-google-maps/api';\r\nimport { User, RideType, VehicleCategory, SavedLocation, ScheduledRide, Coordinates, RidePreferences } from '../../types';\r\nimport MapContainer from '../../components/MapContainer';\r\nimport DistrictPicker from '../../components/Discovery/DistrictPicker';\r\nimport TiffinSelector from '../../components/Tiffin/TiffinSelector';\r\nimport SOSButton from '../../components/Safety/SOSButton'; // New\r\nimport SavedPlaces from '../../components/Discovery/SavedPlaces'; // New\r\nimport { calculateFare } from '../../services/pricing'; // New\r\nimport { db, CONFIG } from '../../firebase';\r\nimport { collection, query, where, onSnapshot } from 'firebase/firestore';\r\nimport GlobalBanner from '../../components/GlobalBanner';\r\nimport { getCurrentPosition, GeolocationError, GeolocationErrorType } from '../../utils/GeolocationHelper';\r\nimport { calculateRoutes, RouteOption } from '../../services/RoutesService';\r\n\r\ninterface Props {\r\n    user: User;\r\n    onSaveLocation: (loc: SavedLocation) => void;\r\n    onSchedule: (ride: ScheduledRide) => void;\r\n}\r\n\r\nconst libraries: (\"places\" | \"geometry\" | \"drawing\" | \"visualization\")[] = [\"places\", \"geometry\"];\r\n\r\nconst RiderHome: React.FC<Props> = ({ user, onSaveLocation, onSchedule }) => {\r\n    const { isLoaded } = useJsApiLoader({\r\n        id: 'google-map-script',\r\n        googleMapsApiKey: CONFIG.MAPS_API_KEY,\r\n        libraries,\r\n    });\r\n\r\n    const [pickup, setPickup] = useState('');\r\n    const [destination, setDestination] = useState('');\r\n    const [pickupCoords, setPickupCoords] = useState<Coordinates | undefined>(undefined);\r\n    const [dropCoords, setDropCoords] = useState<Coordinates | undefined>(undefined);\r\n\r\n    const [rideType, setRideType] = useState<RideType>('RESERVED');\r\n    const [category, setCategory] = useState<VehicleCategory>(VehicleCategory.MINI);\r\n    const [isLocating, setIsLocating] = useState(false);\r\n    const [isScheduling, setIsScheduling] = useState(false);\r\n    const [isGeocoding, setIsGeocoding] = useState(false);\r\n    const [isCalculatingForensics, setIsCalculatingForensics] = useState(false);\r\n    const [scheduleDate, setScheduleDate] = useState('');\r\n    const [error, setError] = useState<string | null>(null);\r\n    const [showSidebar, setShowSidebar] = useState(false);\r\n    const [isSidebarCollapsed, setIsSidebarCollapsed] = useState(false);\r\n    const [preferences, setPreferences] = useState<RidePreferences>({\r\n        silent: false,\r\n        ac: false,\r\n        music: false\r\n    });\r\n    const [passengerCount, setPassengerCount] = useState<number>(1);\r\n\r\n    const [routeForensics, setRouteForensics] = useState<{ distance: string, duration: string } | null>(null);\r\n\r\n    // Routes API state\r\n    const [routeOptions, setRouteOptions] = useState<RouteOption[]>([]);\r\n    const [selectedRoute, setSelectedRoute] = useState<number>(0);\r\n    const [isCalculatingRoutes, setIsCalculatingRoutes] = useState(false);\r\n    const [showRouteOptions, setShowRouteOptions] = useState(false);\r\n\r\n    // Recommendations state\r\n    const [suggestions, setSuggestions] = useState<any[]>([]);\r\n    const [isLoadingRecs, setIsLoadingRecs] = useState(false);\r\n\r\n    // Fetch suggestions if we have pickup coords but no suggestions yet\r\n    useEffect(() => {\r\n        if (pickupCoords && window.google) {\r\n            import('../../services/PlacesService').then(({ getNearbyPlaces }) => {\r\n                getNearbyPlaces(pickupCoords, 5000, 'tourist_attraction|train_station|shopping_mall', CONFIG.MAPS_API_KEY)\r\n                    .then(places => {\r\n                        const formatted = places.map(p => ({\r\n                            icon: p.types.includes('train_station') ? 'train' :\r\n                                p.types.includes('shopping_mall') ? 'shopping_bag' : 'place',\r\n                            label: p.name,\r\n                            desc: p.vicinity || p.types[0]?.replace('_', ' '),\r\n                            address: p.name,\r\n                            lat: p.location?.lat,\r\n                            lng: p.location?.lng\r\n                        })).slice(0, 4);\r\n                        setSuggestions(formatted);\r\n                    });\r\n            });\r\n        }\r\n    }, [pickupCoords]);\r\n\r\n    const [currentTime, setCurrentTime] = useState(new Date());\r\n    const [nearbyDrivers, setNearbyDrivers] = useState<{ id: string, [key: string]: any }[]>([]);\r\n\r\n    // System Config for Pricing\r\n    const [sysConfig] = useState({\r\n        baseFares: { BIKE: 6, AUTO: 10, MINI: 20, PINK: 25, PRIME: 40 } as Record<VehicleCategory, number>,\r\n        surgeMultiplier: 1.0\r\n    });\r\n\r\n    const pickupRef = useRef<google.maps.places.Autocomplete | null>(null);\r\n    const dropRef = useRef<google.maps.places.Autocomplete | null>(null);\r\n\r\n    const navigate = useNavigate();\r\n\r\n    useEffect(() => {\r\n        const timer = setInterval(() => setCurrentTime(new Date()), 1000);\r\n        // Auto-locate on mount\r\n        handleGetLocation();\r\n        return () => clearInterval(timer);\r\n    }, []);\r\n\r\n    // Discovery: Listen to all drivers\r\n    useEffect(() => {\r\n        console.log('Starting driver discovery...');\r\n\r\n        const q = query(\r\n            collection(db, 'users'),\r\n            where('role', '==', 'DRIVER')\r\n        );\r\n\r\n        const unsubscribe = onSnapshot(q, (snapshot) => {\r\n            try {\r\n                if (snapshot.metadata.fromCache && snapshot.empty) return;\r\n                console.log('Firestore snapshot received, docs:', snapshot.docs.length);\r\n\r\n                const drivers = snapshot.docs\r\n                    .map(doc => {\r\n                        const data = doc.data();\r\n                        console.log('Driver doc:', doc.id, data);\r\n                        return { id: doc.id, ...data };\r\n                    })\r\n                    .filter((d: any) =>\r\n                        d &&\r\n                        d.isActive !== false &&\r\n                        d.currentLocation &&\r\n                        typeof d.currentLocation.lat === 'number' &&\r\n                        typeof d.currentLocation.lng === 'number'\r\n                    );\r\n\r\n                console.log('Valid drivers found:', drivers.length);\r\n                console.log('Online drivers:', drivers.filter((d: any) => d.isOnline).length);\r\n\r\n                setNearbyDrivers(drivers as any);\r\n            } catch (err) {\r\n                console.error(\"Firestore Listener Error (Homepage):\", err);\r\n            }\r\n        }, (error) => {\r\n            console.error(\"Firestore onSnapshot error:\", error);\r\n            setError(\"Connectivity issue. Reconnecting...\");\r\n            setNearbyDrivers([]);\r\n        });\r\n\r\n        return () => unsubscribe();\r\n    }, []);\r\n\r\n    // Get current location on mount or request\r\n    const handleGetLocation = async () => {\r\n        setIsLocating(true);\r\n        setError(null);\r\n\r\n        try {\r\n            const coords = await getCurrentPosition({\r\n                timeout: 10000,\r\n                enableHighAccuracy: true,\r\n                retries: 2\r\n            });\r\n\r\n            setPickupCoords(coords);\r\n            setPickup(\"Current Location\");\r\n            setError(null);\r\n        } catch (err) {\r\n            const geoError = err as GeolocationError;\r\n            console.error('Geolocation error:', geoError);\r\n            setError(geoError.userMessage);\r\n\r\n            // If permission denied, don't auto-retry\r\n            if (geoError.type !== GeolocationErrorType.PERMISSION_DENIED) {\r\n                // Clear pickup if it was set to \"Current Location\"\r\n                if (pickup === \"Current Location\") {\r\n                    setPickup('');\r\n                    setPickupCoords(undefined);\r\n                }\r\n            }\r\n        } finally {\r\n            setIsLocating(false);\r\n        }\r\n    };\r\n\r\n    const onPickupLoad = (autocomplete: google.maps.places.Autocomplete) => {\r\n        pickupRef.current = autocomplete;\r\n    };\r\n\r\n    const onPickupPlaceChanged = () => {\r\n        if (pickupRef.current) {\r\n            const place = pickupRef.current.getPlace();\r\n            if (place && place.geometry && place.geometry.location) {\r\n                const lat = place.geometry.location.lat();\r\n                const lng = place.geometry.location.lng();\r\n                setPickupCoords({ lat, lng });\r\n                setPickup(place.formatted_address || place.name || \"\");\r\n            }\r\n        }\r\n    };\r\n\r\n    const onDropLoad = (autocomplete: google.maps.places.Autocomplete) => {\r\n        dropRef.current = autocomplete;\r\n    };\r\n\r\n    const onDropPlaceChanged = () => {\r\n        if (dropRef.current) {\r\n            const place = dropRef.current.getPlace();\r\n            if (place && place.geometry && place.geometry.location) {\r\n                const lat = place.geometry.location.lat();\r\n                const lng = place.geometry.location.lng();\r\n                setDropCoords({ lat, lng });\r\n                setDestination(place.formatted_address || place.name || \"\");\r\n                setError(null);\r\n            }\r\n        }\r\n    };\r\n\r\n    // Proactive Geocoding for manual entries\r\n    useEffect(() => {\r\n        const timer = setTimeout(async () => {\r\n            if (pickup && !pickupCoords && pickup !== \"Current Location\") {\r\n                try {\r\n                    const coords = await geocodeAddress(pickup);\r\n                    setPickupCoords(coords);\r\n                } catch (e) { }\r\n            }\r\n        }, 1500); // 1.5s debounce\r\n        return () => clearTimeout(timer);\r\n    }, [pickup, pickupCoords]);\r\n\r\n    useEffect(() => {\r\n        const timer = setTimeout(async () => {\r\n            if (destination && !dropCoords) {\r\n                try {\r\n                    const coords = await geocodeAddress(destination);\r\n                    setDropCoords(coords);\r\n                } catch (e) { }\r\n            }\r\n        }, 1500); // 1.5s debounce\r\n        return () => clearTimeout(timer);\r\n    }, [destination, dropCoords]);\r\n\r\n    // Calculate routes using Routes API when both coords are available\r\n    useEffect(() => {\r\n        if (pickupCoords && dropCoords) {\r\n            setIsCalculatingRoutes(true);\r\n            setIsCalculatingForensics(true);\r\n            console.log('Calculating routes between:', pickupCoords, dropCoords);\r\n\r\n            calculateRoutes(pickupCoords, dropCoords, CONFIG.MAPS_API_KEY)\r\n                .then(routes => {\r\n                    console.log('Routes API Response:', routes);\r\n                    setRouteOptions(routes);\r\n                    setSelectedRoute(0); // Default to first (fastest) route\r\n\r\n                    if (routes.length > 0) {\r\n                        const mainRoute = routes[0];\r\n                        setRouteForensics({\r\n                            distance: mainRoute.distance,\r\n                            duration: mainRoute.durationInTraffic || mainRoute.duration\r\n                        });\r\n                        setShowRouteOptions(routes.length > 1); // Show options if multiple routes\r\n                    }\r\n                    setIsCalculatingRoutes(false);\r\n                    setIsCalculatingForensics(false);\r\n                })\r\n                .catch(error => {\r\n                    console.error('Routes API Error:', error);\r\n\r\n                    // Fallback to Distance Matrix API if Routes API fails\r\n                    if (window.google) {\r\n                        console.log('Falling back to Distance Matrix API...');\r\n                        const service = new window.google.maps.DistanceMatrixService();\r\n                        service.getDistanceMatrix({\r\n                            origins: [pickupCoords],\r\n                            destinations: [dropCoords],\r\n                            travelMode: google.maps.TravelMode.DRIVING,\r\n                            unitSystem: google.maps.UnitSystem.METRIC,\r\n                        }, (response, status) => {\r\n                            if (status === 'OK' && response && response.rows[0]?.elements[0]?.status === 'OK') {\r\n                                const result = response.rows[0].elements[0];\r\n                                setRouteForensics({\r\n                                    distance: result.distance.text,\r\n                                    duration: result.duration.text\r\n                                });\r\n                            } else {\r\n                                setError('Unable to calculate route. Please try again.');\r\n                                setRouteForensics({\r\n                                    distance: 'N/A',\r\n                                    duration: 'N/A'\r\n                                });\r\n                            }\r\n                            setIsCalculatingRoutes(false);\r\n                            setIsCalculatingForensics(false);\r\n                        });\r\n                    } else {\r\n                        setError('Maps not loaded. Please refresh the page.');\r\n                        setIsCalculatingRoutes(false);\r\n                        setIsCalculatingForensics(false);\r\n                    }\r\n                });\r\n        } else {\r\n            setRouteForensics(null);\r\n            setRouteOptions([]);\r\n            setShowRouteOptions(false);\r\n            setIsCalculatingForensics(false);\r\n            setIsCalculatingRoutes(false);\r\n        }\r\n    }, [pickupCoords, dropCoords]);\r\n\r\n\r\n\r\n    const categories: { type: VehicleCategory; label: string; icon: string; base: number; isPink?: boolean }[] = [\r\n        { type: VehicleCategory.BIKE, label: 'Bike', icon: 'motorcycle', base: 10 },\r\n        { type: VehicleCategory.AUTO, label: 'Auto', icon: 'electric_rickshaw', base: 15 },\r\n        { type: VehicleCategory.MINI, label: 'Gaadiwala Go', icon: 'directions_car', base: 25 },\r\n        { type: VehicleCategory.PINK, label: 'Pink Cab', icon: 'female', base: 30, isPink: true },\r\n        { type: VehicleCategory.PRIME, label: 'Luxury', icon: 'local_taxi', base: 50 },\r\n    ];\r\n\r\n\r\n    const geocodeAddress = (address: string): Promise<Coordinates> => {\r\n        return new Promise((resolve, reject) => {\r\n            if (!window.google) {\r\n                reject(new Error(\"Maps API not loaded\"));\r\n                return;\r\n            }\r\n            const geocoder = new window.google.maps.Geocoder();\r\n            geocoder.geocode({ address }, (results, status) => {\r\n                if (status === 'OK' && results && results[0].geometry.location) {\r\n                    const loc = results[0].geometry.location;\r\n                    resolve({ lat: loc.lat(), lng: loc.lng() });\r\n                } else {\r\n                    reject(new Error(`Geocode failed: ${status}`));\r\n                }\r\n            });\r\n        });\r\n    };\r\n\r\n    const handleConfirm = async () => {\r\n        if (!pickup || !destination) {\r\n            setError(\"Please enter both pickup and destination.\");\r\n            return;\r\n        }\r\n\r\n        setError(null);\r\n        setIsGeocoding(true);\r\n\r\n        try {\r\n            let pCoords = pickupCoords;\r\n            let dCoords = dropCoords;\r\n\r\n            // Geocode if missing\r\n            if (!pCoords) {\r\n                if (pickup === \"Current Location\") {\r\n                    // Try to get actual GPS using our helper\r\n                    try {\r\n                        pCoords = await getCurrentPosition({\r\n                            timeout: 8000,\r\n                            enableHighAccuracy: true,\r\n                            retries: 1\r\n                        });\r\n                        setPickupCoords(pCoords);\r\n                    } catch (e) {\r\n                        const geoError = e as GeolocationError;\r\n                        throw new Error(geoError.userMessage || \"Could not access your GPS location. Please type an address or select from suggestions.\");\r\n                    }\r\n                } else {\r\n                    try {\r\n                        pCoords = await geocodeAddress(pickup);\r\n                        setPickupCoords(pCoords);\r\n                    } catch (e) {\r\n                        throw new Error(\"Could not find pickup location on map. Please try a more specific address.\");\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (!dCoords) {\r\n                try {\r\n                    dCoords = await geocodeAddress(destination);\r\n                    setDropCoords(dCoords);\r\n                } catch (e) {\r\n                    throw new Error(\"Could not find destination on map. Please try a more specific address.\");\r\n                }\r\n            }\r\n\r\n            // Calculate initial fare for the next screen\r\n            let calculatedFare = 0;\r\n            if (routeForensics) {\r\n                const pricingSingle = calculateFare(10, 30, category, user, sysConfig, 1);\r\n                const basePrice10km = rideType === 'SHARED' ? Math.round(pricingSingle.total * 0.7) : pricingSingle.total;\r\n                const actualDist = parseFloat(routeForensics.distance.split(' ')[0]);\r\n                calculatedFare = Math.round((basePrice10km / 10) * actualDist) * passengerCount;\r\n            }\r\n\r\n            navigate('/user/fare', {\r\n                state: {\r\n                    pickup,\r\n                    destination,\r\n                    pickupCoords: pCoords,\r\n                    dropCoords: dCoords,\r\n                    rideType,\r\n                    category,\r\n                    scheduledTimestamp: isScheduling ? new Date(scheduleDate).getTime() : undefined,\r\n                    preferences,\r\n                    initialFare: calculatedFare || 250, // Pass the calculated/offered price\r\n                    forensics: routeForensics, // Pass distance/time data\r\n                    passengerCount // Pass passenger count\r\n                }\r\n            });\r\n        } catch (err: any) {\r\n            setError(err.message || \"Precision location error.\");\r\n        } finally {\r\n            setIsGeocoding(false);\r\n        }\r\n    };\r\n\r\n    const handleSaveCurrent = () => {\r\n        if (!destination) return;\r\n        const label = prompt(\"Enter a label for this location (e.g., Home, Office):\");\r\n        if (label) {\r\n            onSaveLocation({\r\n                id: Math.random().toString(36).substr(2, 9),\r\n                label: label || 'Saved Place',\r\n                address: destination,\r\n                type: 'OTHER'\r\n            });\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex flex-col lg:flex-row h-screen w-full overflow-hidden bg-[#0F172A] text-slate-200 font-sans\">\r\n            <GlobalBanner />\r\n            {/* Mobile Nav Header */}\r\n            <div className=\"lg:hidden h-16 bg-[#1e293b] border-b border-white/5 px-6 flex items-center justify-between z-[60] shadow-md\">\r\n                <div className=\"flex items-center gap-3\">\r\n                    <div className=\"size-8 bg-[#22c55e] rounded-xl flex items-center justify-center text-black shadow-lg shadow-[#22c55e]/20\">\r\n                        <span className=\"material-symbols-outlined text-xl font-black\">rocket_launch</span>\r\n                    </div>\r\n                    <span className=\"text-xl font-black italic tracking-tighter uppercase text-white\">Gaadiwala</span>\r\n                </div>\r\n                {/* Global Error Banner */}\r\n                {error && (\r\n                    <div className=\"absolute top-[100%] left-0 right-0 bg-red-500 text-white px-6 py-2 z-[100] flex justify-between items-center animate-in slide-in-from-top duration-300\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <span className=\"material-symbols-outlined text-sm\">error</span>\r\n                            <p className=\"text-[10px] lg:text-xs font-bold uppercase tracking-widest\">{error}</p>\r\n                        </div>\r\n                        <button onClick={() => setError(null)} className=\"p-1 hover:bg-white/10 rounded-full transition-colors\">\r\n                            <span className=\"material-symbols-outlined text-sm\">close</span>\r\n                        </button>\r\n                    </div>\r\n                )}\r\n                <button onClick={() => setShowSidebar(!showSidebar)} className=\"size-10 rounded-xl bg-white/5 flex items-center justify-center text-white border border-white/10 active:scale-95 transition-all\">\r\n                    <span className=\"material-symbols-outlined\">{showSidebar ? 'close' : 'menu'}</span>\r\n                </button>\r\n            </div>\r\n\r\n            {/* Mobile Sidebar Overlay/Backdrop */}\r\n            {showSidebar && (\r\n                <div\r\n                    className=\"fixed inset-0 bg-black/40 backdrop-blur-sm z-[65] lg:hidden transition-opacity duration-300\"\r\n                    onClick={() => setShowSidebar(false)}\r\n                />\r\n            )}\r\n\r\n            <aside className={`\r\n                fixed inset-y-0 left-0 bg-[#0F172A] border-r border-white/10 z-[70] transform transition-all duration-300 lg:relative lg:translate-x-0\r\n                ${showSidebar ? 'translate-x-0' : '-translate-x-full'}\r\n                ${isSidebarCollapsed ? 'lg:w-24' : 'lg:w-80'}\r\n                flex flex-col justify-between py-10 shrink-0 shadow-[20px_0_50px_rgba(0,0,0,0.3)]\r\n            `}>\r\n                <button\r\n                    onClick={() => setShowSidebar(false)}\r\n                    className=\"lg:hidden absolute top-6 right-6 size-10 rounded-full bg-white/5 flex items-center justify-center text-white border border-white/10\"\r\n                >\r\n                    <span className=\"material-symbols-outlined\">close</span>\r\n                </button>\r\n\r\n                {/* Close button for mobile sidebar */}\r\n                <button\r\n                    onClick={() => setShowSidebar(false)}\r\n                    className=\"lg:hidden absolute top-6 right-6 size-10 rounded-full bg-white/5 flex items-center justify-center text-white border border-white/10\"\r\n                >\r\n                    <span className=\"material-symbols-outlined\">close</span>\r\n                </button>\r\n\r\n                {/* Desktop Toggle Button - Top Right */}\r\n                <button\r\n                    onClick={() => setIsSidebarCollapsed(!isSidebarCollapsed)}\r\n                    className=\"hidden lg:flex absolute top-4 -right-3 size-6 rounded-full bg-[#1e293b] border border-white/20 items-center justify-center text-slate-400 hover:text-white hover:border-[#22c55e] transition-all z-50 shadow-lg\"\r\n                >\r\n                    <span className=\"material-symbols-outlined text-xs\">\r\n                        {isSidebarCollapsed ? 'chevron_right' : 'chevron_left'}\r\n                    </span>\r\n                </button>\r\n\r\n                <div className=\"px-8 space-y-10 flex flex-col items-center lg:items-stretch w-full\">\r\n                    {/* Brand Logo */}\r\n                    <div className={`flex items-center ${isSidebarCollapsed ? 'justify-center w-full' : 'gap-4'} mb-0`}>\r\n                        <div className=\"size-10 lg:size-12 bg-[#0A0E12] border border-white/10 rounded-2xl flex items-center justify-center shadow-lg relative overflow-hidden group shrink-0\">\r\n                            <span className=\"material-symbols-outlined text-[#22c55e] text-xl lg:text-2xl font-black relative z-10\">rocket_launch</span>\r\n                        </div>\r\n                        {!isSidebarCollapsed && (\r\n                            <div className=\"animate-in fade-in duration-300\">\r\n                                <span className=\"hidden lg:block text-xl lg:text-2xl font-black tracking-tight uppercase text-slate-100 leading-none\">Gaadiwala</span>\r\n                                <p className=\"hidden lg:block text-[9px] lg:text-[11px] font-bold text-slate-400 uppercase tracking-wide leading-none mt-1\">\r\n                                    Your Daily Ride\r\n                                </p>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    <div className=\"flex flex-col gap-3 lg:gap-4 px-4 lg:px-0 w-full\">\r\n                        {!isSidebarCollapsed && (\r\n                            <p className=\"text-[10px] lg:text-[12px] font-bold uppercase text-slate-400 tracking-wider pl-2 animate-in fade-in\">\r\n                                Ride Type\r\n                            </p>\r\n                        )}\r\n                        <div className={`flex ${isSidebarCollapsed ? 'flex-col gap-2 bg-transparent border-none p-0' : 'bg-[#1e293b] p-1.5 rounded-[1.2rem] border border-white/5'} relative shadow-sm transition-all`}>\r\n                            <button\r\n                                onClick={() => setRideType('RESERVED')}\r\n                                className={`flex items-center justify-center py-2 lg:py-3 rounded-[0.9rem] font-bold uppercase tracking-wide transition-all ${rideType === 'RESERVED' ? 'bg-[#22c55e] text-black shadow-sm' : 'text-slate-400 hover:text-slate-200'} ${isSidebarCollapsed ? 'size-10 lg:size-12 rounded-2xl border border-white/10 !p-0 bg-[#1e293b]' : 'flex-1 text-[10px] lg:text-[11px]'}`}\r\n                                title=\"Personal Ride\"\r\n                            >\r\n                                {isSidebarCollapsed ? <span className=\"material-symbols-outlined text-lg\">person</span> : 'Personal'}\r\n                            </button>\r\n                            <button\r\n                                onClick={() => setRideType('SHARED')}\r\n                                className={`flex items-center justify-center py-2 lg:py-3 rounded-[0.9rem] font-bold uppercase tracking-wide transition-all ${rideType === 'SHARED' ? 'bg-[#22c55e] text-black shadow-sm' : 'text-slate-400 hover:text-slate-200'} ${isSidebarCollapsed ? 'size-10 lg:size-12 rounded-2xl border border-white/10 !p-0 bg-[#1e293b]' : 'flex-1 text-[10px] lg:text-[11px]'}`}\r\n                                title=\"Shared Ride\"\r\n                            >\r\n                                {isSidebarCollapsed ? <span className=\"material-symbols-outlined text-lg\">groups</span> : 'Shared'}\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"flex flex-col gap-3 lg:gap-4 px-4 lg:px-0 w-full mt-4\">\r\n                        {!isSidebarCollapsed && (\r\n                            <p className=\"text-[10px] lg:text-[12px] font-bold uppercase text-slate-400 tracking-wider pl-2 animate-in fade-in\">\r\n                                Passengers\r\n                            </p>\r\n                        )}\r\n                        <div className={`flex items-center justify-between ${isSidebarCollapsed ? 'flex-col gap-2 bg-transparent' : 'bg-[#1e293b] p-2 rounded-[1.2rem] border border-white/5'} transition-all`}>\r\n                            {!isSidebarCollapsed && (\r\n                                <div className=\"flex items-center gap-3 pl-2\">\r\n                                    <span className=\"material-symbols-outlined text-slate-400\">group</span>\r\n                                    <span className=\"text-white font-bold\">{passengerCount} Person{passengerCount > 1 ? 's' : ''}</span>\r\n                                </div>\r\n                            )}\r\n                            <div className={`flex items-center gap-1 ${isSidebarCollapsed ? 'flex-col' : ''}`}>\r\n                                <button\r\n                                    onClick={() => setPassengerCount(Math.max(1, passengerCount - 1))}\r\n                                    disabled={passengerCount <= 1}\r\n                                    className={`size-8 rounded-full flex items-center justify-center border transition-all ${passengerCount <= 1 ? 'border-white/5 text-slate-600' : 'border-white/20 text-white hover:bg-white/10'}`}\r\n                                >\r\n                                    <span className=\"material-symbols-outlined text-sm\">remove</span>\r\n                                </button>\r\n                                {isSidebarCollapsed && <span className=\"text-[10px] font-bold text-white my-1\">{passengerCount}</span>}\r\n                                <button\r\n                                    onClick={() => setPassengerCount(Math.min(4, passengerCount + 1))}\r\n                                    disabled={passengerCount >= 4}\r\n                                    className={`size-8 rounded-full flex items-center justify-center border transition-all ${passengerCount >= 4 ? 'border-white/5 text-slate-600' : 'border-white/20 text-white hover:bg-white/10'}`}\r\n                                >\r\n                                    <span className=\"material-symbols-outlined text-sm\">add</span>\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"space-y-4 pt-2 lg:pt-4 px-4 lg:px-0 w-full\">\r\n                        {!isSidebarCollapsed && <p className=\"text-[10px] lg:text-[12px] font-bold uppercase text-slate-400 tracking-wider pl-2 animate-in fade-in\">Select Vehicle</p>}\r\n                        <div className=\"grid grid-cols-1 gap-3\">\r\n                            {\r\n                                categories.map((item) => {\r\n                                    // Capacity Check\r\n                                    const capacityLimit = {\r\n                                        [VehicleCategory.BIKE]: 1,\r\n                                        [VehicleCategory.AUTO]: 3,\r\n                                        [VehicleCategory.MINI]: 4,\r\n                                        [VehicleCategory.PRIME]: 4,\r\n                                        [VehicleCategory.PINK]: 4\r\n                                    }[item.type] || 4;\r\n\r\n                                    const isCapacityInvalid = passengerCount > capacityLimit;\r\n\r\n                                    // Calculate based on 10km reference for comparison\r\n                                    const pricingSingle = calculateFare(10, 30, item.type, user, sysConfig, 1);\r\n                                    const basePrice10km = rideType === 'SHARED' ? Math.round(pricingSingle.total * 0.7) : pricingSingle.total;\r\n                                    const totalDisplayPrice = basePrice10km * passengerCount;\r\n\r\n                                    const discountLabel = pricingSingle.discounts.length > 0 ? pricingSingle.discounts[0].description : null;\r\n\r\n                                    const isRestricted = (item.type === VehicleCategory.PINK && user.gender !== 'FEMALE' && user.role !== 'ADMIN') || isCapacityInvalid;\r\n                                    const isActive = category === item.type;\r\n\r\n                                    // If capacity invalid, don't show unless sidebar is collapsed (to maintain layout), or show disabled\r\n\r\n                                    return (\r\n                                        <button\r\n                                            key={item.type}\r\n                                            disabled={isRestricted}\r\n                                            onClick={() => {\r\n                                                if (item.type === VehicleCategory.PINK && user.gender !== 'FEMALE' && user.role !== 'ADMIN') {\r\n                                                    setError(\"Pink Cab is reserved for Women riders only.\");\r\n                                                    return;\r\n                                                }\r\n                                                if (isCapacityInvalid) {\r\n                                                    setError(`This vehicle supports max ${capacityLimit} passengers.`);\r\n                                                    return;\r\n                                                }\r\n                                                setCategory(item.type);\r\n                                            }}\r\n                                            className={`flex items-center gap-3 lg:gap-4 p-2 rounded-[1.5rem] border transition-all duration-300 w-full ${isActive\r\n                                                ? (item.isPink ? 'border-pink-500 bg-pink-500/10' : 'border-[#22c55e] bg-[#22c55e]/10')\r\n                                                : 'border-transparent hover:bg-[#1e293b]'\r\n                                                } ${isRestricted ? 'opacity-30 grayscale' : ''} ${isSidebarCollapsed ? 'justify-center !p-0 !bg-transparent !border-none' : 'p-3 lg:p-4'}`}\r\n                                            title={`${item.label} - ${totalDisplayPrice}`}\r\n                                        >\r\n                                            {isActive && !isRestricted && !isSidebarCollapsed && (\r\n                                                <div className={`absolute top-0 right-0 p-1.5 rounded-bl-2xl ${item.isPink ? 'bg-pink-500' : 'bg-[#22c55e]'}`}>\r\n                                                    <span className=\"material-symbols-outlined text-[12px] text-black font-bold\">check</span>\r\n                                                </div>\r\n                                            )}\r\n                                            <div className={`size-10 lg:size-12 rounded-xl flex items-center justify-center transition-all duration-300 shrink-0 ${isActive && !isRestricted\r\n                                                ? (item.isPink ? 'bg-pink-500 text-white' : 'bg-[#22c55e] text-black')\r\n                                                : 'bg-[#1e293b] text-slate-400 group-hover:text-slate-200'\r\n                                                }`}>\r\n                                                <span className=\"material-symbols-outlined text-xl lg:text-2xl\">{item.icon}</span>\r\n                                            </div>\r\n\r\n                                            {!isSidebarCollapsed && (\r\n                                                <div className=\"flex-1 text-left min-w-0 animate-in fade-in slide-in-from-left-2\">\r\n                                                    <h4 className={`text-[12px] lg:text-[14px] font-bold tracking-wide uppercase mb-0.5 ${isActive ? 'text-white' : 'text-slate-300'}`}>{item.label}</h4>\r\n                                                    <div className=\"flex flex-col\">\r\n                                                        <div className=\"flex items-baseline gap-1\">\r\n                                                            <p className={`text-lg lg:text-xl font-bold tracking-tight leading-none ${isActive ? (item.isPink ? 'text-pink-400' : 'text-[#22c55e]') : 'text-slate-500'}`}>\r\n                                                                {totalDisplayPrice}\r\n                                                            </p>\r\n                                                            {passengerCount > 1 && (\r\n                                                                <p className=\"text-[9px] text-slate-500 font-bold\">\r\n                                                                    ({basePrice10km}  {passengerCount})\r\n                                                                </p>\r\n                                                            )}\r\n                                                        </div>\r\n                                                        {!routeForensics && <span className=\"text-[9px] text-slate-500 font-black uppercase tracking-widest mt-0.5\">/ 10KM RATE</span>}\r\n                                                    </div>\r\n                                                    {discountLabel && <span className=\"text-[9px] bg-[#22c55e]/20 text-[#22c55e] px-2 py-0.5 rounded-md font-bold uppercase\">Saved</span>}\r\n                                                </div>\r\n                                            )}\r\n                                        </button>\r\n                                    );\r\n                                })\r\n                            }\r\n                        </div>\r\n                    </div>\r\n\r\n\r\n\r\n                    {!isSidebarCollapsed && (\r\n                        <div className=\"space-y-4 pt-2 lg:pt-4 px-4 lg:px-0 animate-in fade-in\">\r\n                            <p className=\"text-[10px] lg:text-[12px] font-bold uppercase text-slate-400 tracking-wider pl-2\">Comfort Settings</p>\r\n                            <div className=\"flex gap-2 lg:gap-3\">\r\n                                {[\r\n                                    { id: 'silent', icon: 'volume_off', label: 'Silent' },\r\n                                    { id: 'ac', icon: 'ac_unit', label: 'AC' },\r\n                                    { id: 'music', icon: 'music_note', label: 'Music' }\r\n                                ].map(pref => (\r\n                                    <button\r\n                                        key={pref.id}\r\n                                        onClick={() => setPreferences({ ...preferences, [pref.id]: !preferences[pref.id as keyof RidePreferences] })}\r\n                                        className={`flex-1 p-3 lg:p-4 rounded-[1.2rem] border transition-all flex flex-col items-center gap-1 lg:gap-2 ${preferences[pref.id as keyof RidePreferences] ? 'border-[#22c55e] bg-[#22c55e]/10 text-[#22c55e]' : 'border-white/5 bg-[#1e293b] text-slate-400 hover:text-slate-200 hover:bg-[#283548]'}`}\r\n                                    >\r\n                                        <span className=\"material-symbols-outlined text-base lg:text-lg\">{pref.icon}</span>\r\n                                        <span className=\"text-[9px] lg:text-[10px] font-bold uppercase tracking-wide\">{pref.label}</span>\r\n                                    </button>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n\r\n                <div className=\"px-4 lg:px-8 mt-auto pt-4 lg:pt-10\">\r\n                    {/* Gold Member Section Removed */}\r\n                </div>\r\n            </aside>\r\n\r\n            <main className=\"flex-1 flex flex-col lg:flex-row-reverse relative h-full overflow-hidden\">\r\n                {/* 50% Map on Mobile */}\r\n                <div className=\"h-[45dvh] lg:h-full flex-1 relative overflow-hidden order-1 lg:order-2 border-b lg:border-none border-white/10\">\r\n                    <MapContainer\r\n                        pickup={pickupCoords}\r\n                        drop={dropCoords}\r\n                        drivers={nearbyDrivers.map(d => d.currentLocation).filter((l): l is Coordinates => !!l)}\r\n                    />\r\n                </div>\r\n\r\n                {/* 50% Panel on Mobile */}\r\n                <section className=\"w-full lg:max-w-[420px] bg-[#0A0E12] h-[55dvh] lg:h-full shadow-[0_-20px_50px_rgba(0,0,0,0.5)] lg:shadow-2xl z-40 flex flex-col p-4 lg:p-8 overflow-y-auto relative scrollbar-hide order-2 lg:order-1 border-r border-white/5\">\r\n                    <header className=\"flex flex-col gap-3 mb-4 lg:mb-8 shrink-0\">\r\n                        <div className=\"flex items-center justify-between\">\r\n                            <div className='flex flex-col'>\r\n                                <p className=\"text-[#22c55e] text-[9px] lg:text-[11px] font-bold uppercase tracking-widest mb-1 lg:mb-1.5 leading-none\">Your Journey</p>\r\n                                <h2 className=\"text-xl lg:text-3xl font-black tracking-tight uppercase leading-none text-white\">Plan <span className=\"text-[#22c55e]\">Ride</span></h2>\r\n                            </div>\r\n\r\n                            <button\r\n                                onClick={() => setIsScheduling(!isScheduling)}\r\n                                className={`px-3 py-1.5 lg:px-6 lg:py-2.5 rounded-lg lg:rounded-xl text-[7px] lg:text-[9px] font-black uppercase tracking-widest transition-all magnetic-btn flex items-center justify-center ${isScheduling ? 'bg-orange-500 text-white shadow-lg' : 'bg-white/10 text-slate-400 hover:bg-white/20'\r\n                                    }`}\r\n                            >\r\n                                <span className=\"material-symbols-outlined text-xs mr-1 lg:mr-2\">{isScheduling ? 'event_upcoming' : 'schedule'}</span>\r\n                                <span className=\"hidden sm:inline\">{isScheduling ? 'Schedule On' : 'Schedule For Later'}</span>\r\n                            </button>\r\n                        </div>\r\n\r\n                        {isScheduling && (\r\n                            <div className=\"animate-in slide-in-from-top-2 duration-300\">\r\n                                <label className=\"text-[9px] font-black uppercase text-slate-500 tracking-[0.2em] mb-2 block pl-1\">Pick Date & Time</label>\r\n                                <div className=\"bg-white/5 border border-white/10 rounded-xl p-2 flex items-center gap-2\">\r\n                                    <input\r\n                                        type=\"datetime-local\"\r\n                                        value={scheduleDate}\r\n                                        onChange={(e) => setScheduleDate(e.target.value)}\r\n                                        className=\"bg-transparent border-none text-white text-xs font-bold w-full outline-none p-2 rounded-lg focus:ring-1 focus:ring-orange-500/50\"\r\n                                        min={new Date().toISOString().slice(0, 16)}\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n                    </header>\r\n\r\n                    {/* Primary Features - Always visible on first sight */}\r\n                    {/* Primary Features - Always visible on first sight */}\r\n                    <div className=\"space-y-3 lg:space-y-5 shrink-0\">\r\n                        <div className=\"relative group\">\r\n                            <div className=\"flex items-center bg-white/5 rounded-xl lg:rounded-[1.5rem] border border-white/10 p-1 lg:p-1.5 focus-within:glow-green focus-within:border-[#22c55e]/50 transition-all relative overflow-hidden backdrop-blur-sm\">\r\n                                <div className=\"w-8 lg:w-10 flex justify-center text-[#22c55e]\">\r\n                                    <span className={`material-symbols-outlined text-sm lg:text-lg ${isLocating ? 'animate-spin' : ''}`}>\r\n                                        {isLocating ? 'sync' : 'radio_button_checked'}\r\n                                    </span>\r\n                                </div>\r\n                                {isLoaded ? (\r\n                                    <Autocomplete onLoad={onPickupLoad} onPlaceChanged={onPickupPlaceChanged} className=\"w-full\">\r\n                                        <input\r\n                                            className=\"w-full h-8 lg:h-10 bg-transparent border-none focus:ring-0 text-xs lg:text-sm font-black text-white placeholder:text-slate-500\"\r\n                                            value={pickup}\r\n                                            onChange={e => { setPickup(e.target.value); setPickupCoords(undefined); }}\r\n                                            placeholder=\"PICKUP LOCATION\"\r\n                                        />\r\n                                    </Autocomplete>\r\n                                ) : (\r\n                                    <input className=\"w-full h-8 lg:h-10 bg-transparent border-none px-4\" placeholder=\"...\" disabled />\r\n                                )}\r\n                                <button onClick={handleGetLocation} className=\"pr-2 lg:pr-3 text-slate-500 hover:text-[#22c55e] transition-colors magnetic-btn\">\r\n                                    <span className=\"material-symbols-outlined text-[14px] lg:text-[18px]\">my_location</span>\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"relative group\">\r\n                            <div className=\"flex items-center bg-white/5 rounded-xl lg:rounded-[1.5rem] border border-white/10 p-1 lg:p-1.5 focus-within:glow-green focus-within:border-[#22c55e]/50 transition-all relative overflow-hidden backdrop-blur-sm\">\r\n                                <div className=\"w-8 lg:w-10 flex justify-center text-orange-500\">\r\n                                    <span className=\"material-symbols-outlined text-sm lg:text-lg\">location_on</span>\r\n                                </div>\r\n                                {isLoaded ? (\r\n                                    <Autocomplete onLoad={onDropLoad} onPlaceChanged={onDropPlaceChanged} className=\"w-full\">\r\n                                        <div className=\"relative w-full flex items-center\">\r\n                                            <input\r\n                                                className=\"w-full h-8 lg:h-10 bg-transparent border-none focus:ring-0 text-xs lg:text-sm font-black text-white placeholder:text-slate-500 pr-6\" // Added padding-right\r\n                                                placeholder=\"DESTINATION\"\r\n                                                value={destination}\r\n                                                onChange={e => { setDestination(e.target.value); setDropCoords(undefined); }}\r\n                                            />\r\n                                            {destination && (\r\n                                                <button\r\n                                                    onClick={() => {\r\n                                                        setDestination('');\r\n                                                        setDropCoords(undefined);\r\n                                                        setRouteForensics(null);\r\n                                                        setRouteOptions([]);\r\n                                                    }}\r\n                                                    className=\"absolute right-0 p-1 text-slate-500 hover:text-white transition-colors\"\r\n                                                >\r\n                                                    <span className=\"material-symbols-outlined text-sm\">close</span>\r\n                                                </button>\r\n                                            )}\r\n                                        </div>\r\n                                    </Autocomplete>\r\n                                ) : (\r\n                                    <input className=\"w-full h-8 lg:h-10 bg-transparent border-none px-4\" placeholder=\"...\" disabled />\r\n                                )}\r\n                                <button onClick={handleSaveCurrent} disabled={!destination} className=\"pl-2 pr-2 lg:pr-3 text-slate-500 hover:text-orange-500 transition-colors disabled:opacity-30 magnetic-btn border-l border-white/10 ml-2\">\r\n                                    <span className=\"material-symbols-outlined text-[14px] lg:text-[18px]\">favorite</span>\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Saved Places Integration */}\r\n                        <div className=\"px-1\">\r\n                            <SavedPlaces\r\n                                user={user}\r\n                                onSelect={(loc) => {\r\n                                    setDestination(loc.address);\r\n                                    if (loc.coords) setDropCoords(loc.coords);\r\n                                    setError(null);\r\n                                }}\r\n                            />\r\n                        </div>\r\n\r\n                        {/* Contextual Recommendations - Removed as requested */}\r\n\r\n                        {/* Smart Recommendations - Based on current location */}\r\n                        {pickupCoords && !destination && (\r\n                            <div className=\"space-y-2 animate-in slide-in-from-bottom-2 duration-300\">\r\n                                <div className=\"flex items-center gap-2 px-1\">\r\n                                    <span className=\"material-symbols-outlined text-[#22c55e] text-xs\">explore</span>\r\n                                    <p className=\"text-[9px] font-black uppercase text-slate-500 tracking-wider\">Where are you heading?</p>\r\n                                </div>\r\n                                <div className=\"grid grid-cols-2 gap-2\">\r\n                                    {suggestions.length > 0 && suggestions.map((rec, i) => (\r\n                                        <button\r\n                                            key={i}\r\n                                            onClick={() => {\r\n                                                setDestination(rec.address);\r\n                                                if (rec.lat && rec.lng) {\r\n                                                    setDropCoords({ lat: rec.lat, lng: rec.lng });\r\n                                                }\r\n                                                setError(null);\r\n                                            }}\r\n                                            className=\"flex flex-col gap-2 p-3 bg-gradient-to-br from-[#22c55e]/10 to-transparent border border-[#22c55e]/20 rounded-xl hover:border-[#22c55e]/50 hover:bg-[#22c55e]/20 transition-all group\"\r\n                                        >\r\n                                            <div className=\"flex items-center gap-3\">\r\n                                                <div className=\"size-8 rounded-full bg-[#22c55e]/20 flex items-center justify-center text-[#22c55e] group-hover:scale-110 transition-transform\">\r\n                                                    <span className=\"material-symbols-outlined text-sm\">{rec.icon}</span>\r\n                                                </div>\r\n                                                <div className=\"text-left\">\r\n                                                    <p className=\"text-[10px] font-bold text-white uppercase tracking-wide\">{rec.label}</p>\r\n                                                    <p className=\"text-[8px] text-slate-400 truncate max-w-[120px]\">{rec.desc}</p>\r\n                                                </div>\r\n                                            </div>\r\n                                        </button>\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* Forensics - Compact on Mobile */}\r\n                        {(pickup || destination) && (\r\n                            <div className=\"animate-in slide-in-from-top-2 duration-500 p-3 lg:p-6 rounded-xl lg:rounded-[2rem] border border-white/10 shadow-xl bg-[#0F172A]/50 relative overflow-hidden group transition-all tracing-border\">\r\n                                <div className=\"relative flex justify-between items-center px-1\">\r\n                                    <div className=\"flex flex-col\">\r\n                                        <p className=\"text-[#22c55e] text-[6px] lg:text-[8px] font-black uppercase tracking-[0.2em] mb-0.5 italic\">Distance</p>\r\n                                        <p className=\"text-white text-xs lg:text-2xl font-black italic leading-none\">{routeForensics?.distance || '---'}</p>\r\n                                    </div>\r\n\r\n                                    {/* Estimated Price Center Display */}\r\n                                    {routeForensics && (\r\n                                        <div className=\"flex flex-col items-center\">\r\n                                            <p className=\"text-white/40 text-[6px] lg:text-[8px] font-black uppercase tracking-[0.2em] mb-0.5\">Price</p>\r\n                                            <div className=\"flex flex-col items-center\">\r\n                                                <div className=\"flex items-center gap-2\">\r\n                                                    <p className=\"text-[#22c55e] text-xs lg:text-2xl font-black italic leading-none\">\r\n                                                        {(() => {\r\n                                                            const pricingSingle = calculateFare(10, 30, category, user, sysConfig, 1);\r\n                                                            const basePrice10km = rideType === 'SHARED' ? Math.round(pricingSingle.total * 0.7) : pricingSingle.total;\r\n                                                            const actualDist = parseFloat(routeForensics.distance.split(' ')[0]);\r\n                                                            const perPerson = Math.round((basePrice10km / 10) * actualDist);\r\n                                                            return perPerson * passengerCount;\r\n                                                        })()}\r\n                                                    </p>\r\n                                                </div>\r\n                                                {passengerCount > 1 && (\r\n                                                    <p className=\"text-[8px] lg:text-[10px] text-white/40 font-bold uppercase mt-1\">\r\n                                                        {(() => {\r\n                                                            const pricingSingle = calculateFare(10, 30, category, user, sysConfig, 1);\r\n                                                            const basePrice10km = rideType === 'SHARED' ? Math.round(pricingSingle.total * 0.7) : pricingSingle.total;\r\n                                                            const actualDist = parseFloat(routeForensics.distance.split(' ')[0]);\r\n                                                            return Math.round((basePrice10km / 10) * actualDist);\r\n                                                        })()}  {passengerCount}\r\n                                                    </p>\r\n                                                )}\r\n                                            </div>\r\n                                        </div>\r\n                                    )}\r\n\r\n                                    <div className=\"flex flex-col items-end text-right\">\r\n                                        <p className=\"text-white/40 text-[6px] lg:text-[8px] font-black uppercase tracking-[0.2em] mb-0.5\">Est. Time</p>\r\n                                        <p className=\"text-[#22c55e] text-xs lg:text-2xl font-black italic leading-none\">{routeForensics?.duration || '---'}</p>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* Route Options - Show multiple routes with traffic & tolls */}\r\n                        {showRouteOptions && routeOptions.length > 1 && (\r\n                            <div className=\"space-y-2 animate-in slide-in-from-bottom-2 duration-300\">\r\n                                <div className=\"flex items-center justify-between px-1\">\r\n                                    <div className=\"flex items-center gap-2\">\r\n                                        <span className=\"material-symbols-outlined text-[#22c55e] text-xs\">route</span>\r\n                                        <p className=\"text-[9px] font-black uppercase text-slate-500 tracking-wider\">Choose your route</p>\r\n                                    </div>\r\n                                    <button\r\n                                        onClick={() => setShowRouteOptions(false)}\r\n                                        className=\"text-[8px] text-slate-500 hover:text-white transition-colors\"\r\n                                    >\r\n                                        Hide\r\n                                    </button>\r\n                                </div>\r\n                                <div className=\"space-y-2\">\r\n                                    {routeOptions.map((route, index) => (\r\n                                        <button\r\n                                            key={index}\r\n                                            onClick={() => {\r\n                                                setSelectedRoute(index);\r\n                                                setRouteForensics({\r\n                                                    distance: route.distance,\r\n                                                    duration: route.durationInTraffic || route.duration\r\n                                                });\r\n                                            }}\r\n                                            className={`w-full p-3 rounded-xl border transition-all ${selectedRoute === index\r\n                                                ? 'border-[#22c55e] bg-[#22c55e]/10'\r\n                                                : 'border-white/10 bg-white/5 hover:border-[#22c55e]/50'\r\n                                                }`}\r\n                                        >\r\n                                            <div className=\"flex items-center justify-between mb-2\">\r\n                                                <div className=\"flex items-center gap-2\">\r\n                                                    <span className=\"text-[10px] font-black text-white uppercase\">{route.summary}</span>\r\n                                                    {route.trafficInfo && route.trafficInfo.condition !== 'NORMAL' && (\r\n                                                        <span className={`text-[8px] px-1.5 py-0.5 rounded font-bold ${route.trafficInfo.condition === 'SEVERE' ? 'bg-red-500/20 text-red-400' :\r\n                                                            route.trafficInfo.condition === 'HEAVY' ? 'bg-orange-500/20 text-orange-400' :\r\n                                                                'bg-yellow-500/20 text-yellow-400'\r\n                                                            }`}>\r\n                                                            {route.trafficInfo.condition}\r\n                                                        </span>\r\n                                                    )}\r\n                                                    {route.tollInfo?.hasTolls && (\r\n                                                        <span className=\"text-[8px] px-1.5 py-0.5 rounded bg-blue-500/20 text-blue-400 font-bold\">\r\n                                                            TOLL\r\n                                                        </span>\r\n                                                    )}\r\n                                                </div>\r\n                                                {selectedRoute === index && (\r\n                                                    <span className=\"material-symbols-outlined text-[#22c55e] text-sm\">check_circle</span>\r\n                                                )}\r\n                                            </div>\r\n                                            <div className=\"flex items-center justify-between text-left\">\r\n                                                <div>\r\n                                                    <p className=\"text-[8px] text-slate-500 uppercase\">Distance</p>\r\n                                                    <p className=\"text-[10px] font-bold text-white\">{route.distance}</p>\r\n                                                </div>\r\n                                                <div className=\"text-right\">\r\n                                                    <p className=\"text-[8px] text-slate-500 uppercase\">Time</p>\r\n                                                    <p className=\"text-[10px] font-bold text-[#22c55e]\">\r\n                                                        {route.durationInTraffic || route.duration}\r\n                                                        {route.trafficInfo && route.trafficInfo.delayMinutes > 0 && (\r\n                                                            <span className=\"text-[8px] text-orange-400 ml-1\">\r\n                                                                +{route.trafficInfo.delayMinutes}m\r\n                                                            </span>\r\n                                                        )}\r\n                                                    </p>\r\n                                                </div>\r\n                                                {route.tollInfo?.hasTolls && route.tollInfo.estimatedCost && route.tollInfo.estimatedCost > 0 && (\r\n                                                    <div className=\"text-right\">\r\n                                                        <p className=\"text-[8px] text-slate-500 uppercase\">Toll</p>\r\n                                                        <p className=\"text-[10px] font-bold text-blue-400\">{route.tollInfo.estimatedCost}</p>\r\n                                                    </div>\r\n                                                )}\r\n                                            </div>\r\n                                        </button>\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n\r\n\r\n                        {/* Booking Button - POSITIONED FOR FIRST SIGHT */}\r\n                        <div className=\"pt-2 lg:pt-4\">\r\n                            <button\r\n                                onClick={handleConfirm}\r\n                                disabled={isGeocoding}\r\n                                className={`w-full h-12 lg:h-16 rounded-xl lg:rounded-[2rem] font-black text-[9px] lg:text-[11px] uppercase tracking-[0.2em] lg:tracking-[0.3em] transition-all flex items-center justify-center gap-3 lg:gap-4 shadow-xl active:scale-95 magnetic-btn relative overflow-hidden group ${isGeocoding ? 'bg-slate-800 text-slate-500' : 'bg-[#22c55e] text-black hover:scale-[1.03] shadow-[0_0_30px_rgba(34,197,94,0.2)]'}`}\r\n                            >\r\n                                <span className=\"relative z-10 italic\">{isGeocoding ? 'Calculating Route...' : 'Book Instant Ride'}</span>\r\n                                {!isGeocoding && <span className=\"material-symbols-outlined font-black text-base lg:text-xl relative z-10\">bolt</span>}\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Secondary Content - Below Fold / Minimal */}\r\n                    <div className=\"mt-8 space-y-8 lg:space-y-12 pb-8\">\r\n                        {/* Recent / Saved - Hidden or minimal on mobile */}\r\n                        {user.savedLocations.length > 0 && (\r\n                            <div className=\"hidden lg:block space-y-4\">\r\n                                <p className=\"text-[8px] lg:text-[10px] font-black uppercase text-slate-500 tracking-widest pl-2 italic\">Saved Places</p>\r\n                                <div className=\"grid grid-cols-1 gap-2\">\r\n                                    {user.savedLocations.map(loc => (\r\n                                        <button key={loc.id} onClick={() => setDestination(loc.address)} className=\"flex items-center gap-4 p-4 rounded-[1.5rem] border border-white/5 hover:border-[#22c55e]/20 bg-white/5 shadow-sm transition-all group\">\r\n                                            <div className=\"size-10 rounded-xl bg-white/5 flex items-center justify-center text-slate-500 group-hover:text-[#22c55e]\">\r\n                                                <span className=\"material-symbols-outlined text-lg\">favorite</span>\r\n                                            </div>\r\n                                            <span className=\"text-[9px] lg:text-[11px] font-black uppercase italic tracking-tighter text-slate-300\">{loc.label}</span>\r\n                                        </button>\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* Fleet Directory - Semi-collapsed on mobile */}\r\n                        <div className=\"space-y-4\">\r\n                            <div className=\"flex items-center justify-between px-2\">\r\n                                <p className=\"text-[7px] lg:text-[9px] font-black uppercase text-slate-500 tracking-widest italic\">Available Drivers</p>\r\n                                <div className=\"flex items-center gap-1\">\r\n                                    <span className=\"size-1.5 bg-[#22c55e] rounded-full animate-pulse\"></span>\r\n                                    <span className=\"text-[8px] font-bold text-slate-400 uppercase tracking-tighter\">{nearbyDrivers.filter((d: any) => d.isOnline).length} Online</span>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {nearbyDrivers.length > 0 ? (\r\n                                <div className=\"space-y-2 max-h-60 overflow-y-auto scrollbar-hide\">\r\n                                    {nearbyDrivers.map((driver: any) => {\r\n                                        const vType = categories.find(c => c.type === driver.vehicleType) || categories[2];\r\n                                        return (\r\n                                            <div key={driver.id} className=\"flex items-center gap-3 p-3 rounded-xl border border-white/5 bg-white/5 shadow-sm transition-all\">\r\n                                                <div className=\"size-12 rounded-xl bg-slate-800 overflow-hidden border border-white/10\">\r\n                                                    <img src={driver.avatar || `https://api.dicebear.com/7.x/avataaars/svg?seed=${driver.id}`} alt={driver.name} className=\"size-full object-cover\" />\r\n                                                </div>\r\n                                                <div className=\"flex-1 min-w-0\">\r\n                                                    <div className=\"flex items-center gap-2 mb-1\">\r\n                                                        <h4 className=\"text-[11px] font-black text-white truncate uppercase tracking-tight\">{driver.name || 'Driver'}</h4>\r\n                                                        {driver.isApproved && <span className=\"material-symbols-outlined text-[#22c55e] text-[12px] filled\">verified</span>}\r\n                                                    </div>\r\n                                                    <div className=\"flex items-center gap-2\">\r\n                                                        <div className=\"flex items-center gap-1 px-1.5 py-0.5 bg-amber-50/10 rounded-lg border border-amber-500/20\">\r\n                                                            <span className=\"material-symbols-outlined text-amber-400 text-[10px] filled\">star</span>\r\n                                                            <span className=\"text-[9px] font-bold text-amber-400\">{driver.rating || '4.9'}</span>\r\n                                                        </div>\r\n                                                        <span className=\"text-slate-500\"></span>\r\n                                                        <span className=\"text-[9px] font-bold text-slate-400 uppercase\">{driver.vehicleNumber || 'Vehicle'}</span>\r\n                                                    </div>\r\n                                                </div>\r\n                                                <div className=\"text-right\">\r\n                                                    <span className={`text-[8px] font-bold px-2 py-1 rounded-lg border uppercase ${driver.isOnline ? 'bg-[#22c55e]/10 text-[#22c55e] border-[#22c55e]/20' : 'bg-slate-500/10 text-slate-400 border-slate-500/20'}`}>\r\n                                                        {driver.isOnline ? 'Online' : 'Offline'}\r\n                                                    </span>\r\n                                                </div>\r\n                                            </div>\r\n                                        );\r\n                                    })}\r\n                                </div>\r\n                            ) : (\r\n                                <div className=\"flex flex-col items-center justify-center py-8 px-6 bg-white/5 rounded-xl border border-white/10\">\r\n                                    <div className=\"size-12 rounded-full bg-slate-500/20 flex items-center justify-center mb-3\">\r\n                                        <span className=\"material-symbols-outlined text-2xl text-slate-500\">person_off</span>\r\n                                    </div>\r\n                                    <p className=\"text-[10px] font-bold text-slate-400 mb-1 uppercase text-center\">No partners online</p>\r\n                                    <p className=\"text-[8px] text-slate-500 text-center\">Check console for debug info</p>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n\r\n                        {/* Moved District Picker & Tiffin Selector BELOW Fleet */}\r\n                        <div className=\"opacity-90 hover:opacity-100 transition-opacity border-t border-white/5 pt-6\">\r\n                            <DistrictPicker />\r\n                            <div className=\"mt-6\"></div>\r\n                            <TiffinSelector />\r\n                        </div>\r\n                    </div>\r\n                </section>\r\n            </main>\r\n        </div >\r\n    );\r\n};\r\n\r\nexport default RiderHome;\r\n",
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\screens\\rider\\RiderProfile.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\screens\\rider\\TiffinMarketplace.tsx",
        "messages": [
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'useEffect' is defined but never used.",
                "line": 1,
                "column": 27,
                "nodeType": "Identifier",
                "messageId": "unusedVar",
                "endLine": 1,
                "endColumn": 36
            },
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'db' is defined but never used.",
                "line": 3,
                "column": 10,
                "nodeType": "Identifier",
                "messageId": "unusedVar",
                "endLine": 3,
                "endColumn": 12
            },
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'collection' is defined but never used.",
                "line": 4,
                "column": 10,
                "nodeType": "Identifier",
                "messageId": "unusedVar",
                "endLine": 4,
                "endColumn": 20
            },
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'onSnapshot' is defined but never used.",
                "line": 4,
                "column": 22,
                "nodeType": "Identifier",
                "messageId": "unusedVar",
                "endLine": 4,
                "endColumn": 32
            },
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'query' is defined but never used.",
                "line": 4,
                "column": 34,
                "nodeType": "Identifier",
                "messageId": "unusedVar",
                "endLine": 4,
                "endColumn": 39
            }
        ],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 5,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "source": "import React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { db } from '../../firebase';\r\nimport { collection, onSnapshot, query } from 'firebase/firestore';\r\nimport { TiffinVendor, User } from '../../types';\r\n\r\ninterface Props {\r\n    user: User;\r\n}\r\n\r\nconst MOCK_VENDORS: TiffinVendor[] = [\r\n    {\r\n        id: 'v1',\r\n        name: 'Gopal Tiffins',\r\n        description: 'Traditional home-cooked Maharaja thalis with fresh parathas.',\r\n        rating: 4.8,\r\n        image: 'https://images.unsplash.com/photo-1546069901-ba9599a7e63c',\r\n        location: { lat: 27.4924, lng: 77.6737 },\r\n        pureVeg: true,\r\n        basePrice: 120,\r\n        menus: [\r\n            { id: 'm1', day: 'Monday', items: ['Dal Makhani', 'Paneer Butter Masala', '4 Paratha', 'Rice'] },\r\n            { id: 'm2', day: 'Tuesday', items: ['Mix Veg', 'Rajma', '4 Roti', 'Rice'] }\r\n        ],\r\n        plans: [\r\n            { id: 'p1', name: 'Daily', duration: 'DAILY', price: 120 },\r\n            { id: 'p2', name: 'Weekly Pass', duration: 'WEEKLY', price: 750 },\r\n            { id: 'p3', name: 'Monthly Sub', duration: 'MONTHLY', price: 2800 }\r\n        ]\r\n    },\r\n    {\r\n        id: 'v2',\r\n        name: 'Maa ki Rasoi',\r\n        description: 'Healthy and simple meals just like home. Low oil and spices.',\r\n        rating: 4.9,\r\n        image: 'https://images.unsplash.com/photo-1589302168068-964664d93dc0',\r\n        location: { lat: 27.4950, lng: 77.6750 },\r\n        pureVeg: true,\r\n        basePrice: 80,\r\n        menus: [\r\n            { id: 'm3', day: 'Monday', items: ['Yellow Dal', 'Aloo Gobi', '4 Roti', 'Salad'] }\r\n        ],\r\n        plans: [\r\n            { id: 'p4', name: 'Standard', duration: 'DAILY', price: 80 },\r\n            { id: 'p5', name: 'Student Plan', duration: 'WEEKLY', price: 500 }\r\n        ]\r\n    }\r\n];\r\n\r\nconst TiffinMarketplace: React.FC<Props> = ({ user }) => {\r\n    const navigate = useNavigate();\r\n    const [vendors] = useState<TiffinVendor[]>(MOCK_VENDORS);\r\n    const [selectedVendor, setSelectedVendor] = useState<TiffinVendor | null>(null);\r\n    const [activePlan, setActivePlan] = useState<string | null>(null);\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-[#0F172A] font-sans pb-20 text-slate-200\">\r\n            <header className=\"bg-[#0A0E12] border-b border-white/5 px-6 py-8 sticky top-0 z-40 shadow-xl\">\r\n                <div className=\"max-w-4xl mx-auto flex items-center justify-between\">\r\n                    <div className=\"flex items-center gap-6\">\r\n                        <button onClick={() => navigate(-1)} className=\"size-12 rounded-2xl bg-white/5 flex items-center justify-center text-white hover:bg-white/10 transition-all border border-white/5\">\r\n                            <span className=\"material-symbols-outlined font-black\">arrow_back</span>\r\n                        </button>\r\n                        <div>\r\n                            <p className=\"text-orange-500 text-[10px] font-black uppercase tracking-[0.2em] mb-1 leading-none italic\">Culinary Network</p>\r\n                            <h1 className=\"text-3xl font-black tracking-tighter italic uppercase leading-none text-white\">Tiffin <span className=\"not-italic text-slate-400\">Hub</span></h1>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"flex gap-2\">\r\n                        <span className=\"px-4 py-2 bg-[#22c55e]/10 text-[#22c55e] rounded-xl text-[10px] font-black uppercase border border-[#22c55e]/20 tracking-widest italic animate-pulse\">Live Tracking Active</span>\r\n                    </div>\r\n                </div>\r\n            </header>\r\n\r\n            <main className=\"max-w-4xl mx-auto px-6 py-12 space-y-12\">\r\n                {/* Search & Categories */}\r\n                {/* Search & Categories */}\r\n                <div className=\"flex gap-3 overflow-x-auto pb-4 scrollbar-hide px-1\">\r\n                    {['All Canteens', 'Pure Veg', 'North Indian', 'Healthy', 'Budget'].map((cat, i) => (\r\n                        <button key={cat} className={`px-6 py-3 rounded-2xl whitespace-nowrap text-[10px] font-black uppercase tracking-widest transition-all ${i === 0 ? 'bg-orange-500 text-black shadow-lg shadow-orange-500/20' : 'bg-white/5 text-slate-400 border border-white/5 hover:border-white/20 hover:text-white'}`}>\r\n                            {cat}\r\n                        </button>\r\n                    ))}\r\n                </div>\r\n\r\n                {/* Vendor Grid */}\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-10\">\r\n                    {vendors.map(vendor => (\r\n                        <div\r\n                            key={vendor.id}\r\n                            onClick={() => setSelectedVendor(vendor)}\r\n                            className=\"bg-[#1e293b] rounded-[3rem] overflow-hidden border border-white/5 shadow-2xl group cursor-pointer hover:scale-[1.02] transition-all relative\"\r\n                        >\r\n                            <div className=\"h-56 relative overflow-hidden\">\r\n                                <img src={vendor.image} className=\"w-full h-full object-cover group-hover:scale-110 transition-transform duration-1000 opacity-80 group-hover:opacity-100\" alt={vendor.name} />\r\n                                <div className=\"absolute inset-0 bg-gradient-to-t from-[#0F172A] via-[#0F172A]/20 to-transparent\"></div>\r\n                                <div className=\"absolute top-6 left-6 px-4 py-1.5 bg-black/40 backdrop-blur-md rounded-full text-[9px] font-black text-white uppercase tracking-[0.2em] border border-white/10\">\r\n                                    {vendor.pureVeg ? 'Verified Pure Veg' : 'Multi-Kitchen'}\r\n                                </div>\r\n                                <div className=\"absolute bottom-6 left-8 right-8 flex items-end justify-between\">\r\n                                    <div>\r\n                                        <h3 className=\"text-2xl font-black text-white tracking-tight uppercase italic leading-none mb-1\">{vendor.name}</h3>\r\n                                        <p className=\"text-[9px] font-black text-orange-500 uppercase tracking-widest\">Master Chef Rated</p>\r\n                                    </div>\r\n                                    <div className=\"flex items-center gap-1.5 bg-orange-500 px-3 py-1.5 rounded-xl text-black text-[11px] font-black shadow-lg shadow-orange-500/30\">\r\n                                        <span>{vendor.rating}</span>\r\n                                        <span className=\"material-symbols-outlined text-[14px] filled\">star</span>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"p-8\">\r\n                                <p className=\"text-sm text-slate-400 font-medium leading-relaxed mb-8 line-clamp-2 italic\">\"{vendor.description}\"</p>\r\n                                <div className=\"flex items-center justify-between pt-6 border-t border-white/5\">\r\n                                    <div className=\"flex flex-col\">\r\n                                        <span className=\"text-[9px] font-black uppercase text-slate-500 tracking-widest leading-none mb-1\">Entry Price</span>\r\n                                        <span className=\"text-2xl font-black text-white italic leading-none\">{vendor.basePrice}</span>\r\n                                    </div>\r\n                                    <button className=\"px-8 py-3 bg-white/10 text-white rounded-[1.5rem] text-[10px] font-black uppercase tracking-widest hover:bg-white/20 transition-all shadow-lg italic border border-white/5\">Explore Menu</button>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            </main>\r\n\r\n            {/* Vendor Detail Modal */}\r\n            {selectedVendor && (\r\n                <div className=\"fixed inset-0 z-[100] bg-black/80 backdrop-blur-md flex items-center justify-center p-4 md:p-6\" onClick={() => setSelectedVendor(null)}>\r\n                    <div className=\"max-w-2xl w-full bg-[#1e293b] rounded-[3rem] overflow-hidden shadow-2xl animate-in zoom-in-95 duration-300 border border-white/10\" onClick={e => e.stopPropagation()}>\r\n                        <div className=\"h-72 relative\">\r\n                            <img src={selectedVendor.image} className=\"w-full h-full object-cover\" alt=\"vendor\" />\r\n                            <div className=\"absolute inset-0 bg-gradient-to-t from-[#1e293b] via-transparent to-transparent\"></div>\r\n                            <button onClick={() => setSelectedVendor(null)} className=\"absolute top-8 right-8 size-12 rounded-full bg-black/40 text-white flex items-center justify-center hover:bg-black/60 backdrop-blur-md transition-all border border-white/20 shadow-xl\">\r\n                                <span className=\"material-symbols-outlined font-black\">close</span>\r\n                            </button>\r\n                            <div className=\"absolute bottom-6 left-10\">\r\n                                <span className=\"px-4 py-2 bg-orange-500 text-black rounded-xl text-[9px] font-black uppercase tracking-[0.2em] italic border border-orange-500/20 shadow-lg\">Official Partner</span>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"px-10 pb-12 pt-4 space-y-10 max-h-[60vh] overflow-y-auto scrollbar-hide\">\r\n                            <div className=\"flex justify-between items-start\">\r\n                                <div>\r\n                                    <h2 className=\"text-4xl font-black tracking-tighter uppercase italic text-white\">{selectedVendor.name}</h2>\r\n                                    <p className=\"text-slate-400 font-bold text-sm tracking-tight mt-1\">{selectedVendor.description}</p>\r\n                                </div>\r\n                                <div className=\"text-right\">\r\n                                    <div className=\"flex items-center justify-end gap-2 text-orange-500 mb-1\">\r\n                                        <span className=\"text-2xl font-black italic\">{selectedVendor.rating}</span>\r\n                                        <span className=\"material-symbols-outlined filled text-xl\">star</span>\r\n                                    </div>\r\n                                    <p className=\"text-[9px] font-black uppercase text-slate-500 tracking-widest\">Performance</p>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"space-y-4 bg-[#0F172A] p-6 rounded-[2.5rem] border border-white/5\">\r\n                                <h4 className=\"text-[10px] font-black uppercase text-slate-500 tracking-[0.2em] mb-4 pl-2\">Signature Platter</h4>\r\n                                <div className=\"flex flex-wrap gap-2\">\r\n                                    {selectedVendor.menus[0].items.map((item, i) => (\r\n                                        <span key={i} className=\"px-5 py-2 bg-white/5 rounded-2xl text-[10px] font-black text-slate-300 border border-white/5 uppercase tracking-tighter shadow-sm\">{item}</span>\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"space-y-6\">\r\n                                <h4 className=\"text-[10px] font-black uppercase text-slate-500 tracking-[0.2em] pl-2 italic\">Select Subscription Tier</h4>\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                                    {selectedVendor.plans.map(plan => (\r\n                                        <button\r\n                                            key={plan.id}\r\n                                            onClick={() => setActivePlan(plan.id)}\r\n                                            className={`p-6 rounded-[2rem] border-2 transition-all flex flex-col items-center gap-2 group ${activePlan === plan.id\r\n                                                ? 'border-orange-500 bg-orange-500/10 shadow-xl shadow-orange-500/10 text-orange-500'\r\n                                                : 'border-white/5 hover:border-white/10 bg-white/5 text-slate-400 hover:text-white'}`}\r\n                                        >\r\n                                            <span className=\"text-[9px] font-black uppercase text-inherit tracking-widest\">{plan.name}</span>\r\n                                            <span className=\"text-2xl font-black italic\">{plan.price}</span>\r\n                                        </button>\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n\r\n                            <button\r\n                                disabled={!activePlan}\r\n                                className=\"w-full h-18 bg-[#22c55e] text-black rounded-[2.5rem] font-black text-xs uppercase tracking-[0.3em] shadow-2xl hover:scale-[1.02] active:scale-[0.98] transition-all disabled:bg-[#1e293b] disabled:text-slate-500 disabled:border disabled:border-white/5 mt-6 h-16 flex items-center justify-center gap-4 italic\"\r\n                            >\r\n                                {activePlan ? (<>Confirm Subscription <span className=\"material-symbols-outlined font-black\">arrow_forward</span></>) : 'Select A Plan'}\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default TiffinMarketplace;\r\n",
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\screens\\rider\\TripSummary.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\screens\\rider\\Wallet.tsx",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\services\\LocationService.ts",
        "messages": [
            {
                "ruleId": "@typescript-eslint/no-unused-vars",
                "severity": 1,
                "message": "'addressComplete' is assigned a value but never used.",
                "line": 70,
                "column": 15,
                "nodeType": "Identifier",
                "messageId": "unusedVar",
                "endLine": 70,
                "endColumn": 30
            }
        ],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 1,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "source": "/**\r\n * Address Validation Service\r\n * validAddress: Wrapper for Google Maps Address Validation API\r\n * Ensures addresses are deliverable and formatted correctly before saving.\r\n */\r\n\r\nimport { Coordinates } from '../types';\r\n\r\nexport interface ValidationResult {\r\n    isValid: boolean;\r\n    formattedAddress: string;\r\n    coordinates?: Coordinates;\r\n    components?: {\r\n        streetNumber?: string;\r\n        route?: string;\r\n        locality?: string;\r\n        administrativeAreaLevel1?: string;\r\n        postalCode?: string;\r\n        country?: string;\r\n    };\r\n    verdict?: {\r\n        inputGranularity?: string;\r\n        validationGranularity?: string;\r\n        geocodeGranularity?: string;\r\n        addressComplete?: boolean;\r\n        hasUnconfirmedComponents?: boolean;\r\n    };\r\n}\r\n\r\n/**\r\n * Validates an address using Google Address Validation API\r\n */\r\nexport const validateAddress = async (\r\n    address: string,\r\n    apiKey: string\r\n): Promise<ValidationResult> => {\r\n    try {\r\n        const url = `https://addressvalidation.googleapis.com/v1:validateAddress?key=${apiKey}`;\r\n\r\n        const requestBody = {\r\n            address: {\r\n                regionCode: 'IN', // Default to India\r\n                addressLines: [address]\r\n            },\r\n            enableUspsCass: false\r\n        };\r\n\r\n        const response = await fetch(url, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n            },\r\n            body: JSON.stringify(requestBody)\r\n        });\r\n\r\n        if (!response.ok) {\r\n            console.warn('Address Validation API non-OK response', response.status);\r\n            // Fallback to basic geocoding if validation fails/not enabled\r\n            return {\r\n                isValid: true, // Optimistic fallback\r\n                formattedAddress: address\r\n            };\r\n        }\r\n\r\n        const data = await response.json();\r\n\r\n        // Parse validation result\r\n        const result = data.result;\r\n        const verdict = result.verdict;\r\n        const addressComplete = verdict?.addressComplete || false;\r\n\r\n        // Extract components\r\n        const components: any = {};\r\n        result.address.addressComponents.forEach((comp: any) => {\r\n            if (comp.componentType === 'street_number') components.streetNumber = comp.componentName.text;\r\n            if (comp.componentType === 'route') components.route = comp.componentName.text;\r\n            if (comp.componentType === 'locality') components.locality = comp.componentName.text;\r\n            if (comp.componentType === 'administrative_area_level_1') components.administrativeAreaLevel1 = comp.componentName.text;\r\n            if (comp.componentType === 'postal_code') components.postalCode = comp.componentName.text;\r\n            if (comp.componentType === 'country') components.country = comp.componentName.text;\r\n        });\r\n\r\n        // Extract coordinates if available\r\n        const location = result.geocode?.location;\r\n        const coordinates = location ? {\r\n            lat: location.latitude,\r\n            lng: location.longitude\r\n        } : undefined;\r\n\r\n        return {\r\n            isValid: true, // We treat even partial matches as valid but flag them if needed\r\n            formattedAddress: result.address.formattedAddress || address,\r\n            coordinates,\r\n            components,\r\n            verdict: {\r\n                inputGranularity: verdict?.inputGranularity,\r\n                validationGranularity: verdict?.validationGranularity,\r\n                geocodeGranularity: verdict?.geocodeGranularity,\r\n                addressComplete: verdict?.addressComplete,\r\n                hasUnconfirmedComponents: verdict?.hasUnconfirmedComponents\r\n            }\r\n        };\r\n\r\n    } catch (error) {\r\n        console.error('Address Validation Error:', error);\r\n        // Fallback\r\n        return {\r\n            isValid: true,\r\n            formattedAddress: address\r\n        };\r\n    }\r\n};\r\n",
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\services\\PlacesService.ts",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\services\\RoadsService.ts",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\services\\RouteOptimizationService.ts",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\services\\RoutesService.ts",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\services\\api\\payment.ts",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\services\\api\\rides.ts",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\services\\api\\users.ts",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\services\\pricing.test.ts",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\services\\pricing.ts",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\setupTests.ts",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\types.ts",
        "messages": [],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    },
    {
        "filePath": "F:\\Projects\\CARIO\\gaadiwala\\src\\utils\\GeolocationHelper.ts",
        "messages": [
            {
                "ruleId": "no-throw-literal",
                "severity": 1,
                "message": "Expected an error object to be thrown.",
                "line": 82,
                "column": 9,
                "nodeType": "ThrowStatement",
                "messageId": "object",
                "endLine": 86,
                "endColumn": 31
            }
        ],
        "suppressedMessages": [],
        "errorCount": 0,
        "fatalErrorCount": 0,
        "warningCount": 1,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "source": "/**\r\n * Centralized Geolocation Helper\r\n * Provides consistent geolocation handling across the application\r\n */\r\n\r\nimport { Coordinates } from '../types';\r\n\r\nexport enum GeolocationErrorType {\r\n    PERMISSION_DENIED = 'PERMISSION_DENIED',\r\n    POSITION_UNAVAILABLE = 'POSITION_UNAVAILABLE',\r\n    TIMEOUT = 'TIMEOUT',\r\n    NOT_SUPPORTED = 'NOT_SUPPORTED',\r\n    UNKNOWN = 'UNKNOWN'\r\n}\r\n\r\nexport interface GeolocationError {\r\n    type: GeolocationErrorType;\r\n    message: string;\r\n    userMessage: string;\r\n}\r\n\r\nexport interface GeolocationOptions {\r\n    timeout?: number;\r\n    maximumAge?: number;\r\n    enableHighAccuracy?: boolean;\r\n    retries?: number;\r\n}\r\n\r\nconst DEFAULT_OPTIONS: Required<GeolocationOptions> = {\r\n    timeout: 10000,\r\n    maximumAge: 5000,\r\n    enableHighAccuracy: true,\r\n    retries: 2\r\n};\r\n\r\n/**\r\n * Maps browser geolocation error codes to user-friendly messages\r\n */\r\nconst mapGeolocationError = (error: GeolocationPositionError): GeolocationError => {\r\n    switch (error.code) {\r\n        case error.PERMISSION_DENIED:\r\n            return {\r\n                type: GeolocationErrorType.PERMISSION_DENIED,\r\n                message: 'User denied location permission',\r\n                userMessage: 'Location access was denied. Please enable location permissions in your browser settings to use this feature, or enter your address manually.'\r\n            };\r\n        case error.POSITION_UNAVAILABLE:\r\n            return {\r\n                type: GeolocationErrorType.POSITION_UNAVAILABLE,\r\n                message: 'Location information unavailable',\r\n                userMessage: 'Unable to determine your location. Please check your device settings or enter your address manually.'\r\n            };\r\n        case error.TIMEOUT:\r\n            return {\r\n                type: GeolocationErrorType.TIMEOUT,\r\n                message: 'Location request timed out',\r\n                userMessage: 'Location request timed out. Please try again or enter your address manually.'\r\n            };\r\n        default:\r\n            return {\r\n                type: GeolocationErrorType.UNKNOWN,\r\n                message: error.message || 'Unknown geolocation error',\r\n                userMessage: 'Unable to get your location. Please enter your address manually.'\r\n            };\r\n    }\r\n};\r\n\r\n/**\r\n * Checks if geolocation is supported by the browser\r\n */\r\nexport const isGeolocationSupported = (): boolean => {\r\n    return 'geolocation' in navigator;\r\n};\r\n\r\n/**\r\n * Requests current position with retry logic\r\n */\r\nexport const getCurrentPosition = async (\r\n    options: GeolocationOptions = {}\r\n): Promise<Coordinates> => {\r\n    if (!isGeolocationSupported()) {\r\n        throw {\r\n            type: GeolocationErrorType.NOT_SUPPORTED,\r\n            message: 'Geolocation not supported',\r\n            userMessage: 'Your browser does not support location services. Please enter your address manually.'\r\n        } as GeolocationError;\r\n    }\r\n\r\n    const opts = { ...DEFAULT_OPTIONS, ...options };\r\n    let lastError: GeolocationError | null = null;\r\n\r\n    for (let attempt = 0; attempt <= opts.retries; attempt++) {\r\n        try {\r\n            const position = await new Promise<GeolocationPosition>((resolve, reject) => {\r\n                navigator.geolocation.getCurrentPosition(\r\n                    resolve,\r\n                    reject,\r\n                    {\r\n                        timeout: opts.timeout,\r\n                        maximumAge: opts.maximumAge,\r\n                        enableHighAccuracy: opts.enableHighAccuracy\r\n                    }\r\n                );\r\n            });\r\n\r\n            return {\r\n                lat: position.coords.latitude,\r\n                lng: position.coords.longitude\r\n            };\r\n        } catch (error) {\r\n            lastError = mapGeolocationError(error as GeolocationPositionError);\r\n\r\n            // Don't retry on permission denied\r\n            if (lastError.type === GeolocationErrorType.PERMISSION_DENIED) {\r\n                break;\r\n            }\r\n\r\n            // Wait before retry (exponential backoff)\r\n            if (attempt < opts.retries) {\r\n                await new Promise(resolve => setTimeout(resolve, 1000 * (attempt + 1)));\r\n            }\r\n        }\r\n    }\r\n\r\n    throw lastError;\r\n};\r\n\r\n/**\r\n * Watches position changes with error handling\r\n */\r\nexport const watchPosition = (\r\n    onSuccess: (coords: Coordinates) => void,\r\n    onError: (error: GeolocationError) => void,\r\n    options: GeolocationOptions = {}\r\n): number | null => {\r\n    if (!isGeolocationSupported()) {\r\n        onError({\r\n            type: GeolocationErrorType.NOT_SUPPORTED,\r\n            message: 'Geolocation not supported',\r\n            userMessage: 'Your browser does not support location services.'\r\n        });\r\n        return null;\r\n    }\r\n\r\n    const opts = { ...DEFAULT_OPTIONS, ...options };\r\n\r\n    const watchId = navigator.geolocation.watchPosition(\r\n        (position) => {\r\n            onSuccess({\r\n                lat: position.coords.latitude,\r\n                lng: position.coords.longitude\r\n            });\r\n        },\r\n        (error) => {\r\n            onError(mapGeolocationError(error));\r\n        },\r\n        {\r\n            timeout: opts.timeout,\r\n            maximumAge: opts.maximumAge,\r\n            enableHighAccuracy: opts.enableHighAccuracy\r\n        }\r\n    );\r\n\r\n    return watchId;\r\n};\r\n\r\n/**\r\n * Clears position watch\r\n */\r\nexport const clearWatch = (watchId: number): void => {\r\n    if (isGeolocationSupported()) {\r\n        navigator.geolocation.clearWatch(watchId);\r\n    }\r\n};\r\n\r\n/**\r\n * Requests permission for geolocation (best effort)\r\n * Note: There's no standard API to request permission without getting position\r\n */\r\nexport const requestPermission = async (): Promise<PermissionState | 'unsupported'> => {\r\n    try {\r\n        if ('permissions' in navigator) {\r\n            const result = await navigator.permissions.query({ name: 'geolocation' as PermissionName });\r\n            return result.state;\r\n        }\r\n        return 'unsupported';\r\n    } catch {\r\n        return 'unsupported';\r\n    }\r\n};\r\n",
        "usedDeprecatedRules": [
            {
                "ruleId": "dot-location",
                "replacedBy": []
            },
            {
                "ruleId": "new-parens",
                "replacedBy": []
            },
            {
                "ruleId": "no-mixed-operators",
                "replacedBy": []
            },
            {
                "ruleId": "no-new-object",
                "replacedBy": [
                    "no-object-constructor"
                ]
            },
            {
                "ruleId": "no-whitespace-before-property",
                "replacedBy": []
            },
            {
                "ruleId": "rest-spread-spacing",
                "replacedBy": []
            }
        ]
    }
]